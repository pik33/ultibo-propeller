' 
' 
' hdmi_base       = 48             'must be a multiple of 8
con
	hdmi_base = 48
' _clkfreq        = 345_000_000    'start safe, hubset will do the rest. The clock will be changed to:
	_clkfreq = 345000000
' 
' ' 354_689_500   200x Atari 8-bit PAL,  50x Amiga PAL  - real settings: 49,869-> 354_693_878  - 1.0000123 - mode 0 and 192
' ' 357_954_500   200x Atari 8-bit NTSC, 50x Amiga NTSC - real settings: 49,877-> 357_959_184  - 1.0000131 - mode 256
' 
' ' 319_220_550   180x PAL  - real settings: 51,814-> 319_215_686 - 0.9999848 - mode 64
' ' 322_159_050   180x NTSC - real settings: 37,596-> 322_162_162 - 1.0000097 - mode 320 and 448
' 
' ' 283_751_600   160x PAL  - real settings: 64,908-> 283_750_000 - 0.9999944 - mode 128
' ' 286_363_600   160x NTSC - real settings: 22,315-> 286_363_636 - 1.0000001 - mode 384
' 
' ''--------- VGA DOS color definition constants
' 
' c_black         =    0
	c_black = 0
' c_blue          =  117
	c_blue = 117
' c_green         =  199
	c_green = 199
' c_cyan          =  149
	c_cyan = 149
' c_red           =   39
	c_red = 39
' c_magenta       =   71
	c_magenta = 71
' c_brown         =  246
	c_brown = 246
' c_lightgray     =   10
	c_lightgray = 10
' c_darkgray      =    5
	c_darkgray = 5
' c_lightblue     =  121
	c_lightblue = 121
' c_lightgreen    =  203
	c_lightgreen = 203
' c_lightcyan     =  155
	c_lightcyan = 155
' c_lightred      =   43
	c_lightred = 43
' c_lightmagenta  =   75
	c_lightmagenta = 75
' c_yellow        =  234
	c_yellow = 234
' c_white         =   15
	c_white = 15
' 
' timingsxxt      =  $70810000
	timingsxxt = 1887502336
dat
	nop
	cogid	pa
	coginit	pa,##$404
	orgh	$10
	long	0	'reserved
	long	0 ' clock frequency: will default to 345000000
	long	0 ' clock mode: will default to $10c44fb
	orgh	$400
 _ret_	mov	result1, #0
	org	0
entry
	cmp	ptra, #0 wz
 if_ne	jmp	#spininit
	mov	ptra, ptr_stackspace_
	rdlong	pa, #20 wz
 if_ne	jmp	#skip_clock_set_
	hubset	#0
	hubset	##17581304
	waitx	##200000
	mov	pa, ##17581307
	hubset	pa
	wrlong	pa, #24
	wrlong	##345000000, #20
	jmp	#skip_clock_set_
	orgf	32
skip_clock_set_
	locknew	__lockreg
	wrlong	__lockreg, ptr___lockreg_
	call	#_dummy
cogexit
	waitx	##160000
	cogid	arg01
	cogstop	arg01
spininit
	rdlong	objptr, ptra
	add	ptra, #4
	rdlong	result1, ptra
	add	ptra, #4
	rdlong	arg01, ptra
	add	ptra, #4
	rdlong	arg02, ptra
	add	ptra, #4
	rdlong	arg03, ptra
	add	ptra, #4
	rdlong	arg04, ptra
	sub	ptra, #16
	call	result1
	jmp	#cogexit
COUNT_
    long 0
RETADDR_
    long 0
fp
    long 0
gosub_
    mov  COUNT_, #0
    mov  pa, arg01
    pop  RETADDR_
    jmp  #pushregs_done_
pushregs_
    pop  pa
    pop  RETADDR_
    tjz  COUNT_, #pushregs_done_
    sub  COUNT_, #1
    setq COUNT_
    wrlong local01, ptra
    add  COUNT_, #1
pushregs_done_
    shl  COUNT_, #2
    add  ptra, COUNT_
    shr  COUNT_, #2
    setq #2 ' push 3 registers starting at COUNT_
    wrlong COUNT_, ptra
    add    ptra, #12
    mov    fp, ptra
    jmp  pa
 popregs_
    pop    pa
    sub    ptra, #12
    setq   #2
    rdlong COUNT_, ptra
    tjz    COUNT_, #popregs__ret
    shl    COUNT_, #2
    sub    ptra, COUNT_
    shr    COUNT_, #2
    sub    COUNT_, #1
    setq   COUNT_
    rdlong local01, ptra
popregs__ret
    push   RETADDR_
    jmp    pa

unsdivide_
       setq    #0
       qdiv    muldiva_, muldivb_
       getqx   muldivb_
 _ret_ getqy   muldiva_

divide_
       abs     muldiva_,muldiva_     wc       'abs(x)
       muxc    itmp2_,#%11                    'store sign of x
       abs     muldivb_,muldivb_     wcz      'abs(y)
 if_c  xor     itmp2_,#%10                    'store sign of y
 if_z  ret
       call    #unsdivide_
       test    itmp2_,#1        wc       'restore sign, remainder
       negc    muldiva_,muldiva_ 
       test    itmp2_,#%10      wc       'restore sign, division result
 _ret_ negc    muldivb_,muldivb_

__heap_ptr
	long	@__heap_base
__lockreg
	long	0
itmp1_
	long	0
itmp2_
	long	0
objptr
	long	@objmem
ptr___lockreg_
	long	@__lockreg
ptr___system__dat__
	long	@__system__dat_
ptr__dat__
	long	@_dat_
ptr__outtextxycg_
	long	@_outtextxycg
ptr__outtextxyct_
	long	@_outtextxyct
ptr__outtextxyt_
	long	@_outtextxyt
ptr__putcharxycg_
	long	@_putcharxycg
ptr__putcharxyct_
	long	@_putcharxyct
ptr__putcharxyt_
	long	@_putcharxyt
ptr_stackspace_
	long	@stackspace
result1
	long	0
result2
	long	0
COG_BSS_START
	fit	480
	orgh
hubentry

' 
' 
' ''--------- timings
' ' 0  m_bs        - before sync,             16      80
' ' 1  m_sn        - sync                     80     160
' ' 2  m_bv        - before visible           20      84
' ' 3  m_vi        - visible                1024     816
' ' 4  m_border    - left and right borders  112       8
' ' 5  m_lut1      - pixels per char           8       8
' ' 6  i_vborder   - up and down border       48       8
' ' 7  i_upporch   - up non visible           16       8
' ' 8  i_vsync     - vsync                    16      12
' ' 9  i_downporch - down non visible         16       8
' '10  mode #
' '11  cpl         - character per line
' '12  scanlines #
' '13  clock
' '14  hubset value for clock settings
' 
' 
' '*************************************************************************
' '                                                                        *
' '  A dummy start function if someone runs this driver alone              *
' '                                                                        *
' '*************************************************************************
' 
' pub dummy()|i,x,y,ntsc,bbb,ccc,zzx,zzy,amode
_dummy
	mov	COUNT_, #14
	call	#pushregs_
' '' this is not a main program.
' 
' start(256+192,8)
	mov	local01, #448
	mov	local02, #8
	mov	arg01, local01
	mov	arg02, local02
	call	#_start
	mov	local03, result1
' 
' setmode(192)
	mov	local01, #192
	mov	arg01, local01
	call	#_setmode
' cls(147,154)
	mov	local01, #147
	mov	local02, #154
	mov	arg01, local01
	mov	arg02, local02
	call	#_cls
	mov	local03, result1
' 'outtextxyc(64,0,inttostr(amode),0,1)
' waitvbl(240)
	mov	local01, #240
	mov	arg01, local01
	call	#_waitvbl
' setmode(512)
	mov	local01, ##512
	mov	arg01, local01
	call	#_setmode
' cls(0,1)
	mov	local01, #0
	mov	local02, #1
	mov	arg01, local01
	mov	arg02, local02
	call	#_cls
	mov	local03, result1
' waitvbl(240)
	mov	local01, #240
	mov	arg01, local01
	call	#_waitvbl
' 
' setmode(192)
	mov	local01, #192
	mov	arg01, local01
	call	#_setmode
' cls(34,41)
	mov	local01, #34
	mov	local02, #41
	mov	arg01, local01
	mov	arg02, local02
	call	#_cls
	mov	local03, result1
' 'outtextxyc(64,0,inttostr(amode),0,1)
' waitvbl(240)
	mov	local01, #240
	mov	arg01, local01
	call	#_waitvbl
' repeat
LR__0001
	jmp	#LR__0001
' {{ 
' }}
' 
' repeat amode from 512 to 1023
	mov	local04, ##512
LR__0002
'   setmode(amode)
	mov	local01, local04
	mov	arg01, local01
	call	#_setmode
'   cls(0,1)   
	mov	local01, #0
	mov	local02, #1
	mov	arg01, local01
	mov	arg02, local02
	call	#_cls
	mov	local03, result1
'   outtextxyc(0,0,string("mode"),0,1)
	add	objptr, #240
	rdlong	local05, objptr
	sub	objptr, #240
	mov	local01, local05
	rdlong	local02, local01
	add	local01, #4
	rdlong	local06, local01
	sub	local01, #4
	mov	local03, local06
	mov	local07, #0
	mov	local08, #0
	mov	local09, ##@LR__0310
	mov	local10, local09
	mov	local11, #0
	mov	local12, #1
	mov	arg01, local07
	mov	arg02, local08
	mov	arg03, local10
	mov	arg04, local11
	mov	arg05, local12
	mov	local13, objptr
	mov	objptr, local02
	call	local03
	mov	objptr, local13
	mov	local14, result1
'   waitvbl(240)
	mov	local01, #240
	mov	arg01, local01
	call	#_waitvbl
	mov	local01, local04
	mov	local02, local04
	add	local02, #1
	mov	local04, local02
	cmps	local04, ##1024 wcz
 if_b	jmp	#LR__0002
'   {{
'  }}
' repeat
LR__0003
	jmp	#LR__0003
	mov	ptra, fp
	call	#popregs_
_dummy_ret
	ret

' 
' 
' pub putcharxycf(x,y,achar,f) |xx, yy,bb
_putcharxycf
	mov	COUNT_, #19
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
' 
' repeat yy from 0 to 15
	mov	local05, #0
LR__0004
'   bb:=byte[@vga_font+4096+16*achar+yy]
	mov	local06, ptr__dat__
	mov	local07, local06
	add	local07, ##4096
	mov	local08, local03
	shl	local08, #4
	add	local07, local08
	add	local07, local05
	rdbyte	local09, local07
'   repeat xx from 0 to 7
	mov	local10, #0
LR__0005
'     if (bb&(1<<xx))<>0
	mov	local07, local09
	mov	local06, #1
	shl	local06, local10
	and	local07, local06
	cmp	local07, #0 wz
 if_e	jmp	#LR__0006
'       putpixel(xx+x,yy+y,f)
	add	objptr, #224
	rdlong	local11, objptr
	sub	objptr, #224
	mov	local07, local11
	rdlong	local06, local07
	add	local07, #4
	rdlong	local12, local07
	sub	local07, #4
	mov	local08, local12
	mov	local13, local10
	add	local13, local01
	mov	local14, local13
	mov	local15, local05
	add	local15, local02
	mov	local16, local15
	mov	local17, local04
	mov	arg01, local14
	mov	arg02, local16
	mov	arg03, local17
	mov	local18, objptr
	mov	objptr, local06
	call	local08
	mov	objptr, local18
	mov	local19, result1
LR__0006
	mov	local07, local10
	mov	local06, local10
	add	local06, #1
	mov	local10, local06
	cmps	local10, #8 wcz
 if_b	jmp	#LR__0005
	mov	local07, local05
	mov	local06, local05
	add	local06, #1
	mov	local05, local06
	cmps	local05, #16 wcz
 if_b	jmp	#LR__0004
	mov	ptra, fp
	call	#popregs_
_putcharxycf_ret
	ret

'       
' pub putcharxycg(x,y,achar,f,b) |xx, yy,bb
_putcharxycg
	mov	COUNT_, #20
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
' 
' repeat yy from 0 to 15
	mov	local06, #0
LR__0007
'   bb:=byte[@vga_font+16*achar+yy]
	mov	local07, ptr__dat__
	mov	local08, local03
	shl	local08, #4
	mov	local09, local07
	add	local09, local08
	add	local09, local06
	rdbyte	local10, local09
'   repeat xx from 0 to 7
	mov	local11, #0
LR__0008
'     if (bb&(1<<xx))<>0
	mov	local09, local10
	mov	local07, #1
	shl	local07, local11
	and	local09, local07
	cmp	local09, #0 wz
 if_e	jmp	#LR__0009
'       putpixel(xx+x,yy+y,f)
	add	objptr, #224
	rdlong	local12, objptr
	sub	objptr, #224
	mov	local09, local12
	rdlong	local07, local09
	add	local09, #4
	rdlong	local13, local09
	sub	local09, #4
	mov	local08, local13
	mov	local14, local11
	add	local14, local01
	mov	local15, local14
	mov	local16, local06
	add	local16, local02
	mov	local17, local16
	mov	local18, local04
	mov	arg01, local15
	mov	arg02, local17
	mov	arg03, local18
	mov	local19, objptr
	mov	objptr, local07
	call	local08
	mov	objptr, local19
	mov	local20, result1
'     else
	jmp	#LR__0010
LR__0009
'       putpixel(xx+x,yy+y,b)   
	add	objptr, #224
	rdlong	local12, objptr
	sub	objptr, #224
	mov	local09, local12
	rdlong	local07, local09
	add	local09, #4
	rdlong	local13, local09
	sub	local09, #4
	mov	local08, local13
	mov	local14, local11
	add	local14, local01
	mov	local15, local14
	mov	local16, local06
	add	local16, local02
	mov	local17, local16
	mov	local18, local05
	mov	arg01, local15
	mov	arg02, local17
	mov	arg03, local18
	mov	local19, objptr
	mov	objptr, local07
	call	local08
	mov	objptr, local19
	mov	local20, result1
LR__0010
	mov	local09, local11
	mov	local07, local11
	add	local07, #1
	mov	local11, local07
	cmps	local11, #8 wcz
 if_b	jmp	#LR__0008
	mov	local09, local06
	mov	local07, local06
	add	local07, #1
	mov	local06, local07
	cmps	local06, #16 wcz
 if_b	jmp	#LR__0007
	mov	ptra, fp
	call	#popregs_
_putcharxycg_ret
	ret

' 
' pub putcharxycz(x,y,achar,f,b,xz,yz) |xx,xxx,yy,yyy,bb
_putcharxycz
	mov	COUNT_, #40
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
	mov	local06, arg06
	mov	local07, arg07
' 
' repeat yy from 0 to 15
	mov	local08, #0
LR__0011
'   bb:=byte[@vga_font+16*achar+yy]
	mov	local09, ptr__dat__
	mov	local10, local03
	shl	local10, #4
	mov	local11, local09
	add	local11, local10
	add	local11, local08
	rdbyte	local12, local11
'   repeat xx from 0 to 7
	mov	local13, #0
LR__0012
'     if (bb&(1<<xx))<>0
	mov	local11, local12
	mov	local09, #1
	shl	local09, local13
	and	local11, local09
	cmp	local11, #0 wz
 if_e	jmp	#LR__0019
'       repeat yyy from 0 to yz-1
	mov	local14, #0
	mov	local11, local07
	sub	local11, #1
	mov	local15, local11
	cmps	local15, #0 wcz
 if_be	jmp	#LR__0013
	mov	local09, #1
	jmp	#LR__0014
LR__0013
	mov	local09, ##-1
LR__0014
	mov	local16, local09
	mov	local10, local15
	add	local10, local16
	mov	local15, local10
LR__0015
'         repeat xxx from 0 to xz-1
	mov	local17, #0
	mov	local18, local06
	sub	local18, #1
	mov	local19, local18
	cmps	local19, #0 wcz
 if_be	jmp	#LR__0016
	mov	local20, #1
	jmp	#LR__0017
LR__0016
	mov	local20, ##-1
LR__0017
	mov	local21, local20
	mov	local22, local19
	add	local22, local21
	mov	local19, local22
LR__0018
'           putpixel(xz*xx+xxx+x,yz*yy+yyy+y,f)
	add	objptr, #224
	rdlong	local23, objptr
	sub	objptr, #224
	mov	local24, local23
	rdlong	local25, local24
	add	local24, #4
	rdlong	local26, local24
	sub	local24, #4
	mov	local27, local26
	qmul	local06, local13
	getqx	local28
	mov	local29, local28
	add	local29, local17
	add	local29, local01
	mov	local30, local29
	qmul	local07, local08
	getqx	local31
	mov	local32, local31
	add	local32, local14
	add	local32, local02
	mov	local33, local32
	mov	local34, local04
	mov	arg01, local30
	mov	arg02, local33
	mov	arg03, local34
	mov	local35, objptr
	mov	objptr, local25
	call	local27
	mov	objptr, local35
	mov	local36, result1
	mov	local24, local17
	add	local24, local21
	mov	local17, local24
	cmp	local17, local19 wz
 if_ne	jmp	#LR__0018
	mov	local18, local14
	add	local18, local16
	mov	local14, local18
	cmp	local14, local15 wz
 if_ne	jmp	#LR__0015
'     else
	jmp	#LR__0026
LR__0019
'       repeat yyy from 0 to yz-1
	mov	local14, #0
	mov	local11, local07
	sub	local11, #1
	mov	local37, local11
	cmps	local37, #0 wcz
 if_be	jmp	#LR__0020
	mov	local09, #1
	jmp	#LR__0021
LR__0020
	mov	local09, ##-1
LR__0021
	mov	local38, local09
	mov	local10, local37
	add	local10, local38
	mov	local37, local10
LR__0022
'         repeat xxx from 0 to xz-1
	mov	local17, #0
	mov	local18, local06
	sub	local18, #1
	mov	local39, local18
	cmps	local39, #0 wcz
 if_be	jmp	#LR__0023
	mov	local20, #1
	jmp	#LR__0024
LR__0023
	mov	local20, ##-1
LR__0024
	mov	local40, local20
	mov	local22, local39
	add	local22, local40
	mov	local39, local22
LR__0025
'           putpixel(xz*xx+xxx+x,yz*yy+yyy+y,b)
	add	objptr, #224
	rdlong	local23, objptr
	sub	objptr, #224
	mov	local24, local23
	rdlong	local25, local24
	add	local24, #4
	rdlong	local26, local24
	sub	local24, #4
	mov	local27, local26
	qmul	local06, local13
	getqx	local28
	mov	local29, local28
	add	local29, local17
	add	local29, local01
	mov	local30, local29
	qmul	local07, local08
	getqx	local31
	mov	local32, local31
	add	local32, local14
	add	local32, local02
	mov	local33, local32
	mov	local34, local05
	mov	arg01, local30
	mov	arg02, local33
	mov	arg03, local34
	mov	local35, objptr
	mov	objptr, local25
	call	local27
	mov	objptr, local35
	mov	local36, result1
	mov	local24, local17
	add	local24, local40
	mov	local17, local24
	cmp	local17, local39 wz
 if_ne	jmp	#LR__0025
	mov	local18, local14
	add	local18, local38
	mov	local14, local18
	cmp	local14, local37 wz
 if_ne	jmp	#LR__0022
LR__0026
	mov	local11, local13
	mov	local09, local13
	add	local09, #1
	mov	local13, local09
	cmps	local13, #8 wcz
 if_b	jmp	#LR__0012
	mov	local11, local08
	mov	local09, local08
	add	local09, #1
	mov	local08, local09
	cmps	local08, #16 wcz
 if_b	jmp	#LR__0011
	mov	ptra, fp
	call	#popregs_
_putcharxycz_ret
	ret

'           
' pub outtextxycg(x,y,text,f,b) | iii,c
_outtextxycg
	mov	COUNT_, #28
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
' 
' repeat iii from 0 to strsize(text)-1
	mov	local06, #0
	mov	local07, local03
	mov	arg01, local07
	call	#__system____builtin_strlen
	mov	local08, result1
	mov	local09, local08
	sub	local09, #1
	mov	local10, local09
	cmps	local10, #0 wcz
 if_be	jmp	#LR__0027
	mov	local11, #1
	jmp	#LR__0028
LR__0027
	mov	local11, ##-1
LR__0028
	mov	local12, local11
	mov	local13, local10
	add	local13, local12
	mov	local10, local13
LR__0029
'   putcharxyc(x+8*iii,y,byte[text+iii],f,b)
	add	objptr, #236
	rdlong	local14, objptr
	sub	objptr, #236
	mov	local15, local14
	rdlong	local16, local15
	add	local15, #4
	rdlong	local17, local15
	sub	local15, #4
	mov	local18, local17
	mov	local19, local01
	mov	local20, local06
	shl	local20, #3
	add	local19, local20
	mov	local21, local19
	mov	local22, local02
	mov	local23, local03
	add	local23, local06
	rdbyte	local24, local23
	mov	local25, local04
	mov	local26, local05
	mov	arg01, local21
	mov	arg02, local22
	mov	arg03, local24
	mov	arg04, local25
	mov	arg05, local26
	mov	local27, objptr
	mov	objptr, local16
	call	local18
	mov	objptr, local27
	mov	local28, result1
	mov	local15, local06
	add	local15, local12
	mov	local06, local15
	cmp	local06, local10 wz
 if_ne	jmp	#LR__0029
	mov	ptra, fp
	call	#popregs_
_outtextxycg_ret
	ret

' 
' pub outtextxycf(x,y,text,f) | iii,c
_outtextxycf
	mov	COUNT_, #19
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
' 
' repeat iii from 0 to strsize(text)-1
	mov	local05, #0
	mov	local06, local03
	mov	arg01, local06
	call	#__system____builtin_strlen
	mov	local07, result1
	mov	local08, local07
	sub	local08, #1
	mov	local09, local08
	cmps	local09, #0 wcz
 if_be	jmp	#LR__0030
	mov	local10, #1
	jmp	#LR__0031
LR__0030
	mov	local10, ##-1
LR__0031
	mov	local11, local10
	mov	local12, local09
	add	local12, local11
	mov	local09, local12
LR__0032
'   putcharxycf(x+8*iii,y,byte[text+iii],f)  
	mov	local13, local01
	mov	local14, local05
	shl	local14, #3
	add	local13, local14
	mov	local15, local13
	mov	local16, local02
	mov	local17, local03
	add	local17, local05
	rdbyte	local18, local17
	mov	local19, local04
	mov	arg01, local15
	mov	arg02, local16
	mov	arg03, local18
	mov	arg04, local19
	call	#_putcharxycf
	mov	local13, local05
	add	local13, local11
	mov	local05, local13
	cmp	local05, local09 wz
 if_ne	jmp	#LR__0032
	mov	ptra, fp
	call	#popregs_
_outtextxycf_ret
	ret

'             
' pub outtextxycz(x,y,text,f,b,xz,yz) | iii,c
_outtextxycz
	mov	COUNT_, #26
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
	mov	local06, arg06
	mov	local07, arg07
' 
' repeat iii from 0 to strsize(text)-1
	mov	local08, #0
	mov	local09, local03
	mov	arg01, local09
	call	#__system____builtin_strlen
	mov	local10, result1
	mov	local11, local10
	sub	local11, #1
	mov	local12, local11
	cmps	local12, #0 wcz
 if_be	jmp	#LR__0033
	mov	local13, #1
	jmp	#LR__0034
LR__0033
	mov	local13, ##-1
LR__0034
	mov	local14, local13
	mov	local15, local12
	add	local15, local14
	mov	local12, local15
LR__0035
'   putcharxycz(x+8*xz*iii,y,byte[text+iii],f,b,xz,yz)
	mov	local16, local01
	mov	local17, local06
	shl	local17, #3
	qmul	local17, local08
	getqx	local18
	add	local16, local18
	mov	local19, local16
	mov	local20, local02
	mov	local21, local03
	add	local21, local08
	rdbyte	local22, local21
	mov	local23, local04
	mov	local24, local05
	mov	local25, local06
	mov	local26, local07
	mov	arg01, local19
	mov	arg02, local20
	mov	arg03, local22
	mov	arg04, local23
	mov	arg05, local24
	mov	arg06, local25
	mov	arg07, local26
	call	#_putcharxycz
	mov	local16, local08
	add	local16, local14
	mov	local08, local16
	cmp	local08, local12 wz
 if_ne	jmp	#LR__0035
	mov	ptra, fp
	call	#popregs_
_outtextxycz_ret
	ret

'     
'     
' ''---------- putpixel - put a pixel on the screen
' 
' pub putpixel1(x,y,c) |byte b
_putpixel1
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' 
' if ((x>=0) & (x<32*cpl) & (y>=0) & (y<lines)) 
	mov	_var04, #0
	cmps	_var01, #0 wcz
 if_b	jmp	#LR__0036
	xor	_var04, ##-1
LR__0036
	mov	_var05, #0
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var07, _var06
	mov	_var08, _var07
	shl	_var08, #5
	cmps	_var01, _var08 wcz
 if_ae	jmp	#LR__0037
	xor	_var05, ##-1
LR__0037
	and	_var04, _var05
	mov	_var09, #0
	cmps	_var02, #0 wcz
 if_b	jmp	#LR__0038
	xor	_var09, ##-1
LR__0038
	and	_var04, _var09
	mov	_var10, #0
	add	objptr, #152
	rdlong	_var11, objptr
	sub	objptr, #152
	mov	_var12, _var11
	cmps	_var02, _var12 wcz
 if_ae	jmp	#LR__0039
	xor	_var10, ##-1
LR__0039
	and	_var04, _var10
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0042
'     b:=byte[buf_ptr+4*cpl*y+(x>>3)]
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	mov	_var09, _var01
	shr	_var09, #3
	add	_var04, _var09
	rdbyte	_var13, _var04
'     if (c==0) 
	cmp	_var03, #0 wz
 if_ne	jmp	#LR__0040
'       b:=b & !(1<<(x//8))
	mov	_var04, _var13
	abs	_var08, _var01 wc
	and	_var08, #7
 if_b	neg	_var08, _var08
	mov	_var05, #1
	shl	_var05, _var08
	andn	_var04, _var05
	mov	_var13, _var04
'     else 
	jmp	#LR__0041
LR__0040
'       b:=b |(1<<(x//8)) 
	mov	_var04, _var13
	abs	_var08, _var01 wc
	and	_var08, #7
 if_b	neg	_var08, _var08
	mov	_var05, #1
	shl	_var05, _var08
	or	_var04, _var05
	mov	_var13, _var04
LR__0041
'     byte[buf_ptr+4*cpl*y+(x>>3)]:=b
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	mov	_var09, _var01
	shr	_var09, #3
	add	_var04, _var09
	wrbyte	_var13, _var04
LR__0042
_putpixel1_ret
	ret

' 
' 
' pub putpixel2(x,y,c) |byte b
_putpixel2
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' 
' if ((x>=0) & (x<16*cpl) & (y>=0) & (y<lines)) 
	mov	_var04, #0
	cmps	_var01, #0 wcz
 if_b	jmp	#LR__0043
	xor	_var04, ##-1
LR__0043
	mov	_var05, #0
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var07, _var06
	mov	_var08, _var07
	shl	_var08, #4
	cmps	_var01, _var08 wcz
 if_ae	jmp	#LR__0044
	xor	_var05, ##-1
LR__0044
	and	_var04, _var05
	mov	_var09, #0
	cmps	_var02, #0 wcz
 if_b	jmp	#LR__0045
	xor	_var09, ##-1
LR__0045
	and	_var04, _var09
	mov	_var10, #0
	add	objptr, #152
	rdlong	_var11, objptr
	sub	objptr, #152
	mov	_var12, _var11
	cmps	_var02, _var12 wcz
 if_ae	jmp	#LR__0046
	xor	_var10, ##-1
LR__0046
	and	_var04, _var10
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0047
'     b:=byte[buf_ptr+4*cpl*y+(x>>2)]
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	mov	_var09, _var01
	shr	_var09, #2
	add	_var04, _var09
	rdbyte	_var13, _var04
'     b:=b & !(%11<<((x//4)<<1))
	mov	_var04, _var13
	abs	_var08, _var01 wc
	and	_var08, #3
 if_b	neg	_var08, _var08
	shl	_var08, #1
	mov	_var05, #3
	shl	_var05, _var08
	andn	_var04, _var05
	mov	_var13, _var04
'     b:=b |(c<<((x//4)<<1)) 
	mov	_var04, _var13
	mov	_var05, _var03
	abs	_var08, _var01 wc
	and	_var08, #3
 if_b	neg	_var08, _var08
	shl	_var08, #1
	shl	_var05, _var08
	or	_var04, _var05
	mov	_var13, _var04
'     byte[buf_ptr+4*cpl*y+(x>>2)]:=b
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	mov	_var09, _var01
	shr	_var09, #2
	add	_var04, _var09
	wrbyte	_var13, _var04
LR__0047
_putpixel2_ret
	ret

'     
'     
' pub putpixel4(x,y,c) |byte b
_putpixel4
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' if ((x>=0) & (x<16*cpl) & (y>=0) & (y<lines)) 
	mov	_var04, #0
	cmps	_var01, #0 wcz
 if_b	jmp	#LR__0048
	xor	_var04, ##-1
LR__0048
	mov	_var05, #0
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var07, _var06
	mov	_var08, _var07
	shl	_var08, #4
	cmps	_var01, _var08 wcz
 if_ae	jmp	#LR__0049
	xor	_var05, ##-1
LR__0049
	and	_var04, _var05
	mov	_var09, #0
	cmps	_var02, #0 wcz
 if_b	jmp	#LR__0050
	xor	_var09, ##-1
LR__0050
	and	_var04, _var09
	mov	_var10, #0
	add	objptr, #152
	rdlong	_var11, objptr
	sub	objptr, #152
	mov	_var12, _var11
	cmps	_var02, _var12 wcz
 if_ae	jmp	#LR__0051
	xor	_var10, ##-1
LR__0051
	and	_var04, _var10
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0052
'     b:=byte[buf_ptr+4*cpl*y+(x>>1)]
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	mov	_var09, _var01
	shr	_var09, #1
	add	_var04, _var09
	rdbyte	_var13, _var04
'     b:=b & !(%1111<<((x//2)<<2))
	mov	_var04, _var13
	abs	_var08, _var01 wc
	and	_var08, #1
 if_b	neg	_var08, _var08
	shl	_var08, #2
	mov	_var05, #15
	shl	_var05, _var08
	andn	_var04, _var05
	mov	_var13, _var04
'     b:=b |(c<<((x//2)<<2)) 
	mov	_var04, _var13
	mov	_var05, _var03
	abs	_var08, _var01 wc
	and	_var08, #1
 if_b	neg	_var08, _var08
	shl	_var08, #2
	shl	_var05, _var08
	or	_var04, _var05
	mov	_var13, _var04
'     byte[buf_ptr+4*cpl*y+(x>>1)]:=b
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	mov	_var09, _var01
	shr	_var09, #1
	add	_var04, _var09
	wrbyte	_var13, _var04
LR__0052
_putpixel4_ret
	ret

'     
'     
' pub putpixel8(x,y,c)
_putpixel8
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' if ((x>=0) & (x<4*cpl) & (y>=0) & (y<lines)) 
	mov	_var04, #0
	cmps	_var01, #0 wcz
 if_b	jmp	#LR__0053
	xor	_var04, ##-1
LR__0053
	mov	_var05, #0
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var07, _var06
	mov	_var08, _var07
	shl	_var08, #2
	cmps	_var01, _var08 wcz
 if_ae	jmp	#LR__0054
	xor	_var05, ##-1
LR__0054
	and	_var04, _var05
	mov	_var09, #0
	cmps	_var02, #0 wcz
 if_b	jmp	#LR__0055
	xor	_var09, ##-1
LR__0055
	and	_var04, _var09
	mov	_var10, #0
	add	objptr, #152
	rdlong	_var11, objptr
	sub	objptr, #152
	mov	_var12, _var11
	cmps	_var02, _var12 wcz
 if_ae	jmp	#LR__0056
	xor	_var10, ##-1
LR__0056
	and	_var04, _var10
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0057
'     byte[buf_ptr+4*cpl*y+x]:=c    
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var07, objptr
	sub	objptr, #148
	mov	_var08, _var07
	mov	_var05, _var08
	shl	_var05, #2
	qmul	_var05, _var02
	getqx	_var06
	add	_var04, _var06
	add	_var04, _var01
	wrbyte	_var03, _var04
LR__0057
_putpixel8_ret
	ret

'     
' 
' '**********************************************************************r***
' '                                                                        *
' ' Font related functions                                                 *
' '                                                                        *
' '*************************************************************************
' 
' ''--------- Set a font offset. TODO: rremove, use byte#1 instead
' 
' pub setfontnum(afontnum)
_setfontnum
	mov	_var01, arg01
' 
' fontnum:=afontnum
	add	objptr, #164
	wrlong	_var01, objptr
	sub	objptr, #164
_setfontnum_ret
	ret

' 
' ''--------- Redefine a character
' 
' pub defchar(fn,ch,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15) :s
_defchar
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, arg04
	mov	_var05, arg05
	mov	_var06, arg06
	mov	_var07, arg07
	mov	_var08, arg08
	mov	_var09, arg09
	mov	_var10, arg10
	mov	_var11, arg11
	mov	_var12, arg12
	mov	_var13, arg13
	mov	_var14, arg14
	mov	_var15, arg15
	mov	_var16, arg16
	mov	_var17, arg17
	mov	_var18, arg18
	mov	_var19, #0
' 
' s:=@st_font+fn+ch*16
	add	ptr__dat__, ##4096
	mov	_var20, ptr__dat__
	sub	ptr__dat__, ##4096
	mov	_var21, _var20
	add	_var21, _var01
	mov	_var22, _var02
	shl	_var22, #4
	add	_var21, _var22
	mov	_var19, _var21
' byte[s+00]:=b0
	mov	_var21, _var19
	add	_var21, #0
	wrbyte	_var03, _var21
' byte[s+01]:=b1
	mov	_var21, _var19
	add	_var21, #1
	wrbyte	_var04, _var21
' byte[s+02]:=b2
	mov	_var21, _var19
	add	_var21, #2
	wrbyte	_var05, _var21
' byte[s+03]:=b3
	mov	_var21, _var19
	add	_var21, #3
	wrbyte	_var06, _var21
' byte[s+04]:=b4
	mov	_var21, _var19
	add	_var21, #4
	wrbyte	_var07, _var21
' byte[s+05]:=b5
	mov	_var21, _var19
	add	_var21, #5
	wrbyte	_var08, _var21
' byte[s+06]:=b6
	mov	_var21, _var19
	add	_var21, #6
	wrbyte	_var09, _var21
' byte[s+07]:=b7
	mov	_var21, _var19
	add	_var21, #7
	wrbyte	_var10, _var21
' byte[s+08]:=b8
	mov	_var21, _var19
	add	_var21, #8
	wrbyte	_var11, _var21
' byte[s+09]:=b9
	mov	_var21, _var19
	add	_var21, #9
	wrbyte	_var12, _var21
' byte[s+10]:=b10
	mov	_var21, _var19
	add	_var21, #10
	wrbyte	_var13, _var21
' byte[s+11]:=b11
	mov	_var21, _var19
	add	_var21, #11
	wrbyte	_var14, _var21
' byte[s+12]:=b12
	mov	_var21, _var19
	add	_var21, #12
	wrbyte	_var15, _var21
' byte[s+13]:=b13
	mov	_var21, _var19
	add	_var21, #13
	wrbyte	_var16, _var21
' byte[s+14]:=b14
	mov	_var21, _var19
	add	_var21, #14
	wrbyte	_var17, _var21
' byte[s+15]:=b15
	mov	_var21, _var19
	add	_var21, #15
	wrbyte	_var18, _var21
	mov	result1, _var19
	jmp	#_defchar_ret
_defchar_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' '  Cursor functions                                                      *
' '                                                                        *
' '*************************************************************************
' 
' pub cursoron()
_cursoron
' 
' ''---------- Switch the cursor on
' 
' cursor_sh+=16
	add	objptr, #58
	rdbyte	_var01, objptr
	sub	objptr, #58
	mov	_var02, _var01
	add	_var02, #16
	add	objptr, #58
	wrbyte	_var02, objptr
	sub	objptr, #58
_cursoron_ret
	ret

' 
' pub cursoroff()
_cursoroff
' 
' ''---------- Switch the cursor off
' 
' cursor_sh-=16
	add	objptr, #58
	rdbyte	_var01, objptr
	sub	objptr, #58
	mov	_var02, _var01
	sub	_var02, #16
	add	objptr, #58
	wrbyte	_var02, objptr
	sub	objptr, #58
_cursoroff_ret
	ret

' 
' pub setcursorpos(x,y)
_setcursorpos
	mov	_var01, arg01
	mov	_var02, arg02
' 
' ''---------- Set the (x,y) position of cursor
' 
' cursor_x:=x
	add	objptr, #56
	wrbyte	_var01, objptr
	sub	objptr, #56
' cursor_y:=y
	add	objptr, #57
	wrbyte	_var02, objptr
	sub	objptr, #57
_setcursorpos_ret
	ret

' 
' pub setcursorshape(shape)
_setcursorshape
	mov	_var01, arg01
' 
' ''---------- Define a cursor shape (0-full..15-line)
' 
' cursor_sh:=shape
	add	objptr, #58
	wrbyte	_var01, objptr
	sub	objptr, #58
_setcursorshape_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' '  VBlank functions                                                      *
' '                                                                        *
' '*************************************************************************
' 
' pub waitvbl(amount) | i
_waitvbl
	mov	COUNT_, #8
	call	#pushregs_
	mov	local01, arg01
' 
' ''---------- Wait for start of vblank. Amount=delay in frames
' 
' repeat i from 1 to amount
	mov	local02, #1
	cmps	local01, #1 wcz
 if_be	jmp	#LR__0058
	mov	local03, #1
	jmp	#LR__0059
LR__0058
	mov	local03, ##-1
LR__0059
	mov	local04, local03
	mov	local05, local01
	add	local05, local04
	mov	local06, local05
LR__0060
'   repeat until vblank==0
LR__0061
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #0 wz
 if_e	jmp	#LR__0062
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0061
LR__0062
'   repeat until vblank==1
LR__0063
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #1 wz
 if_e	jmp	#LR__0064
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0063
LR__0064
	mov	local08, local02
	add	local08, local04
	mov	local02, local08
	cmp	local02, local06 wz
 if_ne	jmp	#LR__0060
	mov	ptra, fp
	call	#popregs_
_waitvbl_ret
	ret

' 
' 
' pub waitvblend(amount) | i
_waitvblend
	mov	COUNT_, #8
	call	#pushregs_
	mov	local01, arg01
' 
' ''---------- Wait for end of vblank. Amount=delay in frames
' 
' repeat i from 1 to amount
	mov	local02, #1
	cmps	local01, #1 wcz
 if_be	jmp	#LR__0065
	mov	local03, #1
	jmp	#LR__0066
LR__0065
	mov	local03, ##-1
LR__0066
	mov	local04, local03
	mov	local05, local01
	add	local05, local04
	mov	local06, local05
LR__0067
'   repeat until vblank==1
LR__0068
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #1 wz
 if_e	jmp	#LR__0069
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0068
LR__0069
'   repeat until vblank==0
LR__0070
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #0 wz
 if_e	jmp	#LR__0071
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0070
LR__0071
	mov	local08, local02
	add	local08, local04
	mov	local02, local08
	cmp	local02, local06 wz
 if_ne	jmp	#LR__0067
	mov	ptra, fp
	call	#popregs_
_waitvblend_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' '  Color functions                                                       *
' '                                                                        *
' '*************************************************************************
' 
' ''---------- Get a VGA color code
' 
' pub getvgacolor(color):r
_getvgacolor
	mov	_var01, arg01
	mov	_var02, #0
' 
' return colors[color]
	mov	_var03, _var01
	add	objptr, #192
	mov	_var04, objptr
	sub	objptr, #192
	add	_var03, _var04
	rdbyte	result1, _var03
	jmp	#_getvgacolor_ret
_getvgacolor_ret
	ret

' 
' pub getpalettecolor(color):r
_getpalettecolor
	mov	_var01, arg01
	mov	_var02, #0
' 
' return long[@ataripalette+4*color]
	add	ptr__dat__, ##6144
	mov	_var03, ptr__dat__
	sub	ptr__dat__, ##6144
	mov	_var04, _var01
	shl	_var04, #2
	mov	_var05, _var03
	add	_var05, _var04
	rdlong	result1, _var05
	jmp	#_getpalettecolor_ret
_getpalettecolor_ret
	ret

' 
' ''---------- Set font and back colors for all screen - from 256 color palette
' 
' pub setscreencolors(ff,bb) | c ,i
_setscreencolors
	mov	_var01, arg01
	mov	_var02, arg02
' 
' c:=ff<<24+bb<<16
	mov	_var03, _var01
	shl	_var03, #24
	mov	_var04, _var02
	shl	_var04, #16
	add	_var03, _var04
	mov	_var05, _var03
' 
' repeat i from 0 to buflen-1
	mov	_var06, #0
	add	objptr, #52
	rdlong	_var04, objptr
	sub	objptr, #52
	mov	_var03, _var04
	sub	_var03, #1
	mov	_var07, _var03
	cmps	_var07, #0 wcz
 if_be	jmp	#LR__0072
	mov	_var08, #1
	jmp	#LR__0073
LR__0072
	mov	_var08, ##-1
LR__0073
	mov	_var09, _var08
	mov	_var10, _var07
	add	_var10, _var09
	mov	_var07, _var10
LR__0074
'    long[buf_ptr+4*i]:= (long[buf_ptr+4*i] & $FFFF) |  c
	rdlong	_var11, objptr
	mov	_var12, _var06
	shl	_var12, #2
	add	_var11, _var12
	rdlong	_var13, _var11
	and	_var13, ##65535
	or	_var13, _var05
	rdlong	_var14, objptr
	mov	_var15, _var06
	shl	_var15, #2
	add	_var14, _var15
	wrlong	_var13, _var14
LR__0075
	mov	_var13, _var06
	add	_var13, _var09
	mov	_var06, _var13
	cmp	_var06, _var07 wz
 if_ne	jmp	#LR__0074
LR__0076
_setscreencolors_ret
	ret

' 
' ''---------- Set the color for the character at line y and position x
' 
' pub setcharcolor(x,y,c) | place, color
_setcharcolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' place:=(x)+(y*cpl)
	mov	_var04, _var01
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	qmul	_var02, _var06
	getqx	_var07
	add	_var04, _var07
	mov	_var08, _var04
' 
' if (place>buflen-1)
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	cmps	_var08, _var04 wcz
 if_be	jmp	#LR__0077
'   place:=buflen-1
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	mov	_var08, _var04
LR__0077
' 
' color:=(long[buf_ptr+4*place] &$FFFFFF) | (c<<24)
	rdlong	_var07, objptr
	mov	_var06, _var08
	shl	_var06, #2
	add	_var07, _var06
	rdlong	_var04, _var07
	and	_var04, ##16777215
	mov	_var05, _var03
	shl	_var05, #24
	or	_var04, _var05
	mov	_var09, _var04
' long[buf_ptr+4*place]:=color
	rdlong	_var04, objptr
	mov	_var07, _var08
	shl	_var07, #2
	add	_var04, _var07
	wrlong	_var09, _var04
_setcharcolor_ret
	ret

' 
' ''---------- Set the background color at line y and position x
' 
' pub setbackcolor(x,y,c) | place, color
_setbackcolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' place:=(x)+(y*cpl)
	mov	_var04, _var01
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	qmul	_var02, _var06
	getqx	_var07
	add	_var04, _var07
	mov	_var08, _var04
' 
' if (place>buflen-1)
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	cmps	_var08, _var04 wcz
 if_be	jmp	#LR__0078
'   place:=buflen-1
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	mov	_var08, _var04
LR__0078
' 
' color:=(long[buf_ptr+4*place] &$FF00FFFF) | (c<<16)
	rdlong	_var07, objptr
	mov	_var06, _var08
	shl	_var06, #2
	add	_var07, _var06
	rdlong	_var04, _var07
	and	_var04, ##-16711681
	mov	_var05, _var03
	shl	_var05, #16
	or	_var04, _var05
	mov	_var09, _var04
' long[buf_ptr+4*place]:=color
	rdlong	_var04, objptr
	mov	_var07, _var08
	shl	_var07, #2
	add	_var04, _var07
	wrlong	_var09, _var04
_setbackcolor_ret
	ret

' 
' ''---------- Set the border color, o is upper border, lines+1 is lower border
' 
' pub setbordercolor(r,g,b) | color
_setbordercolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' color:=r<<24+g<<16+b<<8
	mov	_var04, _var01
	shl	_var04, #24
	mov	_var05, _var02
	shl	_var05, #16
	add	_var04, _var05
	mov	_var06, _var03
	shl	_var06, #8
	add	_var04, _var06
	mov	_var07, _var04
' bordercolor:=color
	add	objptr, #48
	wrlong	_var07, objptr
	sub	objptr, #48
_setbordercolor_ret
	ret

' 
' ''---------- Set colors for putchar, write and writeln
' 
' pub setwritecolors(ff,bb)
_setwritecolors
	mov	_var01, arg01
	mov	_var02, arg02
' 
' 
' write_color:=ff
	add	objptr, #60
	wrlong	_var01, objptr
	sub	objptr, #60
' write_background:=bb
	add	objptr, #64
	wrlong	_var02, objptr
	sub	objptr, #64
_setwritecolors_ret
	ret

' 
' ''---------- Set color #c in palette to r,g,b
' 
' pub setcolor(c,r,g,b)  |cc
_setcolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, arg04
' 
' cc:=r<<24+g<<16+b<<8
	mov	_var05, _var02
	shl	_var05, #24
	mov	_var06, _var03
	shl	_var06, #16
	add	_var05, _var06
	mov	_var07, _var04
	shl	_var07, #8
	add	_var05, _var07
	mov	_var08, _var05
' cmd2:=cc
	add	objptr, #160
	wrlong	_var08, objptr
	sub	objptr, #160
' cmd1:=c
	add	objptr, #156
	wrlong	_var01, objptr
	sub	objptr, #156
' repeat until cmd1==257
LR__0079
	add	objptr, #156
	rdlong	_var06, objptr
	sub	objptr, #156
	mov	_var05, _var06
	cmp	_var05, #257 wz
 if_e	jmp	#LR__0080
	jmp	#LR__0079
LR__0080
_setcolor_ret
	ret

' 
' 
' '*************************************************************************
' '                                                                        *
' '  Text functions                                                        *
' '                                                                        *
' '*************************************************************************
' 
' ''---------- Clear the screen, set its foreground/background color
' 
' pub cls(fc,bc)   :c
_cls
	mov	COUNT_, #9
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, #0
' 
' if (graphmode<512)
	add	objptr, #208
	rdlong	local04, objptr
	sub	objptr, #208
	mov	local05, local04
	cmps	local05, ##512 wcz
 if_ae	jmp	#LR__0081
'   c:=fc<<24+bc<<16+$20
	mov	local05, local01
	shl	local05, #24
	mov	local04, local02
	shl	local04, #16
	add	local05, local04
	add	local05, #32
	mov	local03, local05
'   longfill(buf_ptr,c,buflen)
	rdlong	local05, objptr
	mov	local04, local03
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local07, local06
	mov	arg01, local05
	mov	arg02, local04
	mov	arg03, local07
	call	#__system__longfill
' else
	jmp	#LR__0090
LR__0081
'   if (graphmode & 48) ==48
	add	objptr, #208
	rdlong	local04, objptr
	sub	objptr, #208
	mov	local05, local04
	and	local05, #48
	cmp	local05, #48 wz
 if_ne	jmp	#LR__0082
'     c:=bc
	mov	local03, local02
	jmp	#LR__0089
LR__0082
'   elseif (graphmode & 48) ==32
	add	objptr, #208
	rdlong	local04, objptr
	sub	objptr, #208
	mov	local05, local04
	and	local05, #48
	cmp	local05, #32 wz
 if_ne	jmp	#LR__0083
'     c:=bc<<4+bc
	mov	local05, local02
	shl	local05, #4
	add	local05, local02
	mov	local03, local05
	jmp	#LR__0088
LR__0083
'   elseif (graphmode & 48) ==16
	add	objptr, #208
	rdlong	local04, objptr
	sub	objptr, #208
	mov	local05, local04
	and	local05, #48
	cmp	local05, #16 wz
 if_ne	jmp	#LR__0084
'     c:=bc<<6+bc<<4+bc<<2+bc
	mov	local05, local02
	shl	local05, #6
	mov	local04, local02
	shl	local04, #4
	add	local05, local04
	mov	local07, local02
	shl	local07, #2
	add	local05, local07
	add	local05, local02
	mov	local03, local05
'   else
	jmp	#LR__0087
LR__0084
'     if bc==1
	cmp	local02, #1 wz
 if_ne	jmp	#LR__0085
'       c:=255
	mov	local03, #255
'     else
	jmp	#LR__0086
LR__0085
'       c:=0    
	mov	local03, #0
LR__0086
LR__0087
LR__0088
LR__0089
'   bytefill(buf_ptr,c,buflen*4)
	rdlong	local05, objptr
	mov	local04, local03
	add	objptr, #52
	rdlong	local08, objptr
	sub	objptr, #52
	mov	local06, local08
	mov	local07, local06
	shl	local07, #2
	mov	local09, local07
	mov	arg01, local05
	mov	arg02, local04
	mov	arg03, local09
	call	#__system__bytefill
LR__0090
' setwritecolors(fc,bc)
	mov	local05, local01
	mov	local04, local02
	mov	arg01, local05
	mov	arg02, local04
	call	#_setwritecolors
' cursor_x:=0
	mov	local05, #0
	add	objptr, #56
	wrbyte	local05, objptr
	sub	objptr, #56
' cursor_y:=0
	mov	local05, #0
	add	objptr, #57
	wrbyte	local05, objptr
	sub	objptr, #57
	mov	result1, local03
	jmp	#LR__0091
LR__0091
	mov	ptra, fp
	call	#popregs_
_cls_ret
	ret

' 
' ''---------- Output a char at x,y, don't change colors and cursor position
' 
' pub putcharxyt(x,y,achar) | c
_putcharxyt
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' long[buf_ptr+4*(cpl*y+x)]:=(long[buf_ptr+4*(cpl*y+x)] & $FFFFFF00)  |(achar & $000000FF)
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	qmul	_var06, _var02
	getqx	_var07
	mov	_var08, _var07
	add	_var08, _var01
	mov	_var09, _var08
	shl	_var09, #2
	add	_var04, _var09
	rdlong	_var10, _var04
	and	_var10, ##-256
	mov	_var11, _var03
	and	_var11, #255
	or	_var10, _var11
	rdlong	_var12, objptr
	add	objptr, #148
	rdlong	_var13, objptr
	sub	objptr, #148
	mov	_var14, _var13
	qmul	_var14, _var02
	getqx	_var15
	mov	_var16, _var15
	add	_var16, _var01
	mov	_var17, _var16
	shl	_var17, #2
	add	_var12, _var17
	wrlong	_var10, _var12
_putcharxyt_ret
	ret

' 
' ''---------- Output a char at x,y and colors f,b, don't change a cursor position
' 
' pub putcharxyct(x,y,achar,f,b) | c
_putcharxyct
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, arg04
	mov	_var05, arg05
' 
' c:=f<<24+b<<16
	mov	_var06, _var04
	shl	_var06, #24
	mov	_var07, _var05
	shl	_var07, #16
	add	_var06, _var07
	mov	_var08, _var06
' long[buf_ptr+4*(cpl*y+x)]:=long[buf_ptr+4*(cpl*y+x)] &$FFFF | c
	rdlong	_var07, objptr
	add	objptr, #148
	rdlong	_var09, objptr
	sub	objptr, #148
	mov	_var10, _var09
	qmul	_var10, _var02
	getqx	_var11
	mov	_var12, _var11
	add	_var12, _var01
	mov	_var13, _var12
	shl	_var13, #2
	add	_var07, _var13
	rdlong	_var06, _var07
	and	_var06, ##65535
	or	_var06, _var08
	rdlong	_var14, objptr
	add	objptr, #148
	rdlong	_var15, objptr
	sub	objptr, #148
	mov	_var16, _var15
	qmul	_var16, _var02
	getqx	_var17
	mov	_var18, _var17
	add	_var18, _var01
	mov	_var19, _var18
	shl	_var19, #2
	add	_var14, _var19
	wrlong	_var06, _var14
' long[buf_ptr+4*(cpl*y+x)]:=(long[buf_ptr+4*(cpl*y+x)] & $FFFFFF00)  |(achar & $000000FF)
	rdlong	_var07, objptr
	add	objptr, #148
	rdlong	_var09, objptr
	sub	objptr, #148
	mov	_var10, _var09
	qmul	_var10, _var02
	getqx	_var11
	mov	_var12, _var11
	add	_var12, _var01
	mov	_var13, _var12
	shl	_var13, #2
	add	_var07, _var13
	rdlong	_var06, _var07
	and	_var06, ##-256
	mov	_var14, _var03
	and	_var14, #255
	or	_var06, _var14
	rdlong	_var18, objptr
	add	objptr, #148
	rdlong	_var19, objptr
	sub	objptr, #148
	mov	_var15, _var19
	qmul	_var15, _var02
	getqx	_var16
	mov	_var17, _var16
	add	_var17, _var01
	mov	_var20, _var17
	shl	_var20, #2
	add	_var18, _var20
	wrlong	_var06, _var18
_putcharxyct_ret
	ret

' 
' ''--------- Output a string at position x,y without changing colors
' 
' pub outtextxyt(x,y,text) | iii
_outtextxyt
	mov	COUNT_, #26
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
' 
' repeat iii from 0 to strsize(text)-1
	mov	local04, #0
	mov	local05, local03
	mov	arg01, local05
	call	#__system____builtin_strlen
	mov	local06, result1
	mov	local07, local06
	sub	local07, #1
	mov	local08, local07
	cmps	local08, #0 wcz
 if_be	jmp	#LR__0092
	mov	local09, #1
	jmp	#LR__0093
LR__0092
	mov	local09, ##-1
LR__0093
	mov	local10, local09
	mov	local11, local08
	add	local11, local10
	mov	local08, local11
LR__0094
'   long[buf_ptr+4*(cpl*y+x+iii)]:=(long[buf_ptr+4*(cpl*y+x+iii)] & $FFFFFF00)  | byte[text+iii]
	rdlong	local12, objptr
	add	objptr, #148
	rdlong	local13, objptr
	sub	objptr, #148
	mov	local14, local13
	qmul	local14, local02
	getqx	local15
	mov	local16, local15
	add	local16, local01
	add	local16, local04
	mov	local17, local16
	shl	local17, #2
	add	local12, local17
	rdlong	local18, local12
	and	local18, ##-256
	mov	local19, local03
	add	local19, local04
	rdbyte	local20, local19
	or	local18, local20
	rdlong	local21, objptr
	add	objptr, #148
	rdlong	local22, objptr
	sub	objptr, #148
	mov	local23, local22
	qmul	local23, local02
	getqx	local24
	mov	local25, local24
	add	local25, local01
	add	local25, local04
	mov	local26, local25
	shl	local26, #2
	add	local21, local26
	wrlong	local18, local21
	mov	local18, local04
	add	local18, local10
	mov	local04, local18
	cmp	local04, local08 wz
 if_ne	jmp	#LR__0094
	mov	ptra, fp
	call	#popregs_
_outtextxyt_ret
	ret

' 
' 
' ''--------- Output a string at position x,y and colors b,f
' 
' pub outtextxyct(x,y,text,f,b) | iii,c
_outtextxyct
	mov	COUNT_, #29
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
' 
' c:=f<<24+b<<16
	mov	local06, local04
	shl	local06, #24
	mov	local07, local05
	shl	local07, #16
	add	local06, local07
	mov	local08, local06
' repeat iii from 0 to strsize(text)-1
	mov	local09, #0
	mov	local07, local03
	mov	arg01, local07
	call	#__system____builtin_strlen
	mov	local10, result1
	mov	local06, local10
	sub	local06, #1
	mov	local11, local06
	cmps	local11, #0 wcz
 if_be	jmp	#LR__0095
	mov	local12, #1
	jmp	#LR__0096
LR__0095
	mov	local12, ##-1
LR__0096
	mov	local13, local12
	mov	local14, local11
	add	local14, local13
	mov	local11, local14
LR__0097
'   long[buf_ptr+4*(cpl*y+x+iii)]:=(long[buf_ptr+4*(cpl*y+x+iii)] & $FFFFFF00)  | byte[text+iii]
	rdlong	local15, objptr
	add	objptr, #148
	rdlong	local16, objptr
	sub	objptr, #148
	mov	local17, local16
	qmul	local17, local02
	getqx	local18
	mov	local19, local18
	add	local19, local01
	add	local19, local09
	mov	local20, local19
	shl	local20, #2
	add	local15, local20
	rdlong	local21, local15
	and	local21, ##-256
	mov	local22, local03
	add	local22, local09
	rdbyte	local23, local22
	or	local21, local23
	rdlong	local24, objptr
	add	objptr, #148
	rdlong	local25, objptr
	sub	objptr, #148
	mov	local26, local25
	qmul	local26, local02
	getqx	local27
	mov	local28, local27
	add	local28, local01
	add	local28, local09
	mov	local29, local28
	shl	local29, #2
	add	local24, local29
	wrlong	local21, local24
'   long[buf_ptr+4*(cpl*y+x+iii)]:=(long[buf_ptr+4*(cpl*y+x+iii)] & $0000FFFF)  | c
	rdlong	local15, objptr
	add	objptr, #148
	rdlong	local16, objptr
	sub	objptr, #148
	mov	local17, local16
	qmul	local17, local02
	getqx	local18
	mov	local19, local18
	add	local19, local01
	add	local19, local09
	mov	local20, local19
	shl	local20, #2
	add	local15, local20
	rdlong	local21, local15
	and	local21, ##65535
	or	local21, local08
	rdlong	local22, objptr
	add	objptr, #148
	rdlong	local27, objptr
	sub	objptr, #148
	mov	local28, local27
	qmul	local28, local02
	getqx	local24
	mov	local23, local24
	add	local23, local01
	add	local23, local09
	mov	local26, local23
	shl	local26, #2
	add	local22, local26
	wrlong	local21, local22
	mov	local21, local09
	add	local21, local13
	mov	local09, local21
	cmp	local09, local11 wz
 if_ne	jmp	#LR__0097
	mov	ptra, fp
	call	#popregs_
_outtextxyct_ret
	ret

' 
' ''---------- Output a char at the cursor position, move the cursor
' 
' pub putchar(achar) | c,x,y
_putchar
	mov	COUNT_, #18
	call	#pushregs_
	mov	local01, arg01
' 
' x:=cursor_x
	add	objptr, #56
	rdbyte	local02, objptr
	sub	objptr, #56
	mov	local03, local02
' y:=cursor_y
	add	objptr, #57
	rdbyte	local02, objptr
	sub	objptr, #57
	mov	local04, local02
' c:=write_color<<24+write_background<<16
	add	objptr, #60
	rdlong	local05, objptr
	sub	objptr, #60
	mov	local02, local05
	shl	local02, #24
	add	objptr, #64
	rdlong	local06, objptr
	sub	objptr, #64
	mov	local07, local06
	shl	local07, #16
	add	local02, local07
	mov	local08, local02
' long[buf_ptr+4*(cpl*y+x)]:=long[buf_ptr+4*(cpl*y+x)] &$FFFF | c
	rdlong	local05, objptr
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	qmul	local10, local04
	getqx	local06
	mov	local07, local06
	add	local07, local03
	mov	local11, local07
	shl	local11, #2
	add	local05, local11
	rdlong	local02, local05
	and	local02, ##65535
	or	local02, local08
	rdlong	local12, objptr
	add	objptr, #148
	rdlong	local13, objptr
	sub	objptr, #148
	mov	local14, local13
	qmul	local14, local04
	getqx	local15
	mov	local16, local15
	add	local16, local03
	mov	local17, local16
	shl	local17, #2
	add	local12, local17
	wrlong	local02, local12
' long[buf_ptr+4*(cpl*y+x)]:=(long[buf_ptr+4*(cpl*y+x)] & $FFFFFF00)  |(achar & $000000FF)
	rdlong	local05, objptr
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	qmul	local10, local04
	getqx	local06
	mov	local07, local06
	add	local07, local03
	mov	local11, local07
	shl	local11, #2
	add	local05, local11
	rdlong	local02, local05
	and	local02, ##-256
	mov	local12, local01
	and	local12, #255
	or	local02, local12
	rdlong	local16, objptr
	add	objptr, #148
	rdlong	local17, objptr
	sub	objptr, #148
	mov	local13, local17
	qmul	local13, local04
	getqx	local14
	mov	local15, local14
	add	local15, local03
	mov	local18, local15
	shl	local18, #2
	add	local16, local18
	wrlong	local02, local16
' cursor_x+=1
	add	objptr, #56
	rdbyte	local05, objptr
	sub	objptr, #56
	mov	local02, local05
	add	local02, #1
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
' if cursor_x==cpl
	add	objptr, #56
	rdbyte	local05, objptr
	sub	objptr, #56
	mov	local02, local05
	add	objptr, #148
	rdlong	local06, objptr
	sub	objptr, #148
	mov	local07, local06
	cmp	local02, local07 wz
 if_ne	jmp	#LR__0099
'   cursor_x:=0
	mov	local02, #0
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
'   cursor_y+=1
	add	objptr, #57
	rdbyte	local05, objptr
	sub	objptr, #57
	mov	local02, local05
	add	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
'   if cursor_y>lines-1
	add	objptr, #152
	rdlong	local05, objptr
	sub	objptr, #152
	mov	local02, local05
	sub	local02, #1
	add	objptr, #57
	rdbyte	local06, objptr
	sub	objptr, #57
	mov	local07, local06
	cmps	local07, local02 wcz
 if_be	jmp	#LR__0098
'     scrollup()
	call	#_scrollup
'     cursor_y:=lines-1
	add	objptr, #152
	rdlong	local05, objptr
	sub	objptr, #152
	mov	local02, local05
	sub	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
LR__0098
LR__0099
	mov	ptra, fp
	call	#popregs_
_putchar_ret
	ret

' 
' ''--------- Output a string at the cursor position, move the cursor
' 
' pub write(text) | iii,c,ncx,ncy
_write
	mov	COUNT_, #33
	call	#pushregs_
	mov	local01, arg01
' 
' c:=write_color<<24+write_background<<16
	add	objptr, #60
	rdlong	local02, objptr
	sub	objptr, #60
	mov	local03, local02
	shl	local03, #24
	add	objptr, #64
	rdlong	local04, objptr
	sub	objptr, #64
	mov	local05, local04
	shl	local05, #16
	add	local03, local05
	mov	local06, local03
' 'debug(uhex_long(write_color))
' ncy:=cursor_y
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local07, local03
' ncx:=cursor_x+strsize(text)
	add	objptr, #56
	rdbyte	local02, objptr
	sub	objptr, #56
	mov	local03, local02
	mov	local05, local01
	mov	arg01, local05
	call	#__system____builtin_strlen
	mov	local04, result1
	add	local03, local04
	mov	local08, local03
' repeat while ncx>cpl-1
LR__0100
	add	objptr, #148
	rdlong	local02, objptr
	sub	objptr, #148
	mov	local03, local02
	sub	local03, #1
	cmps	local08, local03 wcz
 if_be	jmp	#LR__0101
'   ncx-=cpl
	mov	local03, local08
	add	objptr, #148
	rdlong	local05, objptr
	sub	objptr, #148
	mov	local02, local05
	sub	local03, local02
	mov	local08, local03
'   ncy+=1
	mov	local03, local07
	add	local03, #1
	mov	local07, local03
	jmp	#LR__0100
LR__0101
' repeat while ncy>lines-1
LR__0102
	add	objptr, #152
	rdlong	local02, objptr
	sub	objptr, #152
	mov	local03, local02
	sub	local03, #1
	cmps	local07, local03 wcz
 if_be	jmp	#LR__0103
'   ncy-=1
	mov	local03, local07
	sub	local03, #1
	mov	local07, local03
'   scrollup()
	call	#_scrollup
'   cursor_y-=1
	add	objptr, #57
	rdbyte	local02, objptr
	sub	objptr, #57
	mov	local03, local02
	sub	local03, #1
	add	objptr, #57
	wrbyte	local03, objptr
	sub	objptr, #57
	jmp	#LR__0102
LR__0103
' 
' repeat iii from 0 to strsize(text)-1
	mov	local09, #0
	mov	local02, local01
	mov	arg01, local02
	call	#__system____builtin_strlen
	mov	local05, result1
	mov	local03, local05
	sub	local03, #1
	mov	local10, local03
	cmps	local10, #0 wcz
 if_be	jmp	#LR__0104
	mov	local04, #1
	jmp	#LR__0105
LR__0104
	mov	local04, ##-1
LR__0105
	mov	local11, local04
	mov	local12, local10
	add	local12, local11
	mov	local10, local12
LR__0106
' 
'   long[buf_ptr+4*(cpl*cursor_y+cursor_x+iii)]:=long[buf_ptr+4*(cpl*cursor_y+cursor_x+iii)] &$FFFF | c
	rdlong	local13, objptr
	add	objptr, #148
	rdlong	local14, objptr
	sub	objptr, #148
	mov	local15, local14
	add	objptr, #57
	rdbyte	local16, objptr
	sub	objptr, #57
	mov	local17, local16
	qmul	local15, local17
	getqx	local18
	mov	local19, local18
	add	objptr, #56
	rdbyte	local20, objptr
	sub	objptr, #56
	mov	local21, local20
	add	local19, local21
	add	local19, local09
	mov	local22, local19
	shl	local22, #2
	add	local13, local22
	rdlong	local23, local13
	and	local23, ##65535
	or	local23, local06
	rdlong	local24, objptr
	add	objptr, #148
	rdlong	local25, objptr
	sub	objptr, #148
	mov	local26, local25
	add	objptr, #57
	rdbyte	local27, objptr
	sub	objptr, #57
	mov	local28, local27
	qmul	local26, local28
	getqx	local29
	mov	local30, local29
	add	objptr, #56
	rdbyte	local31, objptr
	sub	objptr, #56
	mov	local32, local31
	add	local30, local32
	add	local30, local09
	mov	local33, local30
	shl	local33, #2
	add	local24, local33
	wrlong	local23, local24
	mov	local23, local09
	add	local23, local11
	mov	local09, local23
	cmp	local09, local10 wz
 if_ne	jmp	#LR__0106
' 
' outtextxy(cursor_x,cursor_y,text)
	add	objptr, #232
	rdlong	local04, objptr
	sub	objptr, #232
	mov	local03, local04
	rdlong	local02, local03
	add	local03, #4
	rdlong	local12, local03
	sub	local03, #4
	mov	local05, local12
	add	objptr, #56
	rdbyte	local13, objptr
	sub	objptr, #56
	mov	local23, local13
	add	objptr, #57
	rdbyte	local18, objptr
	sub	objptr, #57
	mov	local19, local18
	mov	local15, local01
	mov	arg01, local23
	mov	arg02, local19
	mov	arg03, local15
	mov	local14, objptr
	mov	objptr, local02
	call	local05
	mov	objptr, local14
	mov	local17, result1
' 
' cursor_x:=ncx
	add	objptr, #56
	wrbyte	local08, objptr
	sub	objptr, #56
' cursor_y:=ncy
	add	objptr, #57
	wrbyte	local07, objptr
	sub	objptr, #57
	mov	ptra, fp
	call	#popregs_
_write_ret
	ret

' 
' '--------- Output a string at the cursor position x,y, move the cursor to the next line
' 
' pub writeln(text)
_writeln
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
' 
' write(text)
	mov	local02, local01
	mov	arg01, local02
	call	#_write
' cursor_x:=0
	mov	local02, #0
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
' cursor_y+=1
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local02, local03
	add	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
' if (cursor_y>lines-1)
	add	objptr, #152
	rdlong	local03, objptr
	sub	objptr, #152
	mov	local02, local03
	sub	local02, #1
	add	objptr, #57
	rdbyte	local04, objptr
	sub	objptr, #57
	mov	local05, local04
	cmps	local05, local02 wcz
 if_be	jmp	#LR__0107
'   scrollup()
	call	#_scrollup
'   cursor_y:=lines-1
	add	objptr, #152
	rdlong	local03, objptr
	sub	objptr, #152
	mov	local02, local03
	sub	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
LR__0107
	mov	ptra, fp
	call	#popregs_
_writeln_ret
	ret

' 
' ''-----------  Scroll the screen one line up
' 
' pub scrollup() | i
_scrollup
	mov	COUNT_, #20
	call	#pushregs_
' 
' longmove(buf_ptr,buf_ptr+4*cpl,buflen-cpl)
	rdlong	local01, objptr
	rdlong	local02, objptr
	add	objptr, #148
	rdlong	local03, objptr
	sub	objptr, #148
	mov	local04, local03
	mov	local05, local04
	shl	local05, #2
	add	local02, local05
	mov	local06, local02
	add	objptr, #52
	rdlong	local07, objptr
	sub	objptr, #52
	mov	local08, local07
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	sub	local08, local10
	mov	local11, local08
	mov	arg01, local01
	mov	arg02, local06
	mov	arg03, local11
	call	#__system__longmove
	mov	local12, result1
' repeat i from buflen-cpl to buflen-1
	add	objptr, #52
	rdlong	local02, objptr
	sub	objptr, #52
	mov	local01, local02
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	local05, local04
	sub	local01, local05
	mov	local13, local01
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local03, local06
	sub	local03, #1
	mov	local14, local03
	add	objptr, #52
	rdlong	local10, objptr
	sub	objptr, #52
	mov	local07, local10
	add	objptr, #148
	rdlong	local11, objptr
	sub	objptr, #148
	mov	local09, local11
	sub	local07, local09
	cmps	local14, local07 wcz
 if_be	jmp	#LR__0108
	mov	local08, #1
	jmp	#LR__0109
LR__0108
	mov	local08, ##-1
LR__0109
	mov	local15, local08
	mov	local12, local14
	add	local12, local15
	mov	local14, local12
LR__0110
'   long[buf_ptr+4*i]:=(long[buf_ptr+4*i] & $FFFF0000) | 32
	rdlong	local16, objptr
	mov	local17, local13
	shl	local17, #2
	add	local16, local17
	rdlong	local18, local16
	and	local18, ##-65536
	or	local18, #32
	rdlong	local19, objptr
	mov	local20, local13
	shl	local20, #2
	add	local19, local20
	wrlong	local18, local19
	mov	local18, local13
	add	local18, local15
	mov	local13, local18
	cmp	local13, local14 wz
 if_ne	jmp	#LR__0110
	mov	ptra, fp
	call	#popregs_
_scrollup_ret
	ret

' 
' ''----------- Scroll the screen one line down
' 
' pub scrolldown() | i
_scrolldown
	mov	COUNT_, #15
	call	#pushregs_
' 
' longmove(buf_ptr+cpl*4,buf_ptr,buflen-cpl)
	rdlong	local01, objptr
	add	objptr, #148
	rdlong	local02, objptr
	sub	objptr, #148
	mov	local03, local02
	mov	local04, local03
	shl	local04, #2
	add	local01, local04
	mov	local05, local01
	rdlong	local06, objptr
	add	objptr, #52
	rdlong	local07, objptr
	sub	objptr, #52
	mov	local08, local07
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	sub	local08, local10
	mov	local11, local08
	mov	arg01, local05
	mov	arg02, local06
	mov	arg03, local11
	call	#__system__longmove
	mov	local12, result1
' repeat i from 0 to cpl-1
	mov	local13, #0
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	local01, local04
	sub	local01, #1
	mov	local14, local01
	cmps	local14, #0 wcz
 if_be	jmp	#LR__0111
	mov	local03, #1
	jmp	#LR__0112
LR__0111
	mov	local03, ##-1
LR__0112
	mov	local15, local03
	mov	local02, local14
	add	local02, local15
	mov	local14, local02
LR__0113
'   long[buf_ptr+4*i]:=(long[buf_ptr+4*i] & $FFFF0000) | 32
	rdlong	local06, objptr
	mov	local08, local13
	shl	local08, #2
	add	local06, local08
	rdlong	local05, local06
	and	local05, ##-65536
	or	local05, #32
	rdlong	local07, objptr
	mov	local10, local13
	shl	local10, #2
	add	local07, local10
	wrlong	local05, local07
	mov	local05, local13
	add	local05, local15
	mov	local13, local05
	cmp	local13, local14 wz
 if_ne	jmp	#LR__0113
	mov	ptra, fp
	call	#popregs_
_scrolldown_ret
	ret

' 
' ''----------- Set cursor at the first character in a new line, scroll if needed
' 
' pub crlf()
_crlf
	mov	COUNT_, #4
	call	#pushregs_
' 
' cursor_x:=0
	mov	local01, #0
	add	objptr, #56
	wrbyte	local01, objptr
	sub	objptr, #56
' cursor_y+=1
	add	objptr, #57
	rdbyte	local02, objptr
	sub	objptr, #57
	mov	local01, local02
	add	local01, #1
	add	objptr, #57
	wrbyte	local01, objptr
	sub	objptr, #57
' if cursor_y>lines-1
	add	objptr, #152
	rdlong	local02, objptr
	sub	objptr, #152
	mov	local01, local02
	sub	local01, #1
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local04, local03
	cmps	local04, local01 wcz
 if_be	jmp	#LR__0114
'   scrollup()
	call	#_scrollup
'   cursor_y:=lines-1
	add	objptr, #152
	rdlong	local02, objptr
	sub	objptr, #152
	mov	local01, local02
	sub	local01, #1
	add	objptr, #57
	wrbyte	local01, objptr
	sub	objptr, #57
LR__0114
	mov	ptra, fp
	call	#popregs_
_crlf_ret
	ret

' 
' ''---------- Backspace. Move the cursor back, clear a character
' 
' pub bksp()
_bksp
	mov	COUNT_, #13
	call	#pushregs_
' 
' cursor_x-=1
	add	objptr, #56
	rdbyte	local01, objptr
	sub	objptr, #56
	mov	local02, local01
	sub	local02, #1
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
' if cursor_x==255
	add	objptr, #56
	rdbyte	local01, objptr
	sub	objptr, #56
	mov	local02, local01
	cmp	local02, #255 wz
 if_ne	jmp	#LR__0116
'   cursor_x:=cpl-1
	add	objptr, #148
	rdlong	local01, objptr
	sub	objptr, #148
	mov	local02, local01
	sub	local02, #1
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
'   cursor_y-=1
	add	objptr, #57
	rdbyte	local01, objptr
	sub	objptr, #57
	mov	local02, local01
	sub	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
'   if cursor_y==255
	add	objptr, #57
	rdbyte	local01, objptr
	sub	objptr, #57
	mov	local02, local01
	cmp	local02, #255 wz
 if_ne	jmp	#LR__0115
'     cursor_y:=0
	mov	local02, #0
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
'     scrollup()
	call	#_scrollup
LR__0115
LR__0116
' 
' outtextxy(cursor_x,cursor_y,string(" "))
	add	objptr, #232
	rdlong	local03, objptr
	sub	objptr, #232
	mov	local02, local03
	rdlong	local01, local02
	add	local02, #4
	rdlong	local04, local02
	sub	local02, #4
	mov	local05, local04
	add	objptr, #56
	rdbyte	local06, objptr
	sub	objptr, #56
	mov	local07, local06
	add	objptr, #57
	rdbyte	local08, objptr
	sub	objptr, #57
	mov	local09, local08
	mov	local10, ##@LR__0311
	mov	local11, local10
	mov	arg01, local07
	mov	arg02, local09
	mov	arg03, local11
	mov	local12, objptr
	mov	objptr, local01
	call	local05
	mov	objptr, local12
	mov	local13, result1
	mov	ptra, fp
	call	#popregs_
_bksp_ret
	ret

' 
' 
' '*************************************************************************
' '                                                                        *
' '  Conversions                                                           *
' '                                                                        *
' '*************************************************************************
' 
' ''---------- Convert a integer to dec string, return a pointer
' 
' pub inttostr(i):result |q,pos,k,j
_inttostr
	mov	COUNT_, #13
	call	#pushregs_
	mov	local01, arg01
	mov	local02, #0
' 
' j:=i
	mov	local03, local01
' pos:=10
	mov	local04, #10
' k:=0
	mov	local05, #0
' 
' if (j==0)
	cmp	local03, #0 wz
 if_ne	jmp	#LR__0117
'   n_string[0]:=48
	mov	local06, #48
	add	objptr, #72
	wrbyte	local06, objptr
	sub	objptr, #72
'   n_string[1]:=0
	mov	local06, #0
	add	objptr, #73
	wrbyte	local06, objptr
	sub	objptr, #73
' 
' else
	jmp	#LR__0124
LR__0117
'   if (j<0)
	cmps	local03, #0 wcz
 if_ae	jmp	#LR__0118
'     j:=0-j
	mov	local06, #0
	sub	local06, local03
	mov	local03, local06
'     k:=45
	mov	local05, #45
LR__0118
' 
'   n_string[11]:=0
	mov	local06, #0
	add	objptr, #83
	wrbyte	local06, objptr
	sub	objptr, #83
'   repeat while (pos>-1)
LR__0119
	cmps	local04, ##-1 wcz
 if_be	jmp	#LR__0120
'     q:=j//10
	mov	muldiva_, local03
	mov	muldivb_, #10
	call	#divide_
	mov	local06, muldiva_
	mov	local07, local06
'     q:=48+q
	mov	local06, #48
	add	local06, local07
	mov	local07, local06
'     n_string[pos]:=q
	mov	local06, local04
	add	objptr, #72
	mov	local08, objptr
	sub	objptr, #72
	add	local06, local08
	wrbyte	local07, local06
'     j:=j/10
	mov	local06, muldivb_
	mov	local03, local06
'     pos-=1
	mov	local06, local04
	sub	local06, #1
	mov	local04, local06
	jmp	#LR__0119
LR__0120
'   repeat while n_string[0]==48
LR__0121
	add	objptr, #72
	rdbyte	local08, objptr
	sub	objptr, #72
	mov	local06, local08
	cmp	local06, #48 wz
 if_ne	jmp	#LR__0122
'     bytemove(@n_string,@n_string+1,12)
	add	objptr, #72
	mov	local06, objptr
	sub	objptr, #72
	mov	local08, local06
	add	objptr, #72
	mov	local09, objptr
	sub	objptr, #72
	mov	local10, local09
	add	local10, #1
	mov	local11, local10
	mov	local12, #12
	mov	arg01, local08
	mov	arg02, local11
	mov	arg03, local12
	call	#__system__bytemove
	mov	local13, result1
	jmp	#LR__0121
LR__0122
' 
'   if k==45
	cmp	local05, #45 wz
 if_ne	jmp	#LR__0123
'      bytemove(@n_string+1,@n_string,12)
	add	objptr, #72
	mov	local08, objptr
	sub	objptr, #72
	mov	local06, local08
	add	local06, #1
	mov	local10, local06
	add	objptr, #72
	mov	local09, objptr
	sub	objptr, #72
	mov	local11, local09
	mov	local12, #12
	mov	arg01, local10
	mov	arg02, local11
	mov	arg03, local12
	call	#__system__bytemove
	mov	local13, result1
'      n_string[0]:=k
	add	objptr, #72
	wrbyte	local05, objptr
	sub	objptr, #72
LR__0123
LR__0124
' 
' q:=@n_string
	add	objptr, #72
	mov	local06, objptr
	sub	objptr, #72
	mov	local07, local06
' return q
	mov	result1, local07
	jmp	#LR__0125
LR__0125
	mov	ptra, fp
	call	#popregs_
_inttostr_ret
	ret

' 
' ''----------  Convert unsigned integer to hex string with d digits, return a pointer
' 
' pub inttohex(i,d):result |q,pos,k,j
_inttohex
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, #0
' 
' j:=i
	mov	_var04, _var01
' pos:=d-1
	mov	_var05, _var02
	sub	_var05, #1
	mov	_var06, _var05
' k:=0
	mov	_var07, #0
' n_string[d]:=0
	mov	_var05, _var02
	add	objptr, #72
	mov	_var08, objptr
	sub	objptr, #72
	add	_var05, _var08
	mov	_var09, #0
	wrbyte	_var09, _var05
' repeat k from 0 to d-1
	mov	_var07, #0
	mov	_var05, _var02
	sub	_var05, #1
	mov	_var10, _var05
	cmps	_var10, #0 wcz
 if_be	jmp	#LR__0126
	mov	_var08, #1
	jmp	#LR__0127
LR__0126
	mov	_var08, ##-1
LR__0127
	mov	_var11, _var08
	mov	_var09, _var10
	add	_var09, _var11
	mov	_var10, _var09
LR__0128
'   n_string[k]:=48
	mov	_var12, _var07
	add	objptr, #72
	mov	_var13, objptr
	sub	objptr, #72
	add	_var12, _var13
	mov	_var14, #48
	wrbyte	_var14, _var12
LR__0129
	mov	_var12, _var07
	add	_var12, _var11
	mov	_var07, _var12
	cmp	_var07, _var10 wz
 if_ne	jmp	#LR__0128
LR__0130
' if (j<>0)
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0134
' 
'   repeat while (pos>-1)
LR__0131
	cmps	_var06, ##-1 wcz
 if_be	jmp	#LR__0133
'     q:=j+//16
	mov	_var05, _var04
	and	_var05, #15
	mov	_var15, _var05
'     if (q>9)
	cmps	_var15, #9 wcz
 if_be	jmp	#LR__0132
'       q:=q+7
	mov	_var05, _var15
	add	_var05, #7
	mov	_var15, _var05
LR__0132
'     q:=48+q
	mov	_var05, #48
	add	_var05, _var15
	mov	_var15, _var05
'     n_string[pos]:=q
	mov	_var05, _var06
	add	objptr, #72
	mov	_var08, objptr
	sub	objptr, #72
	add	_var05, _var08
	wrbyte	_var15, _var05
'     j:=j+/16
	mov	_var05, _var04
	shr	_var05, #4
	mov	_var04, _var05
'     pos-=1
	mov	_var05, _var06
	sub	_var05, #1
	mov	_var06, _var05
	jmp	#LR__0131
LR__0133
LR__0134
' 
' q:=@n_string
	add	objptr, #72
	mov	_var05, objptr
	sub	objptr, #72
	mov	_var15, _var05
' return q
	mov	result1, _var15
	jmp	#_inttohex_ret
_inttohex_ret
	ret

' 
' 
' 
' '*************************************************************************
' '                                                                        *
' '  Mode setting and driver start                                                          *
' '                                                                        *
' '*************************************************************************
' 
' ''---------  Set the graphics mode
' 
' 
' 
' pub setmode(mode) | i', 'xzoom, yzoom, azoom
_setmode
	mov	COUNT_, #10
	call	#pushregs_
	mov	local01, arg01
' 
' '' mode:tn_bb_cc_vv_hh
' '' hh - h.zoom, vv-v.zoom, cc-c.depth,
' '' bb - borders/total pixels, 00-wide/1140, 01 medium/1026, 10 narrow/912, 11 no border, 1024 px PAL, 880 px NTSC
' 
' case_fast (mode>>6) & 7 ' timings are the same for graphic and text
	mov	local02, local01
	shr	local02, #6
	and	local02, #7
	fle	local02, #8
	mov	local03, local02
	jmprel	local03
LR__0135
	jmp	#LR__0136
	jmp	#LR__0137
	jmp	#LR__0138
	jmp	#LR__0139
	jmp	#LR__0140
	jmp	#LR__0141
	jmp	#LR__0142
	jmp	#LR__0143
	jmp	#LR__0144
LR__0136
'                               
'     0:  longmove(@timings,@timings000,16)   'PAL 50 Hz signaling 1140x624, active 800x480, 100x30 text, wide border, 2 colors per pixel, 00_00_00_00_00=0, 354_693_878 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7256
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7256
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0137
'     1:  longmove(@timings,@timings064,16)   'PAL 50 Hz signaling 1026x624, active 880x496, 110x31 text, medium border, 2 colors per pixel 00_01_00_00_00=64, 319_215_686 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7320
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7320
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0138
'     2:  longmove(@timings,@timings128,16)   'PAL 50 Hz signaling 912x624, active 800x480, 100x30 text, medium border, 2 colors per pixel 00_10_00_00_00=64, 283750000z
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7384
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7384
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0139
'     3:  longmove(@timings,@timings192,16)   'PAL 50 Hz signaling 1140x624, active 1024x576, 128x36 text, borderless, 2 colors per pixel 00_11_00_00_00=6192, 354_693_878 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7448
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7448
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0140
'     4:  longmove(@timings,@timings256,16)   'NTSC 50 Hz signaling 1140x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_00_00_00_00=256, 357959184 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7512
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7512
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0141
'     5:  longmove(@timings,@timings320,16)   'NTSC 50 Hz signaling 1026x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_01_00_00_00=320, 322162162 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7576
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7576
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0142
'     6:  longmove(@timings,@timings384,16)   'NTSC 50 Hz signaling 912x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_10_00_00_00=384, 286363636 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7640
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7640
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0143
'     7:  longmove(@timings,@timings448,16)   'NTSC 50 Hz signaling 1026x524, active 880x496, 110x31 text, borderless, 2 colors per pixel, 01_11_00_00_00=496, 322162162 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7704
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7704
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0144
LR__0144
' 
' ' 4-bit graphics: do nothing with timings :) 
' 
' if (mode & (%10_00_11_0000))==(%10_00_11_0000) ' 8bit graphics, 4 pixels per long instead of 8, cpp x2 
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##560 wz
 if_ne	jmp	#LR__0145
'   timings[5]:=4
	mov	local02, #4
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
'   timings[11]:=timings[11]<<1
	add	objptr, #128
	rdlong	local04, objptr
	sub	objptr, #128
	mov	local02, local04
	shl	local02, #1
	add	objptr, #128
	wrlong	local02, objptr
	sub	objptr, #128
LR__0145
'   
' if (mode & (%10_00_11_0000))==(%10_00_01_0000) ' 2bit graphics, 16 pixels per long instead of 8, cpp /2 
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##528 wz
 if_ne	jmp	#LR__0146
'   timings[5]:=16
	mov	local02, #16
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
'   timings[11]:=timings[11]>>1
	add	objptr, #128
	rdlong	local04, objptr
	sub	objptr, #128
	mov	local02, local04
	shr	local02, #1
	add	objptr, #128
	wrlong	local02, objptr
	sub	objptr, #128
LR__0146
'   
' if (mode & (%10_00_11_0000))==(%10_00_00_0000) ' 1bit graphics, 32 pixels per long instead of 8, cpp /4 
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##512 wz
 if_ne	jmp	#LR__0147
'   timings[5]:=32
	mov	local02, #32
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
'   timings[11]:=timings[11]>>2
	add	objptr, #128
	rdlong	local04, objptr
	sub	objptr, #128
	mov	local02, local04
	shr	local02, #2
	add	objptr, #128
	wrlong	local02, objptr
	sub	objptr, #128
LR__0147
' 
' 
' repeat i from 0 to 4
	mov	local10, #0
LR__0148
'   timings[i]:=timings[i]+hdmibase<<17+ timingsxxt
	mov	local04, local10
	shl	local04, #2
	add	objptr, #84
	mov	local05, objptr
	sub	objptr, #84
	add	local04, local05
	add	objptr, #40
	rdlong	local07, objptr
	sub	objptr, #40
	mov	local06, local07
	shl	local06, #17
	rdlong	local02, local04
	add	local02, local06
	add	local02, ##1887502336
	mov	local08, local10
	shl	local08, #2
	add	objptr, #84
	mov	local09, objptr
	sub	objptr, #84
	add	local08, local09
	wrlong	local02, local08
	mov	local02, local10
	mov	local04, local10
	add	local04, #1
	mov	local10, local04
	cmps	local10, #5 wcz
 if_b	jmp	#LR__0148
' timings[5]:=timings[5]+hdmibase<<17  
	add	objptr, #40
	rdlong	local05, objptr
	sub	objptr, #40
	mov	local04, local05
	shl	local04, #17
	add	objptr, #104
	rdlong	local06, objptr
	sub	objptr, #104
	mov	local02, local06
	add	local02, local04
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
' clkfreq:=timings[13]
	add	objptr, #136
	rdlong	local02, objptr
	sub	objptr, #136
	wrlong	local02, #20
' hubset(timings[14])
	add	objptr, #140
	rdlong	local04, objptr
	sub	objptr, #140
	mov	local02, local04
	mov	arg01, local02
	call	#__system___hubset
' waitms(1)
	mov	local02, #1
	mov	arg01, local02
	call	#__system___waitms
' 
'   
' xzoom:=1<<(mode & 3)
	mov	local04, local01
	and	local04, #3
	mov	local02, #1
	shl	local02, local04
	add	objptr, #212
	wrlong	local02, objptr
	sub	objptr, #212
' yzoom:=1<<((mode>>2) & 3)
	mov	local04, local01
	shr	local04, #2
	and	local04, #3
	mov	local02, #1
	shl	local02, local04
	add	objptr, #216
	wrlong	local02, objptr
	sub	objptr, #216
' azoom:=xzoom*yzoom
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	local04, local05
	add	objptr, #216
	rdlong	local07, objptr
	sub	objptr, #216
	mov	local06, local07
	qmul	local04, local06
	getqx	local02
	add	objptr, #220
	wrlong	local02, objptr
	sub	objptr, #220
'    
' cpl:=timings[11]
	add	objptr, #128
	rdlong	local02, objptr
	sub	objptr, #128
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
' if (mode<512)
	cmps	local01, ##512 wcz
 if_ae	jmp	#LR__0150
'   lines:=(timings[12]>>4)+/yzoom
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	local02, local04
	shr	local02, #4
	mov	muldiva_, local02
	add	objptr, #216
	rdlong	local06, objptr
	sub	objptr, #216
	mov	muldivb_, local06
	call	#unsdivide_
	mov	local05, muldivb_
	add	objptr, #152
	wrlong	local05, objptr
	sub	objptr, #152
'   if ((timings[12]>>4)+//yzoom) <>0
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	local02, local04
	shr	local02, #4
	mov	muldiva_, local02
	add	objptr, #216
	rdlong	local06, objptr
	sub	objptr, #216
	mov	muldivb_, local06
	call	#unsdivide_
	mov	local05, muldiva_
	cmp	local05, #0 wz
 if_e	jmp	#LR__0149
'     lines +=1
	add	objptr, #152
	rdlong	local04, objptr
	sub	objptr, #152
	mov	local02, local04
	add	local02, #1
	add	objptr, #152
	wrlong	local02, objptr
	sub	objptr, #152
LR__0149
'   cpl:=cpl/xzoom
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
' else
	jmp	#LR__0151
LR__0150
'   lines:=timings[12]/yzoom
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	muldiva_, local04
	add	objptr, #216
	rdlong	local05, objptr
	sub	objptr, #216
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #152
	wrlong	local02, objptr
	sub	objptr, #152
'   cpl:=cpl/xzoom
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
LR__0151
' 
' buflen:=(cpl*lines)
	add	objptr, #148
	rdlong	local05, objptr
	sub	objptr, #148
	mov	local04, local05
	add	objptr, #152
	rdlong	local07, objptr
	sub	objptr, #152
	mov	local06, local07
	qmul	local04, local06
	getqx	local02
	add	objptr, #52
	wrlong	local02, objptr
	sub	objptr, #52
' 
' buf_ptr:=$80000-4*buflen
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local05, local06
	mov	local04, local05
	shl	local04, #2
	mov	local02, ##524288
	sub	local02, local04
	wrlong	local02, objptr
' mode_ptr:=@timings
	add	objptr, #84
	mov	local02, objptr
	sub	objptr, #84
	add	objptr, #20
	wrlong	local02, objptr
	sub	objptr, #20
' graphmode:=mode
	add	objptr, #208
	wrlong	local01, objptr
	sub	objptr, #208
' pintoggle(15)
	mov	local02, #15
	mov	arg01, local02
	call	#__system___drvnot
' makedl(mode)
	mov	local02, local01
	mov	arg01, local02
	call	#_makedl
	mov	ptra, fp
	call	#popregs_
_setmode_ret
	ret

' 
' 
' pub setmode2(mode) | i', 'xzoom, yzoom, azoom
_setmode2
	mov	COUNT_, #10
	call	#pushregs_
	mov	local01, arg01
' 
' '' mode:tn_bb_cc_vv_hh
' '' hh - h.zoom, vv-v.zoom, cc-c.depth,
' '' bb - borders/total pixels, 00-wide/1140, 01 medium/1026, 10 narrow/912, 11 no border, 1024 px PAL, 880 px NTSC
' 
' 'if mode==(512+192+48) 'borderless 8 bpp, no ram for this
' '  return
' case_fast (mode>>6) & 7 ' timings are the same for graphic and text
	mov	local02, local01
	shr	local02, #6
	and	local02, #7
	fle	local02, #8
	mov	local03, local02
	jmprel	local03
LR__0152
	jmp	#LR__0153
	jmp	#LR__0154
	jmp	#LR__0155
	jmp	#LR__0156
	jmp	#LR__0157
	jmp	#LR__0158
	jmp	#LR__0159
	jmp	#LR__0160
	jmp	#LR__0161
LR__0153
'                               
'     0:  longmove(@timings,@timings000,16)   'PAL 50 Hz signaling 1140x624, active 800x480, 100x30 text, wide border, 2 colors per pixel, 00_00_00_00_00=0, 354_693_878 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7256
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7256
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0154
'     1:  longmove(@timings,@timings064,16)   'PAL 50 Hz signaling 1026x624, active 880x496, 110x31 text, medium border, 2 colors per pixel 00_01_00_00_00=64, 319_215_686 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7320
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7320
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0155
'     2:  longmove(@timings,@timings128,16)   'PAL 50 Hz signaling 912x624, active 800x480, 100x30 text, medium border, 2 colors per pixel 00_10_00_00_00=64, 283750000z
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7384
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7384
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0156
'     3:  longmove(@timings,@timings192,16)   'PAL 50 Hz signaling 1140x624, active 1024x576, 128x36 text, borderless, 2 colors per pixel 00_11_00_00_00=6192, 354_693_878 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7448
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7448
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0157
'     4:  longmove(@timings,@timings256,16)   'NTSC 50 Hz signaling 1140x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_00_00_00_00=256, 357959184 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7512
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7512
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0158
'     5:  longmove(@timings,@timings320,16)   'NTSC 50 Hz signaling 1026x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_01_00_00_00=320, 322162162 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7576
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7576
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0159
'     6:  longmove(@timings,@timings384,16)   'NTSC 50 Hz signaling 912x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_10_00_00_00=384, 286363636 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7640
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7640
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0160
'     7:  longmove(@timings,@timings448,16)   'NTSC 50 Hz signaling 1026x524, active 880x496, 110x31 text, borderless, 2 colors per pixel, 01_11_00_00_00=496, 322162162 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7704
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7704
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0161
LR__0161
' 
' if (mode & (%10_00_11_0000))==(%10_00_11_0000) ' 8bit graphics, 4 pixels per long instead of 8, cpp x2 
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##560 wz
 if_ne	jmp	#LR__0162
'   timings[5]:=4
	mov	local02, #4
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
'   timings[11]:=timings[11]<<1
	add	objptr, #128
	rdlong	local04, objptr
	sub	objptr, #128
	mov	local02, local04
	shl	local02, #1
	add	objptr, #128
	wrlong	local02, objptr
	sub	objptr, #128
LR__0162
' '  putpixel:=@putpixel8
'     
' if (mode & (%10_00_11_0000))==(%10_00_01_0000) ' 2bit graphics, 16 pixels per long instead of 8, cpp /2 
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##528 wz
 if_ne	jmp	#LR__0163
'   timings[5]:=16
	mov	local02, #16
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
'   timings[11]:=timings[11]>>1
	add	objptr, #128
	rdlong	local04, objptr
	sub	objptr, #128
	mov	local02, local04
	shr	local02, #1
	add	objptr, #128
	wrlong	local02, objptr
	sub	objptr, #128
LR__0163
' '  putpixel:=@putpixel2  
'   
' if (mode & (%10_00_11_0000))==(%10_00_00_0000) ' 1bit graphics, 32 pixels per long instead of 8, cpp /4 
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##512 wz
 if_ne	jmp	#LR__0164
'   timings[5]:=32
	mov	local02, #32
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
'   timings[11]:=timings[11]>>2
	add	objptr, #128
	rdlong	local04, objptr
	sub	objptr, #128
	mov	local02, local04
	shr	local02, #2
	add	objptr, #128
	wrlong	local02, objptr
	sub	objptr, #128
LR__0164
' '  putpixel:=@putpixel1  
'   
' 'if (mode & (%10_00_11_0000))==(%10_00_10_0000) ' 4bit graphics, 32 pixels per long instead of 8, cpp /4 
' '  putpixel:=@putpixel4  
' 
' 
' repeat i from 0 to 4
	mov	local10, #0
LR__0165
'   timings[i]:=timings[i]+hdmibase<<17+ timingsxxt
	mov	local04, local10
	shl	local04, #2
	add	objptr, #84
	mov	local05, objptr
	sub	objptr, #84
	add	local04, local05
	add	objptr, #40
	rdlong	local07, objptr
	sub	objptr, #40
	mov	local06, local07
	shl	local06, #17
	rdlong	local02, local04
	add	local02, local06
	add	local02, ##1887502336
	mov	local08, local10
	shl	local08, #2
	add	objptr, #84
	mov	local09, objptr
	sub	objptr, #84
	add	local08, local09
	wrlong	local02, local08
	mov	local02, local10
	mov	local04, local10
	add	local04, #1
	mov	local10, local04
	cmps	local10, #5 wcz
 if_b	jmp	#LR__0165
' timings[5]:=timings[5]+hdmibase<<17  
	add	objptr, #40
	rdlong	local05, objptr
	sub	objptr, #40
	mov	local04, local05
	shl	local04, #17
	add	objptr, #104
	rdlong	local06, objptr
	sub	objptr, #104
	mov	local02, local06
	add	local02, local04
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
' clkfreq:=timings[13]
	add	objptr, #136
	rdlong	local02, objptr
	sub	objptr, #136
	wrlong	local02, #20
' hubset(timings[14])
	add	objptr, #140
	rdlong	local04, objptr
	sub	objptr, #140
	mov	local02, local04
	mov	arg01, local02
	call	#__system___hubset
' waitms(1)
	mov	local02, #1
	mov	arg01, local02
	call	#__system___waitms
' 
'   
' xzoom:=1<<(mode & 3)
	mov	local04, local01
	and	local04, #3
	mov	local02, #1
	shl	local02, local04
	add	objptr, #212
	wrlong	local02, objptr
	sub	objptr, #212
' if (xzoom==8) && (((mode>>4)&3)<>3)
	add	objptr, #212
	rdlong	local04, objptr
	sub	objptr, #212
	mov	local02, local04
	cmp	local02, #8 wz
 if_ne	jmp	#LR__0166
	mov	local05, local01
	shr	local05, #4
	and	local05, #3
	cmp	local05, #3 wz
 if_e	jmp	#LR__0166
'   xzoom:=4
	mov	local02, #4
	add	objptr, #212
	wrlong	local02, objptr
	sub	objptr, #212
LR__0166
' yzoom:=1<<((mode>>2) & 3)
	mov	local04, local01
	shr	local04, #2
	and	local04, #3
	mov	local02, #1
	shl	local02, local04
	add	objptr, #216
	wrlong	local02, objptr
	sub	objptr, #216
' azoom:=xzoom*yzoom
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	local04, local05
	add	objptr, #216
	rdlong	local07, objptr
	sub	objptr, #216
	mov	local06, local07
	qmul	local04, local06
	getqx	local02
	add	objptr, #220
	wrlong	local02, objptr
	sub	objptr, #220
'    
' cpl:=timings[11]
	add	objptr, #128
	rdlong	local02, objptr
	sub	objptr, #128
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
' 
' if (mode<512)
	cmps	local01, ##512 wcz
 if_ae	jmp	#LR__0170
'   lines:=(timings[12]>>4)+/yzoom
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	local02, local04
	shr	local02, #4
	mov	muldiva_, local02
	add	objptr, #216
	rdlong	local06, objptr
	sub	objptr, #216
	mov	muldivb_, local06
	call	#unsdivide_
	mov	local05, muldivb_
	add	objptr, #152
	wrlong	local05, objptr
	sub	objptr, #152
'   if ((timings[12]>>4)+//yzoom) <>0
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	local02, local04
	shr	local02, #4
	mov	muldiva_, local02
	add	objptr, #216
	rdlong	local06, objptr
	sub	objptr, #216
	mov	muldivb_, local06
	call	#unsdivide_
	mov	local05, muldiva_
	cmp	local05, #0 wz
 if_e	jmp	#LR__0167
'     lines +=1
	add	objptr, #152
	rdlong	local04, objptr
	sub	objptr, #152
	mov	local02, local04
	add	local02, #1
	add	objptr, #152
	wrlong	local02, objptr
	sub	objptr, #152
LR__0167
'   if cpl//xzoom==0  
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldiva_
	cmp	local02, #0 wz
 if_ne	jmp	#LR__0168
'     cpl:=cpl/xzoom
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
'   else
	jmp	#LR__0169
LR__0168
'     cpl:=cpl/xzoom+1
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	local02, #1
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
LR__0169
'   putcharxy:=@putcharxyt
	mov	local02, objptr
	mov	local04, ptr__putcharxyt_
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___make_methodptr
	mov	local05, result1
	add	objptr, #228
	wrlong	local05, objptr
	sub	objptr, #228
'   putcharxyc:=@putcharxyct
	mov	local02, objptr
	mov	local04, ptr__putcharxyct_
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___make_methodptr
	mov	local05, result1
	add	objptr, #236
	wrlong	local05, objptr
	sub	objptr, #236
'   outtextxy:=@outtextxyt
	mov	local02, objptr
	mov	local04, ptr__outtextxyt_
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___make_methodptr
	mov	local05, result1
	add	objptr, #232
	wrlong	local05, objptr
	sub	objptr, #232
'   outtextxyc:=@outtextxyct 
	mov	local02, objptr
	mov	local04, ptr__outtextxyct_
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___make_methodptr
	mov	local05, result1
	add	objptr, #240
	wrlong	local05, objptr
	sub	objptr, #240
'     
'     
' else
	jmp	#LR__0173
LR__0170
'   lines:=timings[12]/yzoom
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	muldiva_, local04
	add	objptr, #216
	rdlong	local05, objptr
	sub	objptr, #216
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #152
	wrlong	local02, objptr
	sub	objptr, #152
'   if (cpl//xzoom)==0  
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldiva_
	cmp	local02, #0 wz
 if_ne	jmp	#LR__0171
'     cpl:=cpl/xzoom
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
'   else
	jmp	#LR__0172
LR__0171
'     cpl:=cpl/xzoom+1
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	local02, #1
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
LR__0172
'   putcharxyc:=@putcharxycg
	mov	local02, objptr
	mov	local04, ptr__putcharxycg_
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___make_methodptr
	mov	local05, result1
	add	objptr, #236
	wrlong	local05, objptr
	sub	objptr, #236
'   outtextxyc:=@outtextxycg 
	mov	local02, objptr
	mov	local04, ptr__outtextxycg_
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___make_methodptr
	mov	local05, result1
	add	objptr, #240
	wrlong	local05, objptr
	sub	objptr, #240
LR__0173
'   
'   
' buflen:=(cpl*lines)
	add	objptr, #148
	rdlong	local05, objptr
	sub	objptr, #148
	mov	local04, local05
	add	objptr, #152
	rdlong	local07, objptr
	sub	objptr, #152
	mov	local06, local07
	qmul	local04, local06
	getqx	local02
	add	objptr, #52
	wrlong	local02, objptr
	sub	objptr, #52
' 
' buf_ptr:=$80000-4*buflen
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local05, local06
	mov	local04, local05
	shl	local04, #2
	mov	local02, ##524288
	sub	local02, local04
	wrlong	local02, objptr
' mode_ptr:=@timings
	add	objptr, #84
	mov	local02, objptr
	sub	objptr, #84
	add	objptr, #20
	wrlong	local02, objptr
	sub	objptr, #20
' graphmode:=mode
	add	objptr, #208
	wrlong	local01, objptr
	sub	objptr, #208
' 'pintoggle(15)
' makedl(mode)
	mov	local02, local01
	mov	arg01, local02
	call	#_makedl
	mov	ptra, fp
	call	#popregs_
_setmode2_ret
	ret

' 
' 
' 
' '---------- Make a display list
' 
' pub makedl (mode) |i, fontline,charline,bufstart,zoom1,vzoom,lpc,hzoom
_makedl
	mov	_var01, arg01
' 
' ''--%aaaa_aaaa_aaaa_aaaa_aazz_nnnn_llll_ll_01 - txt
'   '' aaaa_aaaa_aaaa_aaaa_aazz_rrrr_rrrr_cc_10 - graph
'   '' aaaa_aaaa_aaaa-aaaa_aarr_rrrr_rrrr_rr_11 - extended, next long to read 
'   
' '   0 - display a up/down border line
'     
' '  ' aaaa_aaaa_aaaa_aaaa_aazz_nnnn_llll_ll_01 - text line
' '    aaaa_aaaa_aaaa_aaaa_aa00 - buffer start, has to be aligned, 1 long for char, ff_bb_rr_cc, foreground, background,reserved, charcode
' '    zz - zoom, 00-x1, 01-x2, 10-x4, 11-blank line
' '    nnnn - font line to display, 0..15
' '    llllll - character line, determines the cursor Y position
' 
' 
' if (mode &256==0) 
	mov	_var02, _var01
	and	_var02, #256
	cmp	_var02, #0 wz
 if_ne	jmp	#LR__0174
'   dl_ptr:=buf_ptr-4*576 
	rdlong	_var02, objptr
	sub	_var02, ##2304
	add	objptr, #32
	wrlong	_var02, objptr
	sub	objptr, #32
' else 
	jmp	#LR__0175
LR__0174
'   dl_ptr:=buf_ptr-4*496
	rdlong	_var02, objptr
	sub	_var02, ##1984
	add	objptr, #32
	wrlong	_var02, objptr
	sub	objptr, #32
LR__0175
' 
' vzoom:=((mode>>2) & 3)
	mov	_var02, _var01
	shr	_var02, #2
	and	_var02, #3
	mov	_var03, _var02
'  
' 
' if mode<512 '' text modes
	cmps	_var01, ##512 wcz
 if_ae	jmp	#LR__0192
' 
'   if timings[6]>0 'borders
	add	objptr, #108
	rdlong	_var04, objptr
	sub	objptr, #108
	mov	_var02, _var04
	cmps	_var02, #0 wcz
 if_be	jmp	#LR__0186
'     repeat i from 0 to timings[6]-1 '0 to -1
	mov	_var05, #0
	add	objptr, #108
	rdlong	_var04, objptr
	sub	objptr, #108
	mov	_var02, _var04
	sub	_var02, #1
	mov	_var06, _var02
	cmps	_var06, #0 wcz
 if_be	jmp	#LR__0176
	mov	_var07, #1
	jmp	#LR__0177
LR__0176
	mov	_var07, ##-1
LR__0177
	mov	_var08, _var07
	mov	_var09, _var06
	add	_var09, _var08
	mov	_var06, _var09
LR__0178
'       long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var10, objptr
	sub	objptr, #32
	mov	_var11, _var10
	mov	_var12, _var05
	shl	_var12, #2
	add	_var11, _var12
	mov	_var13, #0
	wrlong	_var13, _var11
LR__0179
	mov	_var11, _var05
	add	_var11, _var08
	mov	_var05, _var11
	cmp	_var05, _var06 wz
 if_ne	jmp	#LR__0178
LR__0180
'     repeat i from timings[6]+timings[12] to timings[15]-1 
	add	objptr, #108
	rdlong	_var04, objptr
	sub	objptr, #108
	mov	_var02, _var04
	add	objptr, #132
	rdlong	_var09, objptr
	sub	objptr, #132
	mov	_var07, _var09
	add	_var02, _var07
	mov	_var05, _var02
	add	objptr, #144
	rdlong	_var10, objptr
	sub	objptr, #144
	mov	_var11, _var10
	sub	_var11, #1
	mov	_var14, _var11
	add	objptr, #108
	rdlong	_var15, objptr
	sub	objptr, #108
	mov	_var13, _var15
	add	objptr, #132
	rdlong	_var16, objptr
	sub	objptr, #132
	mov	_var17, _var16
	add	_var13, _var17
	cmps	_var14, _var13 wcz
 if_be	jmp	#LR__0181
	mov	_var12, #1
	jmp	#LR__0182
LR__0181
	mov	_var12, ##-1
LR__0182
	mov	_var18, _var12
	mov	_var19, _var14
	add	_var19, _var18
	mov	_var14, _var19
LR__0183
'       long[dl_ptr+4*i]:=$0   
	add	objptr, #32
	rdlong	_var20, objptr
	sub	objptr, #32
	mov	_var21, _var20
	mov	_var22, _var05
	shl	_var22, #2
	add	_var21, _var22
	mov	_var23, #0
	wrlong	_var23, _var21
LR__0184
	mov	_var21, _var05
	add	_var21, _var18
	mov	_var05, _var21
	cmp	_var05, _var14 wz
 if_ne	jmp	#LR__0183
LR__0185
LR__0186
'   lpc:=16<<vzoom   
	mov	_var02, #16
	shl	_var02, _var03
	mov	_var24, _var02
'   repeat i from timings[6] to timings[6]+timings[12]-1  
	add	objptr, #108
	rdlong	_var02, objptr
	sub	objptr, #108
	mov	_var05, _var02
	add	objptr, #108
	rdlong	_var07, objptr
	sub	objptr, #108
	mov	_var04, _var07
	add	objptr, #132
	rdlong	_var11, objptr
	sub	objptr, #132
	mov	_var09, _var11
	add	_var04, _var09
	sub	_var04, #1
	mov	_var25, _var04
	add	objptr, #108
	rdlong	_var13, objptr
	sub	objptr, #108
	mov	_var12, _var13
	cmps	_var25, _var12 wcz
 if_be	jmp	#LR__0187
	mov	_var10, #1
	jmp	#LR__0188
LR__0187
	mov	_var10, ##-1
LR__0188
	mov	_var26, _var10
	mov	_var15, _var25
	add	_var15, _var26
	mov	_var25, _var15
LR__0189
'     fontline:=((i-timings[6])+//lpc)>>vzoom
	mov	_var16, _var05
	add	objptr, #108
	rdlong	_var21, objptr
	sub	objptr, #108
	mov	_var19, _var21
	sub	_var16, _var19
	mov	muldiva_, _var16
	mov	muldivb_, _var24
	call	#unsdivide_
	mov	_var17, muldiva_
	shr	_var17, _var03
	mov	_var27, _var17
'     charline:=(i-timings[6])+/lpc
	mov	_var17, _var05
	add	objptr, #108
	rdlong	_var19, objptr
	sub	objptr, #108
	mov	_var16, _var19
	sub	_var17, _var16
	mov	muldiva_, _var17
	mov	muldivb_, _var24
	call	#unsdivide_
	mov	_var21, muldivb_
	mov	_var28, _var21
'     bufstart:=buf_ptr+4*((cpl)*charline)+(mode&3)
	rdlong	_var17, objptr
	add	objptr, #148
	rdlong	_var21, objptr
	sub	objptr, #148
	mov	_var19, _var21
	qmul	_var19, _var28
	getqx	_var16
	mov	_var20, _var16
	shl	_var20, #2
	add	_var17, _var20
	mov	_var22, _var01
	and	_var22, #3
	add	_var17, _var22
	mov	_var29, _var17
'     long[dl_ptr+4*i]:=(bufstart<<12)+(fontline<<8)+(charline<<2)+1
	mov	_var17, _var29
	shl	_var17, #12
	mov	_var16, _var27
	shl	_var16, #8
	add	_var17, _var16
	mov	_var19, _var28
	shl	_var19, #2
	add	_var17, _var19
	add	_var17, #1
	add	objptr, #32
	rdlong	_var20, objptr
	sub	objptr, #32
	mov	_var21, _var20
	mov	_var22, _var05
	shl	_var22, #2
	add	_var21, _var22
	wrlong	_var17, _var21
LR__0190
	mov	_var17, _var05
	add	_var17, _var26
	mov	_var05, _var17
	cmp	_var05, _var25 wz
 if_ne	jmp	#LR__0189
LR__0191
LR__0192
'       
' 
' 
' if (mode>=512)' and (mode & (%10_00_00_0000))==(%10_00_00_0000) ' graphics -> all modes TODO :mode 560+192=752 = 10_11_11_0000 impossib,e because out of memory
	cmps	_var01, ##512 wcz
 if_b	jmp	#LR__0209
' 
'   if timings[6]>0 'borders
	add	objptr, #108
	rdlong	_var04, objptr
	sub	objptr, #108
	mov	_var02, _var04
	cmps	_var02, #0 wcz
 if_be	jmp	#LR__0203
'     repeat i from 0 to timings[6]-1 '0 to -1
	mov	_var05, #0
	add	objptr, #108
	rdlong	_var04, objptr
	sub	objptr, #108
	mov	_var02, _var04
	sub	_var02, #1
	mov	_var30, _var02
	cmps	_var30, #0 wcz
 if_be	jmp	#LR__0193
	mov	_var07, #1
	jmp	#LR__0194
LR__0193
	mov	_var07, ##-1
LR__0194
	mov	_var31, _var07
	mov	_var09, _var30
	add	_var09, _var31
	mov	_var30, _var09
LR__0195
'       long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var10, objptr
	sub	objptr, #32
	mov	_var11, _var10
	mov	_var12, _var05
	shl	_var12, #2
	add	_var11, _var12
	mov	_var13, #0
	wrlong	_var13, _var11
LR__0196
	mov	_var11, _var05
	add	_var11, _var31
	mov	_var05, _var11
	cmp	_var05, _var30 wz
 if_ne	jmp	#LR__0195
LR__0197
'     repeat i from timings[6]+timings[12] to timings[15]-1 
	add	objptr, #108
	rdlong	_var04, objptr
	sub	objptr, #108
	mov	_var02, _var04
	add	objptr, #132
	rdlong	_var09, objptr
	sub	objptr, #132
	mov	_var07, _var09
	add	_var02, _var07
	mov	_var05, _var02
	add	objptr, #144
	rdlong	_var10, objptr
	sub	objptr, #144
	mov	_var11, _var10
	sub	_var11, #1
	mov	_var32, _var11
	add	objptr, #108
	rdlong	_var15, objptr
	sub	objptr, #108
	mov	_var13, _var15
	add	objptr, #132
	rdlong	_var16, objptr
	sub	objptr, #132
	mov	_var17, _var16
	add	_var13, _var17
	cmps	_var32, _var13 wcz
 if_be	jmp	#LR__0198
	mov	_var12, #1
	jmp	#LR__0199
LR__0198
	mov	_var12, ##-1
LR__0199
	mov	_var33, _var12
	mov	_var19, _var32
	add	_var19, _var33
	mov	_var32, _var19
LR__0200
'       long[dl_ptr+4*i]:=$0   
	add	objptr, #32
	rdlong	_var20, objptr
	sub	objptr, #32
	mov	_var21, _var20
	mov	_var22, _var05
	shl	_var22, #2
	add	_var21, _var22
	mov	_var23, #0
	wrlong	_var23, _var21
LR__0201
	mov	_var21, _var05
	add	_var21, _var33
	mov	_var05, _var21
	cmp	_var05, _var32 wz
 if_ne	jmp	#LR__0200
LR__0202
LR__0203
'   repeat i from timings[6] to timings[6]+timings[12]-1  
	add	objptr, #108
	rdlong	_var02, objptr
	sub	objptr, #108
	mov	_var05, _var02
	add	objptr, #108
	rdlong	_var07, objptr
	sub	objptr, #108
	mov	_var04, _var07
	add	objptr, #132
	rdlong	_var11, objptr
	sub	objptr, #132
	mov	_var09, _var11
	add	_var04, _var09
	sub	_var04, #1
	mov	_var34, _var04
	add	objptr, #108
	rdlong	_var13, objptr
	sub	objptr, #108
	mov	_var12, _var13
	cmps	_var34, _var12 wcz
 if_be	jmp	#LR__0204
	mov	_var10, #1
	jmp	#LR__0205
LR__0204
	mov	_var10, ##-1
LR__0205
	mov	_var35, _var10
	mov	_var15, _var34
	add	_var15, _var35
	mov	_var34, _var15
LR__0206
'     bufstart:=buf_ptr+4*(cpl*((i-timings[6])>>vzoom))+(mode&3)
	rdlong	_var17, objptr
	mov	_var16, _var05
	add	objptr, #108
	rdlong	_var21, objptr
	sub	objptr, #108
	mov	_var19, _var21
	sub	_var16, _var19
	shr	_var16, _var03
	add	objptr, #148
	rdlong	_var23, objptr
	sub	objptr, #148
	mov	_var22, _var23
	qmul	_var22, _var16
	getqx	_var20
	mov	_var36, _var20
	shl	_var36, #2
	add	_var17, _var36
	mov	_var37, _var01
	and	_var37, #3
	add	_var17, _var37
	mov	_var29, _var17
'     long[dl_ptr+4*i]:=(bufstart<<12)+2+(mode &48)>>2  
	mov	_var17, _var29
	shl	_var17, #12
	add	_var17, #2
	mov	_var16, _var01
	and	_var16, #48
	shr	_var16, #2
	add	_var17, _var16
	add	objptr, #32
	rdlong	_var21, objptr
	sub	objptr, #32
	mov	_var19, _var21
	mov	_var20, _var05
	shl	_var20, #2
	add	_var19, _var20
	wrlong	_var17, _var19
LR__0207
	mov	_var17, _var05
	add	_var17, _var35
	mov	_var05, _var17
	cmp	_var05, _var34 wz
 if_ne	jmp	#LR__0206
LR__0208
LR__0209
_makedl_ret
	ret

' 
'     
'   
' '--------- Start the driver with graphics mode 'mode' at pins 'base'
' 
' pub start(mode,base):result
_start
	mov	COUNT_, #9
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, #0
' 
' ' initialize pointers and variables
' 
' border_ptr:=@bordercolor
	add	objptr, #48
	mov	local04, objptr
	sub	objptr, #48
	add	objptr, #8
	wrlong	local04, objptr
	sub	objptr, #8
' font_ptr:=@st_font
	add	ptr__dat__, ##4096
	mov	local04, ptr__dat__
	sub	ptr__dat__, ##4096
	add	objptr, #4
	wrlong	local04, objptr
	sub	objptr, #4
' hdmibase:=base
	add	objptr, #40
	wrlong	local02, objptr
	sub	objptr, #40
' 
' ' the mode has to be set here to enable computing the buffer length
' 
' setmode(mode)
	mov	local04, local01
	mov	arg01, local04
	call	#_setmode
' 
' 
' vblank_ptr:=@vblank
	add	objptr, #68
	mov	local04, objptr
	sub	objptr, #68
	add	objptr, #12
	wrlong	local04, objptr
	sub	objptr, #12
' cursor_ptr:=@cursor_x
	add	objptr, #56
	mov	local04, objptr
	sub	objptr, #56
	add	objptr, #16
	wrlong	local04, objptr
	sub	objptr, #16
' 
' palette_ptr:=@ataripalette
	add	ptr__dat__, ##6144
	mov	local04, ptr__dat__
	sub	ptr__dat__, ##6144
	add	objptr, #24
	wrlong	local04, objptr
	sub	objptr, #24
' command_ptr:=@cmd1
	add	objptr, #156
	mov	local04, objptr
	sub	objptr, #156
	add	objptr, #28
	wrlong	local04, objptr
	sub	objptr, #28
' fontnum_ptr:=@fontnum
	add	objptr, #164
	mov	local04, objptr
	sub	objptr, #164
	add	objptr, #36
	wrlong	local04, objptr
	sub	objptr, #36
' 
' fontnum:=0  ' PC type font ' TODO: font# in buffer byte #1
	mov	local04, #0
	add	objptr, #164
	wrlong	local04, objptr
	sub	objptr, #164
' bytemove(@colors,@vgacolors,16)
	add	objptr, #192
	mov	local04, objptr
	sub	objptr, #192
	mov	local05, local04
	add	ptr__dat__, ##7896
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7896
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__bytemove
	mov	local09, result1
' 
' ' initialize a cursor
' 
' cursor_x:=0
	mov	local04, #0
	add	objptr, #56
	wrbyte	local04, objptr
	sub	objptr, #56
' cursor_y:=0
	mov	local04, #0
	add	objptr, #57
	wrbyte	local04, objptr
	sub	objptr, #57
' cursor_sh:=14
	mov	local04, #14
	add	objptr, #58
	wrbyte	local04, objptr
	sub	objptr, #58
' 
' cmd1:=257 ' set command idle
	mov	local04, #257
	add	objptr, #156
	wrlong	local04, objptr
	sub	objptr, #156
' 
' ' start the cog
' 
' cog:=coginit(16,@hdmi, @buf_ptr)
	mov	local04, #16
	add	ptr__dat__, ##7912
	mov	local05, ptr__dat__
	sub	ptr__dat__, ##7912
	mov	local06, local05
	mov	local07, objptr
	mov	local08, local07
	mov	arg01, local04
	mov	arg02, local06
	mov	arg03, local08
	call	#__system___coginit
	mov	local09, result1
	add	objptr, #44
	wrlong	local09, objptr
	sub	objptr, #44
' waitms(20)
	mov	local04, #20
	mov	arg01, local04
	call	#__system___waitms
' 
' ' clear the screen and set the colors to green on black
' 
' cls(c_green,c_black)
	mov	local04, #199
	mov	local05, #0
	mov	arg01, local04
	mov	arg02, local05
	call	#_cls
	mov	local06, result1
' setbordercolor(0,0,128)
	mov	local04, #0
	mov	local05, #0
	mov	local06, #128
	mov	arg01, local04
	mov	arg02, local05
	mov	arg03, local06
	call	#_setbordercolor
' setwritecolors(c_green,c_black)
	mov	local04, #199
	mov	local05, #0
	mov	arg01, local04
	mov	arg02, local05
	call	#_setwritecolors
' 
' return cog
	add	objptr, #44
	rdlong	local04, objptr
	sub	objptr, #44
	mov	result1, local04
	jmp	#LR__0210
LR__0210
	mov	ptra, fp
	call	#popregs_
_start_ret
	ret
hubexit
	jmp	#cogexit

__system___cogid
	cogid	_var01
	mov	result1, _var01
	jmp	#__system___cogid_ret
__system___cogid_ret
	ret

__system___lockclr
	mov	_var01, arg01
	mov	_var02, ##-1
	lockrel	_var01 wc
	muxc	_var03, _var02
	mov	result1, _var03
	jmp	#__system___lockclr_ret
__system___lockclr_ret
	ret

__system___lockset
	mov	_var01, arg01
	mov	_var02, ##-1
	locktry	_var01 wc
	muxnc	_var03, _var02
	mov	result1, _var03
	jmp	#__system___lockset_ret
__system___lockset_ret
	ret

__system___hubset
	mov	_var01, arg01
	hubset	_var01
__system___hubset_ret
	ret

__system___coginit
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	setq	_var03
	coginit	_var01, _var02 wc
 if_b	neg	_var01, #1
	mov	result1, _var01
	jmp	#__system___coginit_ret
__system___coginit_ret
	ret

__system___setbaud
	mov	COUNT_, #6
	call	#pushregs_
	mov	local01, arg01
	rdlong	muldiva_, #20
	mov	muldivb_, local01
	call	#divide_
	mov	local02, muldivb_
	mov	local03, local02
	mov	local02, #62
	mov	arg01, local02
	call	#__system___dirl
	mov	local02, #63
	mov	arg01, local02
	call	#__system___dirl
	wrlong	local03, ptr___system__dat__
	mov	local04, local03
	shl	local04, #16
	mov	local02, #7
	add	local02, local04
	mov	local05, local02
	mov	local02, #62
	mov	local04, #124
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___wrpin
	mov	local02, #62
	mov	local04, local05
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___wxpin
	mov	local02, #63
	mov	local04, #62
	mov	arg01, local02
	mov	arg02, local04
	call	#__system___wrpin
	mov	local02, #63
	mov	local04, local05
	add	local04, #20
	mov	local06, local04
	mov	arg01, local02
	mov	arg02, local06
	call	#__system___wxpin
	mov	local02, #62
	mov	arg01, local02
	call	#__system___dirh
	mov	local02, #63
	mov	arg01, local02
	call	#__system___dirh
	mov	ptra, fp
	call	#popregs_
__system___setbaud_ret
	ret

__system___txraw
	mov	COUNT_, #4
	call	#pushregs_
	mov	local01, arg01
	rdlong	local02, ptr___system__dat__
	cmp	local02, #0 wz
 if_ne	jmp	#LR__0211
	mov	local02, ##230400
	mov	arg01, local02
	call	#__system___setbaud
LR__0211
	mov	local02, #62
	mov	local03, local01
	mov	arg01, local02
	mov	arg02, local03
	call	#__system___wypin
	mov	local02, #1
	mov	arg01, local02
	call	#__system___waitx
LR__0212
	mov	local02, #62
	mov	arg01, local02
	call	#__system___pinr
	mov	local03, result1
	mov	local04, local03
	cmp	local04, #0 wz
 if_e	jmp	#LR__0212
	mov	result1, #1
	jmp	#LR__0213
LR__0213
	mov	ptra, fp
	call	#popregs_
__system___txraw_ret
	ret

__system___dirl
	mov	_var01, arg01
	dirl	_var01
__system___dirl_ret
	ret

__system___dirh
	mov	_var01, arg01
	dirh	_var01
__system___dirh_ret
	ret

__system___drvnot
	mov	_var01, arg01
	drvnot	_var01
__system___drvnot_ret
	ret

__system___pinr
	mov	_var01, arg01
	mov	_var02, #0
	testp	_var01 wc
	wrc	_var02
	mov	result1, _var02
	jmp	#__system___pinr_ret
__system___pinr_ret
	ret

__system___waitx
	mov	_var01, arg01
	waitx	_var01
__system___waitx_ret
	ret

__system___wrpin
	mov	_var01, arg01
	mov	_var02, arg02
	wrpin	_var02, _var01
__system___wrpin_ret
	ret

__system___wxpin
	mov	_var01, arg01
	mov	_var02, arg02
	wxpin	_var02, _var01
__system___wxpin_ret
	ret

__system___wypin
	mov	_var01, arg01
	mov	_var02, arg02
	wypin	_var02, _var01
__system___wypin_ret
	ret

__system__bytefill
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, _var02
	shl	_var04, #8
	or	_var04, _var02
	mov	_var05, _var04
	mov	_var04, _var05
	shl	_var04, #16
	or	_var04, _var05
	mov	_var05, _var04
LR__0214
	cmps	_var03, #3 wcz
 if_be	jmp	#LR__0215
	wrlong	_var05, _var01
	mov	_var04, _var01
	add	_var04, #4
	mov	_var01, _var04
	mov	_var04, _var03
	sub	_var04, #4
	mov	_var03, _var04
	jmp	#LR__0214
LR__0215
	mov	_var06, _var03
LR__0216
	cmp	_var06, #0 wz
 if_e	jmp	#LR__0218
	wrbyte	_var02, _var01
	mov	_var04, _var01
	add	_var04, #1
	mov	_var01, _var04
LR__0217
	mov	_var04, _var06
	sub	_var04, #1
	mov	_var06, _var04
	jmp	#LR__0216
LR__0218
__system__bytefill_ret
	ret

__system__bytemove
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, #0
	mov	_var04, _var01
	cmps	_var01, _var02 wcz
 if_ae	jmp	#LR__0224
LR__0219
	cmps	_var03, #3 wcz
 if_be	jmp	#LR__0220
	rdlong	_var05, _var02
	wrlong	_var05, _var01
	mov	_var05, _var01
	add	_var05, #4
	mov	_var01, _var05
	mov	_var05, _var02
	add	_var05, #4
	mov	_var02, _var05
	mov	_var05, _var03
	sub	_var05, #4
	mov	_var03, _var05
	jmp	#LR__0219
LR__0220
	mov	_var06, _var03
LR__0221
	cmp	_var06, #0 wz
 if_e	jmp	#LR__0223
	rdbyte	_var05, _var02
	wrbyte	_var05, _var01
	mov	_var05, _var01
	add	_var05, #1
	mov	_var01, _var05
	mov	_var05, _var02
	add	_var05, #1
	mov	_var02, _var05
LR__0222
	mov	_var05, _var06
	sub	_var05, #1
	mov	_var06, _var05
	jmp	#LR__0221
LR__0223
	jmp	#LR__0228
LR__0224
	mov	_var05, _var01
	add	_var05, _var03
	mov	_var01, _var05
	mov	_var05, _var02
	add	_var05, _var03
	mov	_var02, _var05
	mov	_var07, _var03
LR__0225
	cmp	_var07, #0 wz
 if_e	jmp	#LR__0227
	mov	_var05, _var01
	sub	_var05, #1
	mov	_var01, _var05
	mov	_var05, _var02
	sub	_var05, #1
	mov	_var02, _var05
	rdbyte	_var05, _var02
	wrbyte	_var05, _var01
LR__0226
	mov	_var05, _var07
	sub	_var05, #1
	mov	_var07, _var05
	jmp	#LR__0225
LR__0227
LR__0228
	mov	result1, _var04
	jmp	#__system__bytemove_ret
__system__bytemove_ret
	ret

__system__longfill
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, _var03
LR__0229
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0231
	wrlong	_var02, _var01
	mov	_var05, _var01
	add	_var05, #4
	mov	_var01, _var05
LR__0230
	mov	_var05, _var04
	sub	_var05, #1
	mov	_var04, _var05
	jmp	#LR__0229
LR__0231
__system__longfill_ret
	ret

__system__longmove
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, #0
	mov	_var04, _var01
	cmps	_var01, _var02 wcz
 if_ae	jmp	#LR__0235
	mov	_var05, _var03
LR__0232
	cmp	_var05, #0 wz
 if_e	jmp	#LR__0234
	rdlong	_var06, _var02
	wrlong	_var06, _var01
	mov	_var06, _var01
	add	_var06, #4
	mov	_var01, _var06
	mov	_var06, _var02
	add	_var06, #4
	mov	_var02, _var06
LR__0233
	mov	_var06, _var05
	sub	_var06, #1
	mov	_var05, _var06
	jmp	#LR__0232
LR__0234
	jmp	#LR__0239
LR__0235
	mov	_var06, _var01
	mov	_var07, _var03
	shl	_var07, #2
	add	_var06, _var07
	mov	_var01, _var06
	mov	_var06, _var02
	mov	_var07, _var03
	shl	_var07, #2
	add	_var06, _var07
	mov	_var02, _var06
	mov	_var08, _var03
LR__0236
	cmp	_var08, #0 wz
 if_e	jmp	#LR__0238
	mov	_var06, _var01
	sub	_var06, #4
	mov	_var01, _var06
	mov	_var06, _var02
	sub	_var06, #4
	mov	_var02, _var06
	rdlong	_var06, _var02
	wrlong	_var06, _var01
LR__0237
	mov	_var06, _var08
	sub	_var06, #1
	mov	_var08, _var06
	jmp	#LR__0236
LR__0238
LR__0239
	mov	result1, _var04
	jmp	#__system__longmove_ret
__system__longmove_ret
	ret

__system____builtin_strlen
	mov	_var01, arg01
	mov	_var02, #0
	mov	_var02, #0
LR__0240
	rdbyte	_var03, _var01
	cmp	_var03, #0 wz
 if_e	jmp	#LR__0241
	mov	_var03, _var02
	mov	_var04, _var02
	add	_var04, #1
	mov	_var02, _var04
	mov	_var03, _var01
	mov	_var04, _var01
	add	_var04, #1
	mov	_var01, _var04
	jmp	#LR__0240
LR__0241
	mov	result1, _var02
	jmp	#__system____builtin_strlen_ret
__system____builtin_strlen_ret
	ret

__system___make_methodptr
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, #8
	mov	arg01, local03
	call	#__system___gc_alloc_managed
	mov	local04, result1
	mov	local05, local04
	cmp	local05, #0 wz
 if_e	jmp	#LR__0242
	wrlong	local01, local05
	mov	local03, local05
	add	local03, #4
	wrlong	local02, local03
LR__0242
	mov	result1, local05
	jmp	#LR__0243
LR__0243
	mov	ptra, fp
	call	#popregs_
__system___make_methodptr_ret
	ret

__system___tx
	mov	COUNT_, #3
	call	#pushregs_
	mov	local01, arg01
	cmp	local01, #10 wz
 if_ne	jmp	#LR__0244
	add	ptr___system__dat__, #8
	rdlong	local02, ptr___system__dat__
	sub	ptr___system__dat__, #8
	mov	local03, local02
	and	local03, #2
	cmp	local03, #0 wz
 if_e	jmp	#LR__0244
	mov	local03, #13
	mov	arg01, local03
	call	#__system___txraw
	mov	local02, result1
LR__0244
	mov	local03, local01
	mov	arg01, local03
	call	#__system___txraw
	mov	local02, result1
	mov	ptra, fp
	call	#popregs_
__system___tx_ret
	ret

__system___lockmem
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
LR__0245
LR__0246
	rdlong	local02, ##-3
	mov	arg01, local02
	call	#__system___lockset
	mov	local03, result1
	mov	local04, local03
	cmp	local04, #0 wz
 if_ne	jmp	#LR__0246
	rdbyte	local05, local01
	cmp	local05, #0 wz
 if_ne	jmp	#LR__0247
	mov	local02, #1
	wrbyte	local02, local01
LR__0247
	rdlong	local02, ##-3
	mov	arg01, local02
	call	#__system___lockclr
	mov	local03, result1
	cmp	local05, #0 wz
 if_ne	jmp	#LR__0245
	mov	ptra, fp
	call	#popregs_
__system___lockmem_ret
	ret

__system___unlockmem
	mov	_var01, arg01
	mov	_var02, #0
	wrbyte	_var02, _var01
__system___unlockmem_ret
	ret

__system___waitms
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	rdlong	local02, #20
LR__0248
	cmps	local01, ##1000 wcz
 if_be	jmp	#LR__0249
	mov	local03, local02
	mov	arg01, local03
	call	#__system___waitx
	mov	local03, local01
	sub	local03, ##1000
	mov	local01, local03
	jmp	#LR__0248
LR__0249
	cmps	local01, #0 wcz
 if_be	jmp	#LR__0250
	mov	muldiva_, local02
	mov	muldivb_, ##1000
	call	#divide_
	mov	local03, muldivb_
	qmul	local01, local03
	getqx	local04
	mov	local05, local04
	mov	arg01, local05
	call	#__system___waitx
LR__0250
	mov	ptra, fp
	call	#popregs_
__system___waitms_ret
	ret

__system___waitus
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	rdlong	local02, #20
LR__0251
	cmps	local01, ##1000000 wcz
 if_be	jmp	#LR__0252
	mov	local03, local02
	mov	arg01, local03
	call	#__system___waitx
	mov	local03, local01
	sub	local03, ##1000000
	mov	local01, local03
	jmp	#LR__0251
LR__0252
	cmps	local01, #0 wcz
 if_be	jmp	#LR__0253
	mov	muldiva_, local02
	mov	muldivb_, ##1000000
	call	#divide_
	mov	local03, muldivb_
	qmul	local01, local03
	getqx	local04
	mov	local05, local04
	mov	arg01, local05
	call	#__system___waitx
LR__0253
	mov	ptra, fp
	call	#popregs_
__system___waitus_ret
	ret

__system___gc_ptrs
	mov	_var01, #0
	mov	_var02, #0
	mov	_var01, #0
	mov	_var01, __heap_ptr
	mov	_var03, _var01
	add	_var03, ##4096
	sub	_var03, #8
	mov	_var02, _var03
	rdlong	_var03, _var01
	cmp	_var03, #0 wz
 if_ne	jmp	#LR__0254
	mov	_var03, _var02
	sub	_var03, _var01
	mov	_var04, _var03
	mov	_var03, _var01
	add	_var03, #0
	mov	_var05, #1
	wrword	_var05, _var03
	mov	_var03, _var01
	add	_var03, #2
	mov	_var05, ##27792
	wrword	_var05, _var03
	mov	_var03, _var01
	add	_var03, #4
	mov	_var05, #0
	wrword	_var05, _var03
	mov	_var03, _var01
	add	_var03, #6
	mov	_var05, #1
	wrword	_var05, _var03
	mov	_var03, _var01
	add	_var03, #16
	mov	_var01, _var03
	abs	_var03, _var04 wc
	shr	_var03, #4
 if_b	neg	_var03, _var03
	mov	_var05, _var01
	add	_var05, #0
	wrword	_var03, _var05
	mov	_var03, _var01
	add	_var03, #2
	mov	_var05, ##27791
	wrword	_var05, _var03
	mov	_var03, _var01
	add	_var03, #4
	mov	_var05, #0
	wrword	_var05, _var03
	mov	_var03, _var01
	add	_var03, #6
	mov	_var05, #0
	wrword	_var05, _var03
	mov	_var03, _var01
	sub	_var03, #16
	mov	_var01, _var03
LR__0254
	mov	_var03, _var01
	mov	result2, _var02
	mov	result1, _var03
	jmp	#__system___gc_ptrs_ret
__system___gc_ptrs_ret
	ret

__system___gc_pageptr
	mov	_var01, arg01
	mov	_var02, arg02
	cmp	_var02, #0 wz
 if_ne	jmp	#LR__0255
	mov	result1, #0
	jmp	#__system___gc_pageptr_ret
LR__0255
	mov	_var03, _var01
	mov	_var04, _var02
	shl	_var04, #4
	add	_var03, _var04
	mov	result1, _var03
	jmp	#__system___gc_pageptr_ret
__system___gc_pageptr_ret
	ret

__system___gc_pageindex
	mov	_var01, arg01
	mov	_var02, arg02
	cmp	_var02, #0 wz
 if_ne	jmp	#LR__0256
	mov	result1, #0
	jmp	#__system___gc_pageindex_ret
LR__0256
	mov	_var03, _var02
	sub	_var03, _var01
	shr	_var03, #4
	mov	result1, _var03
	jmp	#__system___gc_pageindex_ret
__system___gc_pageindex_ret
	ret

__system___gc_isFree
	mov	_var01, arg01
	mov	_var02, #0
	mov	_var03, _var01
	add	_var03, #2
	rdword	_var04, _var03
	cmp	_var04, ##27791 wz
 if_ne	jmp	#LR__0257
	xor	_var02, ##-1
LR__0257
	mov	result1, _var02
	jmp	#__system___gc_isFree_ret
__system___gc_isFree_ret
	ret

__system___gc_nextBlockPtr
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	mov	local02, local01
	add	local02, #0
	rdword	local03, local02
	cmp	local03, #0 wz
 if_ne	jmp	#LR__0258
	mov	local02, ##@LR__0307
	mov	local04, local02
	mov	arg01, local04
	call	#__system___gc_errmsg
	mov	local05, result1
	mov	result1, local05
	jmp	#LR__0259
LR__0258
	mov	local02, local01
	mov	local04, local03
	shl	local04, #4
	add	local02, local04
	mov	result1, local02
	jmp	#LR__0259
LR__0259
	mov	ptra, fp
	call	#popregs_
__system___gc_nextBlockPtr_ret
	ret

__system___gc_tryalloc
	mov	COUNT_, #14
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	call	#__system___gc_ptrs
	mov	local03, result1
	mov	local04, result2
	mov	local05, local03
	mov	local06, local04
	mov	local07, local05
	mov	local08, #0
LR__0260
	mov	local09, local07
	mov	local03, local05
	mov	local04, local07
	add	local04, #6
	rdword	local10, local04
	mov	arg01, local03
	mov	arg02, local10
	call	#__system___gc_pageptr
	mov	local11, result1
	mov	local07, local11
	cmp	local07, #0 wz
 if_e	jmp	#LR__0261
	mov	local03, local07
	add	local03, #0
	rdword	local08, local03
LR__0261
	cmp	local07, #0 wz
 if_e	jmp	#LR__0262
	cmps	local07, local06 wcz
 if_ae	jmp	#LR__0262
	cmps	local01, local08 wcz
 if_a	jmp	#LR__0260
 if_be	jmp	#LR__0262
LR__0262
	cmp	local07, #0 wz
 if_ne	jmp	#LR__0263
	mov	result1, local07
	jmp	#LR__0266
LR__0263
	mov	local03, local07
	add	local03, #6
	rdword	local12, local03
	cmps	local01, local08 wcz
 if_ae	jmp	#LR__0265
	mov	local03, local07
	add	local03, #0
	wrword	local01, local03
	mov	local03, local07
	mov	local04, local01
	shl	local04, #4
	add	local03, local04
	mov	local13, local03
	mov	local03, local08
	sub	local03, local01
	mov	local04, local13
	add	local04, #0
	wrword	local03, local04
	mov	local03, local13
	add	local03, #2
	mov	local04, ##27791
	wrword	local04, local03
	mov	local03, local05
	mov	local04, local07
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_pageindex
	mov	local10, result1
	mov	local11, local13
	add	local11, #4
	wrword	local10, local11
	mov	local03, local07
	add	local03, #6
	mov	local04, local13
	add	local04, #6
	rdword	local10, local03
	wrword	local10, local04
	mov	local14, local13
	mov	local03, local05
	mov	local04, local14
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_pageindex
	mov	local10, result1
	mov	local12, local10
	mov	local03, local13
	mov	arg01, local03
	call	#__system___gc_nextBlockPtr
	mov	local04, result1
	mov	local13, local04
	cmp	local13, #0 wz
 if_e	jmp	#LR__0264
	cmps	local13, local06 wcz
 if_ae	jmp	#LR__0264
	mov	local03, local05
	mov	local04, local14
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_pageindex
	mov	local10, result1
	mov	local11, local13
	add	local11, #4
	wrword	local10, local11
LR__0264
LR__0265
	mov	local03, local09
	add	local03, #6
	wrword	local12, local03
	mov	local03, ##27776
	or	local03, local02
	call	#__system___cogid
	mov	local04, result1
	or	local03, local04
	mov	local10, local07
	add	local10, #2
	wrword	local03, local10
	mov	local03, local05
	add	local03, #8
	mov	local04, local07
	add	local04, #6
	rdword	local10, local03
	wrword	local10, local04
	mov	local03, local05
	mov	local04, local07
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_pageindex
	mov	local10, result1
	mov	local11, local05
	add	local11, #8
	wrword	local10, local11
	mov	local03, local07
	add	local03, #8
	mov	local07, local03
	mov	local03, local07
	or	local03, ##1669332992
	mov	result1, local03
	jmp	#LR__0266
LR__0266
	mov	ptra, fp
	call	#popregs_
__system___gc_tryalloc_ret
	ret

__system___gc_errmsg
	mov	COUNT_, #4
	call	#pushregs_
	mov	local01, arg01
LR__0267
	mov	local02, local01
	mov	local03, local01
	add	local03, #1
	mov	local01, local03
	rdbyte	local04, local02
	cmp	local04, #0 wz
 if_e	jmp	#LR__0268
	mov	local02, local04
	mov	arg01, local02
	call	#__system___tx
	jmp	#LR__0267
LR__0268
	mov	result1, #0
	jmp	#LR__0269
LR__0269
	mov	ptra, fp
	call	#popregs_
__system___gc_errmsg_ret
	ret

__system___gc_alloc_managed
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	mov	local02, #0
	mov	local03, local01
	mov	local04, #0
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_doalloc
	mov	local05, result1
	mov	local02, local05
	cmp	local02, #0 wz
 if_ne	jmp	#LR__0270
	cmps	local01, #0 wcz
 if_be	jmp	#LR__0270
	mov	local03, ##@LR__0308
	mov	local04, local03
	mov	arg01, local04
	call	#__system___gc_errmsg
	mov	local05, result1
	mov	result1, local05
	jmp	#LR__0271
LR__0270
	mov	result1, local02
	jmp	#LR__0271
LR__0271
	mov	ptra, fp
	call	#popregs_
__system___gc_alloc_managed_ret
	ret

__system___gc_doalloc
	mov	COUNT_, #8
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	cmp	local01, #0 wz
 if_ne	jmp	#LR__0272
	mov	result1, #0
	jmp	#LR__0277
LR__0272
	mov	local03, local01
	add	local03, #8
	mov	local01, local03
	mov	local03, local01
	add	local03, #15
	andn	local03, #15
	mov	local01, local03
	mov	local03, local01
	shr	local03, #4
	mov	local01, local03
	add	ptr___system__dat__, #12
	mov	local03, ptr___system__dat__
	sub	ptr___system__dat__, #12
	mov	local04, local03
	mov	arg01, local04
	call	#__system___lockmem
	mov	local03, local01
	mov	local04, local02
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_tryalloc
	mov	local05, result1
	mov	local06, local05
	cmp	local06, #0 wz
 if_ne	jmp	#LR__0273
	call	#__system___gc_docollect
	mov	local03, local01
	mov	local04, local02
	mov	arg01, local03
	mov	arg02, local04
	call	#__system___gc_tryalloc
	mov	local05, result1
	mov	local06, local05
LR__0273
	add	ptr___system__dat__, #12
	mov	local03, ptr___system__dat__
	sub	ptr___system__dat__, #12
	mov	local04, local03
	mov	arg01, local04
	call	#__system___unlockmem
	cmp	local06, #0 wz
 if_e	jmp	#LR__0276
	mov	local03, local01
	shl	local03, #4
	sub	local03, #8
	abs	local04, local03 wc
	shr	local04, #2
 if_b	neg	local04, local04
	mov	local01, local04
	mov	local07, local06
	mov	local08, local01
LR__0274
	cmp	local08, #0 wz
 if_e	jmp	#LR__0275
	mov	local03, #0
	wrlong	local03, local07
	mov	local03, local07
	add	local03, #4
	mov	local07, local03
	mov	local03, local08
	sub	local03, #1
	mov	local08, local03
	jmp	#LR__0274
LR__0275
LR__0276
	mov	result1, local06
	jmp	#LR__0277
LR__0277
	mov	ptra, fp
	call	#popregs_
__system___gc_doalloc_ret
	ret

__system___gc_isvalidptr
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, _var03
	and	_var04, ##-1048576
	cmp	_var04, ##1669332992 wz
 if_e	jmp	#LR__0278
	mov	result1, #0
	jmp	#__system___gc_isvalidptr_ret
LR__0278
	mov	_var04, _var03
	sub	_var04, #8
	andn	_var04, ##-1048576
	mov	_var03, _var04
	cmps	_var03, _var01 wcz
 if_b	jmp	#LR__0279
	cmps	_var03, _var02 wcz
 if_ae	jmp	#LR__0279
 if_b	jmp	#LR__0280
LR__0279
	mov	result1, #0
	jmp	#__system___gc_isvalidptr_ret
LR__0280
	mov	_var04, _var03
	xor	_var04, _var01
	and	_var04, #15
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0281
	mov	result1, #0
	jmp	#__system___gc_isvalidptr_ret
LR__0281
	mov	_var04, _var03
	add	_var04, #2
	rdword	_var05, _var04
	mov	_var04, _var05
	and	_var04, ##65472
	cmp	_var04, ##27776 wz
 if_e	jmp	#LR__0282
	mov	result1, #0
	jmp	#__system___gc_isvalidptr_ret
LR__0282
	mov	result1, _var03
	jmp	#__system___gc_isvalidptr_ret
__system___gc_isvalidptr_ret
	ret

__system___gc_dofree
	mov	COUNT_, #11
	call	#pushregs_
	mov	local01, arg01
	call	#__system___gc_ptrs
	mov	local02, result1
	mov	local03, result2
	mov	local04, local02
	mov	local05, local03
	mov	local02, local01
	add	local02, #2
	mov	local03, ##27791
	wrword	local03, local02
	mov	local06, local01
	mov	local02, local01
	mov	arg01, local02
	call	#__system___gc_nextBlockPtr
	mov	local03, result1
	mov	local07, local03
LR__0283
	mov	local02, local04
	mov	local03, local06
	add	local03, #4
	rdword	local08, local03
	mov	arg01, local02
	mov	arg02, local08
	call	#__system___gc_pageptr
	mov	local09, result1
	mov	local06, local09
	cmp	local06, #0 wz
 if_e	jmp	#LR__0284
	mov	local02, local06
	mov	arg01, local02
	call	#__system___gc_isFree
	mov	local03, result1
	cmp	local03, #0 wz
 if_ne	jmp	#LR__0284
 if_e	jmp	#LR__0283
LR__0284
	cmp	local06, #0 wz
 if_ne	jmp	#LR__0285
	mov	local06, local04
LR__0285
	mov	local02, local06
	add	local02, #6
	mov	local03, local01
	add	local03, #6
	rdword	local08, local02
	wrword	local08, local03
	mov	local02, local04
	mov	local03, local01
	mov	arg01, local02
	mov	arg02, local03
	call	#__system___gc_pageindex
	mov	local08, result1
	mov	local09, local06
	add	local09, #6
	wrword	local08, local09
	cmp	local06, local04 wz
 if_e	jmp	#LR__0288
	mov	local02, local06
	mov	arg01, local02
	call	#__system___gc_nextBlockPtr
	mov	local03, result1
	mov	local10, local03
	cmp	local10, local01 wz
 if_ne	jmp	#LR__0287
	mov	local03, local06
	add	local03, #0
	mov	local08, local01
	add	local08, #0
	rdword	local02, local03
	rdword	local09, local08
	add	local02, local09
	mov	local11, local06
	add	local11, #0
	wrword	local02, local11
	mov	local02, local01
	add	local02, #2
	mov	local03, #0
	wrword	local03, local02
	mov	local02, local01
	mov	arg01, local02
	call	#__system___gc_nextBlockPtr
	mov	local03, result1
	mov	local07, local03
	cmps	local07, local05 wcz
 if_ae	jmp	#LR__0286
	mov	local02, local04
	mov	local03, local06
	mov	arg01, local02
	mov	arg02, local03
	call	#__system___gc_pageindex
	mov	local08, result1
	mov	local09, local07
	add	local09, #4
	wrword	local08, local09
LR__0286
	mov	local02, local01
	add	local02, #6
	mov	local03, local06
	add	local03, #6
	rdword	local08, local02
	wrword	local08, local03
	mov	local02, local01
	add	local02, #6
	mov	local03, #0
	wrword	local03, local02
	mov	local01, local06
LR__0287
LR__0288
	mov	local02, local01
	mov	arg01, local02
	call	#__system___gc_nextBlockPtr
	mov	local03, result1
	mov	local10, local03
	cmp	local10, #0 wz
 if_e	jmp	#LR__0290
	cmps	local10, local05 wcz
 if_ae	jmp	#LR__0290
	mov	local02, local10
	mov	arg01, local02
	call	#__system___gc_isFree
	mov	local03, result1
	cmp	local03, #0 wz
 if_e	jmp	#LR__0290
	mov	local06, local01
	mov	local01, local10
	mov	local03, local06
	add	local03, #0
	mov	local08, local01
	add	local08, #0
	rdword	local02, local03
	rdword	local09, local08
	add	local02, local09
	mov	local11, local06
	add	local11, #0
	wrword	local02, local11
	mov	local02, local01
	add	local02, #6
	mov	local03, local06
	add	local03, #6
	rdword	local08, local02
	wrword	local08, local03
	mov	local02, local01
	add	local02, #2
	mov	local03, #170
	wrword	local03, local02
	mov	local02, local01
	add	local02, #6
	mov	local03, #0
	wrword	local03, local02
	mov	local02, local01
	mov	arg01, local02
	call	#__system___gc_nextBlockPtr
	mov	local03, result1
	mov	local07, local03
	cmp	local07, #0 wz
 if_e	jmp	#LR__0289
	cmps	local07, local05 wcz
 if_ae	jmp	#LR__0289
	mov	local02, local04
	mov	local03, local06
	mov	arg01, local02
	mov	arg02, local03
	call	#__system___gc_pageindex
	mov	local08, result1
	mov	local09, local07
	add	local09, #4
	wrword	local08, local09
LR__0289
LR__0290
	mov	result1, local07
	jmp	#LR__0291
LR__0291
	mov	ptra, fp
	call	#popregs_
__system___gc_dofree_ret
	ret

__system____topofstack
	mov	COUNT_, #0
	call	#pushregs_
	add	ptra, #8
	add	fp, #4
	wrlong	arg01, fp
	sub	fp, #4
	add	fp, #4
	mov	_tmp001_, fp
	sub	fp, #4
	mov	result1, _tmp001_
	jmp	#LR__0292
LR__0292
	mov	ptra, fp
	call	#popregs_
__system____topofstack_ret
	ret

__system___gc_docollect
	mov	COUNT_, #9
	call	#pushregs_
	call	#__system___gc_ptrs
	mov	local01, result1
	mov	local02, result2
	mov	local03, local01
	mov	local04, local02
	mov	local01, local03
	mov	arg01, local01
	call	#__system___gc_nextBlockPtr
	mov	local02, result1
	mov	local05, local02
	call	#__system___cogid
	mov	local01, result1
	mov	local06, local01
LR__0293
	cmp	local05, #0 wz
 if_e	jmp	#LR__0294
	cmps	local05, local04 wcz
 if_ae	jmp	#LR__0294
	mov	local02, local05
	add	local02, #2
	rdword	local01, local02
	andn	local01, #32
	mov	local07, local05
	add	local07, #2
	wrword	local01, local07
	mov	local01, local05
	mov	arg01, local01
	call	#__system___gc_nextBlockPtr
	mov	local02, result1
	mov	local05, local02
	jmp	#LR__0293
LR__0294
	mov	local01, #0
	mov	local02, #0
	mov	arg01, local02
	call	#__system____topofstack
	mov	local07, result1
	mov	arg01, local01
	mov	arg02, local07
	call	#__system___gc_markhub
	call	#__system___gc_markcog
	mov	local01, local03
	mov	arg01, local01
	call	#__system___gc_nextBlockPtr
	mov	local02, result1
	mov	local08, local02
	cmp	local08, #0 wz
 if_ne	jmp	#LR__0295
	mov	local01, ##@LR__0309
	mov	local02, local01
	mov	arg01, local02
	call	#__system___gc_errmsg
	mov	local07, result1
	jmp	#LR__0301
LR__0295
LR__0296
	mov	local05, local08
	mov	local01, local05
	mov	arg01, local01
	call	#__system___gc_nextBlockPtr
	mov	local02, result1
	mov	local08, local02
	mov	local01, local05
	add	local01, #2
	rdword	local09, local01
	mov	local01, local09
	and	local01, #32
	cmp	local01, #0 wz
 if_ne	jmp	#LR__0299
	mov	local02, local09
	and	local02, #16
	cmp	local02, #0 wz
 if_ne	jmp	#LR__0299
	mov	local01, local09
	and	local01, #15
	mov	local09, local01
	cmp	local09, local06 wz
 if_e	jmp	#LR__0297
	cmp	local09, #14 wz
 if_e	jmp	#LR__0297
 if_ne	jmp	#LR__0298
LR__0297
	mov	local01, local05
	mov	arg01, local01
	call	#__system___gc_dofree
	mov	local02, result1
	mov	local08, local02
LR__0298
LR__0299
	cmp	local08, #0 wz
 if_e	jmp	#LR__0300
	cmps	local08, local04 wcz
 if_b	jmp	#LR__0296
 if_ae	jmp	#LR__0300
LR__0300
LR__0301
	mov	ptra, fp
	call	#popregs_
__system___gc_docollect_ret
	ret

__system___gc_markhub
	mov	COUNT_, #10
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	call	#__system___gc_ptrs
	mov	local03, result1
	mov	local04, result2
	mov	local05, local03
	mov	local06, local04
LR__0302
	cmps	local01, local02 wcz
 if_ae	jmp	#LR__0304
	rdlong	local07, local01
	mov	local03, local01
	add	local03, #4
	mov	local01, local03
	mov	local03, local05
	mov	local04, local06
	mov	local08, local07
	mov	arg01, local03
	mov	arg02, local04
	mov	arg03, local08
	call	#__system___gc_isvalidptr
	mov	local09, result1
	mov	local07, local09
	cmp	local07, #0 wz
 if_e	jmp	#LR__0303
	mov	local03, local07
	mov	arg01, local03
	call	#__system___gc_isFree
	mov	local04, result1
	cmp	local04, #0 wz
 if_ne	jmp	#LR__0303
	mov	local03, local07
	add	local03, #2
	rdword	local10, local03
	mov	local03, local10
	andn	local03, #15
	mov	local10, local03
	mov	local03, local10
	or	local03, #46
	mov	local10, local03
	mov	local03, local07
	add	local03, #2
	wrword	local10, local03
LR__0303
	jmp	#LR__0302
LR__0304
	mov	ptra, fp
	call	#popregs_
__system___gc_markhub_ret
	ret

__system___gc_markcog
	mov	COUNT_, #8
	call	#pushregs_
	call	#__system___gc_ptrs
	mov	local01, result1
	mov	local02, result2
	mov	local03, local01
	mov	local04, local02
	mov	local05, #0
LR__0305
	mov	local02, #496
	sub	local02, local05
	mov	local01, #496
	add	local01, local02
	'.live	local06
	'.live	local01
	alts	local01, #0
	mov	local06, local01
	mov	local01, local03
	mov	local02, local04
	mov	local07, local06
	mov	arg01, local01
	mov	arg02, local02
	mov	arg03, local07
	call	#__system___gc_isvalidptr
	mov	local08, result1
	mov	local06, local08
	cmp	local06, #0 wz
 if_e	jmp	#LR__0306
	mov	local02, local06
	add	local02, #2
	rdword	local01, local02
	or	local01, #32
	mov	local07, local06
	add	local07, #2
	wrword	local01, local07
LR__0306
	mov	local01, local05
	mov	local02, local05
	add	local02, #1
	mov	local05, local02
	cmps	local05, #496 wcz
 if_b	jmp	#LR__0305
	mov	ptra, fp
	call	#popregs_
__system___gc_markcog_ret
	ret

LR__0307
	byte	" !!! corrupted heap??? !!! "
	byte	0
LR__0308
	byte	" !!! out of heap memory !!! "
	byte	0
LR__0309
	byte	" !!! corrupted heap !!! "
	byte	0
LR__0310
	byte	"mode"
	byte	0
LR__0311
	byte	" "
	byte	0
	alignl
_dat_
'-' vga_font       file "vgafont.def"
	byte	$00[19]
	byte	$7e, $81, $a5, $81, $81, $bd, $99, $81, $81, $7e, $00, $00, $00, $00, $00, $00
	byte	$7e, $ff, $db, $ff, $ff, $c3, $e7, $ff, $ff, $7e, $00, $00, $00, $00, $00, $00
	byte	$00, $36, $7f, $7f, $7f, $7f, $3e, $1c, $08, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $08, $1c, $3e, $7f, $3e, $1c, $08, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$18, $3c, $3c, $e7, $e7, $e7, $18, $18, $3c, $00, $00, $00, $00, $00, $00, $00
	byte	$18, $3c, $7e, $ff, $ff, $7e, $18, $18, $3c, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $18, $3c, $3c, $18, $00, $00, $00, $00, $00, $00, $ff, $ff, $ff
	byte	$ff, $ff, $ff, $e7, $c3, $c3, $e7, $ff, $ff, $ff, $ff, $ff, $ff, $00, $00, $00
	byte	$00, $00, $3c, $66, $42, $42, $66, $3c, $00, $00, $00, $00, $00, $ff, $ff, $ff
	byte	$ff, $ff, $c3, $99, $bd, $bd, $99, $c3, $ff, $ff, $ff, $ff, $ff, $00, $00, $00
	byte	$78, $70, $58, $4c, $1e, $33, $33, $33, $33, $1e, $00, $00, $00, $00, $00, $00
	byte	$3c, $66, $66, $66, $66, $3c, $18, $7e, $18, $18, $00, $00, $00, $00, $00, $00
	byte	$fc, $cc, $fc, $0c, $0c, $0c, $0c, $0e, $0f, $07, $00, $00, $00, $00, $00, $00
	byte	$fe, $c6, $fe, $c6, $c6, $c6, $c6, $e6, $e7, $67, $03, $00, $00, $00, $00, $00
	byte	$18, $18, $db, $3c, $e7, $3c, $db, $18, $18, $00, $00, $00, $00, $00, $00, $01
	byte	$03, $07, $0f, $1f, $7f, $1f, $0f, $07, $03, $01, $00, $00, $00, $00, $00, $40
	byte	$60, $70, $78, $7c, $7f, $7c, $78, $70, $60, $40, $00, $00, $00, $00, $00, $00
	byte	$18, $3c, $7e, $18, $18, $18, $7e, $3c, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$66[7]
	byte	$00, $66, $66, $00, $00, $00, $00, $00, $00, $fe, $db, $db, $db, $de, $d8, $d8
	byte	$d8, $d8, $d8, $00, $00, $00, $00, $3e, $63, $06, $1c, $36, $63, $63, $36, $1c
	byte	$30, $63, $3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7f
	byte	$7f, $7f, $7f, $00, $00, $00, $00, $00, $00, $18, $3c, $7e, $18, $18, $18, $7e
	byte	$3c, $18, $7e, $00, $00, $00, $00, $00, $00, $18, $3c, $7e, $18, $18, $18, $18
	byte	$18, $18, $18, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$7e, $3c, $18, $00, $00, $00, $00, $00, $00, $00, $00, $18, $30, $7f, $30, $18
	byte	$00[11]
	byte	$0c, $06, $7f, $06, $0c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $03, $03, $03, $7f, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$14, $36, $7f, $36, $14, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $08
	byte	$1c, $1c, $3e, $3e, $7f, $7f, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7f
	byte	$7f, $3e, $3e, $1c, $1c, $08, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[14]
	byte	$18, $3c, $3c, $3c, $18, $18, $18, $00, $18, $18, $00, $00, $00, $00, $66, $66
	byte	$66, $24, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $36, $36, $7f, $36, $36, $36, $7f, $36, $36, $00, $00, $00, $00, $18, $18
	byte	$3e, $63, $43, $03, $3e, $60, $60, $61, $63, $3e, $18, $18, $00, $00, $00, $00
	byte	$00, $00, $43, $63, $30, $18, $0c, $06, $63, $61, $00, $00, $00, $00, $00, $00
	byte	$1c, $36, $36, $1c, $6e, $3b, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00
	byte	$0c, $0c, $0c, $06, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$30, $18, $0c, $0c, $0c, $0c, $0c, $0c, $18, $30, $00, $00, $00, $00, $00, $00
	byte	$0c, $18, $30, $30, $30, $30, $30, $30, $18, $0c, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $66, $3c, $ff, $3c, $66, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $18, $18, $7e, $18, $18, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[8]
	byte	$18, $18, $18, $0c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7f, $00, $00
	byte	$00[16]
	byte	$18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $40, $60, $30, $18, $0c, $06
	byte	$03, $01, $00, $00, $00, $00, $00, $00, $1c, $36, $63, $63, $6b, $6b, $63, $63
	byte	$36, $1c, $00, $00, $00, $00, $00, $00, $18, $1c, $1e, $18, $18, $18, $18, $18
	byte	$18, $7e, $00, $00, $00, $00, $00, $00, $3e, $63, $60, $30, $18, $0c, $06, $03
	byte	$63, $7f, $00, $00, $00, $00, $00, $00, $3e, $63, $60, $60, $3c, $60, $60, $60
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $30, $38, $3c, $36, $33, $7f, $30, $30
	byte	$30, $78, $00, $00, $00, $00, $00, $00, $7f, $03, $03, $03, $3f, $60, $60, $60
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $1c, $06, $03, $03, $3f, $63, $63, $63
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $7f, $63, $60, $60, $30, $18, $0c, $0c
	byte	$0c, $0c, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $3e, $63, $63, $63
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $7e, $60, $60, $60
	byte	$30, $1e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $00, $00, $00
	byte	$18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $00, $00, $00
	byte	$18, $18, $0c, $00, $00, $00, $00, $00, $00, $60, $30, $18, $0c, $06, $0c, $18
	byte	$30, $60, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7e, $00, $00, $7e, $00
	byte	$00[9]
	byte	$06, $0c, $18, $30, $60, $30, $18, $0c, $06, $00, $00, $00, $00, $00, $00, $3e
	byte	$63, $63, $30, $18, $18, $18, $00, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $63, $63, $7b, $7b, $7b, $3b, $03, $3e, $00, $00, $00, $00, $00, $00, $08
	byte	$1c, $36, $63, $63, $7f, $63, $63, $63, $63, $00, $00, $00, $00, $00, $00, $3f
	byte	$66, $66, $66, $3e, $66, $66, $66, $66, $3f, $00, $00, $00, $00, $00, $00, $3c
	byte	$66, $43, $03, $03, $03, $03, $43, $66, $3c, $00, $00, $00, $00, $00, $00, $1f
	byte	$36, $66, $66, $66, $66, $66, $66, $36, $1f, $00, $00, $00, $00, $00, $00, $7f
	byte	$66, $46, $16, $1e, $16, $06, $46, $66, $7f, $00, $00, $00, $00, $00, $00, $7f
	byte	$66, $46, $16, $1e, $16, $06, $06, $06, $0f, $00, $00, $00, $00, $00, $00, $3c
	byte	$66, $43, $03, $03, $7b, $63, $63, $66, $5c, $00, $00, $00, $00, $00, $00, $63
	byte	$63, $63, $63, $7f, $63, $63, $63, $63, $63, $00, $00, $00, $00, $00, $00, $3c
	byte	$18[8]
	byte	$3c, $00, $00, $00, $00, $00, $00, $78, $30, $30, $30, $30, $30, $33, $33, $33
	byte	$1e, $00, $00, $00, $00, $00, $00, $67, $66, $66, $36, $1e, $1e, $36, $66, $66
	byte	$67, $00, $00, $00, $00, $00, $00, $0f, $06, $06, $06, $06, $06, $06, $46, $66
	byte	$7f, $00, $00, $00, $00, $00, $00, $63, $77, $7f, $7f, $6b, $63, $63, $63, $63
	byte	$63, $00, $00, $00, $00, $00, $00, $63, $67, $6f, $7f, $7b, $73, $63, $63, $63
	byte	$63, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $3f, $66, $66, $66, $3e, $06, $06, $06, $06
	byte	$0f, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $63, $63, $63, $6b, $7b
	byte	$3e, $30, $70, $00, $00, $00, $00, $3f, $66, $66, $66, $3e, $36, $66, $66, $66
	byte	$67, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $06, $1c, $30, $60, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $7e, $7e, $5a, $18, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $63, $63, $36, $1c
	byte	$08, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $6b, $6b, $6b, $7f, $77
	byte	$36, $00, $00, $00, $00, $00, $00, $63, $63, $36, $3e, $1c, $1c, $3e, $36, $63
	byte	$63, $00, $00, $00, $00, $00, $00, $66, $66, $66, $66, $3c, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $00, $7f, $63, $61, $30, $18, $0c, $06, $43, $63
	byte	$7f, $00, $00, $00, $00, $00, $00, $3c, $0c, $0c, $0c, $0c, $0c, $0c, $0c, $0c
	byte	$3c, $00, $00, $00, $00, $00, $00, $00, $01, $03, $07, $0e, $1c, $38, $70, $60
	byte	$40, $00, $00, $00, $00, $00, $00, $3c, $30, $30, $30, $30, $30, $30, $30, $30
	byte	$3c, $00, $00, $00, $1c, $36, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[17]
	byte	$ff, $00, $00, $0c, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[9]
	byte	$1e, $30, $3e, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00, $07, $06, $06
	byte	$1e, $36, $66, $66, $66, $66, $3e, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $63, $03, $03, $03, $63, $3e, $00, $00, $00, $00, $00, $00, $38, $30, $30
	byte	$3c, $36, $33, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $63, $7f, $03, $03, $63, $3e, $00, $00, $00, $00, $00, $00, $38, $6c, $4c
	byte	$0c, $1e, $0c, $0c, $0c, $0c, $1e, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$6e, $33, $33, $33, $33, $33, $3e, $30, $33, $1e, $00, $00, $00, $07, $06, $06
	byte	$36, $6e, $66, $66, $66, $66, $67, $00, $00, $00, $00, $00, $00, $18, $18, $00
	byte	$1c, $18, $18, $18, $18, $18, $3c, $00, $00, $00, $00, $00, $00, $60, $60, $00
	byte	$70, $60, $60, $60, $60, $60, $60, $66, $66, $3c, $00, $00, $00, $07, $06, $06
	byte	$66, $36, $1e, $1e, $36, $66, $67, $00, $00, $00, $00, $00, $00, $1c, $18, $18
	byte	$18[6]
	byte	$3c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $37, $7f, $6b, $6b, $6b, $6b
	byte	$63, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3b, $66, $66, $66, $66, $66
	byte	$66, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3b, $66, $66, $66, $66, $66
	byte	$3e, $06, $06, $0f, $00, $00, $00, $00, $00, $00, $6e, $33, $33, $33, $33, $33
	byte	$3e, $30, $30, $78, $00, $00, $00, $00, $00, $00, $3b, $6e, $66, $06, $06, $06
	byte	$0f, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3e, $63, $06, $1c, $30, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $08, $0c, $0c, $3f, $0c, $0c, $0c, $0c, $6c
	byte	$38, $00, $00, $00, $00, $00, $00, $00, $00, $00, $33, $33, $33, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $36
	byte	$1c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $63, $6b, $6b, $6b, $7f
	byte	$36, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $36, $1c, $1c, $1c, $36
	byte	$63, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $63
	byte	$7e, $60, $30, $1f, $00, $00, $00, $00, $00, $00, $7f, $33, $18, $0c, $06, $63
	byte	$7f, $00, $00, $00, $00, $00, $00, $70, $18, $18, $18, $0e, $18, $18, $18, $18
	byte	$70, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $00, $00, $00, $00, $00, $00, $0e, $18, $18, $18, $70, $18, $18, $18, $18
	byte	$0e, $00, $00, $00, $6e, $3b, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[10]
	byte	$08, $1c, $36, $63, $63, $63, $7f, $00, $00, $00, $00, $00, $00, $3c, $66, $43
	byte	$03, $03, $03, $03, $43, $66, $3c, $18, $30, $1e, $00, $00, $00, $00, $33, $00
	byte	$33[6]
	byte	$6e, $00, $00, $00, $00, $00, $60, $30, $18, $00, $3e, $63, $7f, $03, $03, $63
	byte	$3e, $00, $00, $00, $00, $00, $08, $1c, $36, $00, $1e, $30, $3e, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $00, $00, $33, $00, $1e, $30, $3e, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $1c, $36, $1c, $00, $33, $33, $33, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $60, $30, $18, $00, $3e, $63, $03, $03, $03, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3e, $63, $03, $03, $03, $63
	byte	$3e, $18, $30, $1e, $00, $00, $00, $1c, $58, $78, $38, $18, $1c, $1e, $1a, $18
	byte	$3c, $00, $00, $00, $00, $00, $00, $00, $63, $00, $3e, $63, $7f, $03, $03, $63
	byte	$3e, $00, $00, $00, $66, $33, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $cc, $66, $33, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $18, $3c, $66, $00, $1c, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $30, $18, $00, $7f, $63, $61, $30, $18, $0c, $06, $43, $63
	byte	$7f, $00, $00, $00, $00, $63, $00, $08, $1c, $36, $63, $63, $7f, $63, $63, $63
	byte	$63, $00, $00, $00, $30, $18, $00, $3c, $66, $43, $03, $03, $03, $03, $43, $66
	byte	$3c, $00, $00, $00, $30, $18, $00, $7f, $66, $46, $16, $1e, $16, $06, $46, $66
	byte	$7f, $00, $00, $00, $0c, $06, $00, $0f, $06, $06, $06, $06, $06, $06, $46, $66
	byte	$7f, $00, $00, $00, $30, $18, $00, $1c, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $08, $1c, $36, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $00, $63, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $6f, $46, $26, $06, $06, $06, $06, $46, $66
	byte	$7f, $00, $00, $00, $00, $00, $00, $6e, $4c, $2c, $0c, $0c, $0c, $0c, $0c, $0c
	byte	$1e, $00, $00, $00, $30, $18, $00, $3e, $63, $63, $06, $1c, $30, $60, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $60, $30, $18, $00, $3e, $63, $06, $1c, $30, $63
	byte	$3e, $00, $00, $00, $00, $63, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $63, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $6c, $38, $00, $7e, $7e, $5a, $18, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $60, $48, $2c, $0c, $3f, $0c, $0c, $0c, $0c, $6c
	byte	$38, $00, $00, $00, $00, $00, $00, $0f, $26, $36, $1e, $0e, $07, $07, $46, $66
	byte	$7f, $00, $00, $00, $00, $00, $00, $00, $00, $63, $36, $1c, $1c, $36, $63, $00
	byte	$00[6]
	byte	$36, $1c, $08, $00, $3e, $63, $03, $03, $03, $63, $3e, $00, $00, $00, $00, $00
	byte	$30, $18, $0c, $00, $1e, $30, $3e, $33, $33, $33, $6e, $00, $00, $00, $00, $00
	byte	$60, $30, $18, $00, $1c, $18, $18, $18, $18, $18, $3c, $00, $00, $00, $00, $00
	byte	$60, $30, $18, $00, $3e, $63, $63, $63, $63, $63, $3e, $00, $00, $00, $00, $00
	byte	$30, $18, $0c, $00, $33, $33, $33, $33, $33, $33, $6e, $00, $00, $00, $00, $00
	byte	$00, $08, $1c, $36, $63, $63, $7f, $63, $63, $63, $63, $18, $0c, $78, $00, $00
	byte	$00, $00, $00, $00, $1e, $30, $3e, $33, $33, $33, $6e, $18, $0c, $78, $36, $1c
	byte	$00, $7f, $63, $61, $30, $18, $0c, $06, $43, $63, $7f, $00, $00, $00, $00, $00
	byte	$36, $1c, $08, $00, $7f, $33, $18, $0c, $06, $63, $7f, $00, $00, $00, $00, $00
	byte	$00, $7f, $66, $46, $16, $1e, $16, $06, $46, $66, $7f, $18, $0c, $78, $00, $00
	byte	$00, $00, $00, $00, $3e, $63, $7f, $03, $03, $63, $3e, $18, $0c, $78, $00, $00
	byte	$00, $3c, $66, $03, $1f, $03, $0f, $03, $03, $66, $3c, $00, $00, $00, $00, $00
	byte	$60, $30, $18, $00, $7f, $33, $18, $0c, $06, $63, $7f, $00, $00, $00, $6c, $38
	byte	$00, $3c, $66, $43, $03, $03, $03, $03, $43, $66, $3c, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $3e, $63, $06, $1c, $30, $63, $3e, $18, $30, $1e, $00, $00
	byte	$00[6]
	byte	$6c, $36, $1b, $36, $6c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$1b, $36, $6c, $36, $1b, $00, $00, $00, $88, $22, $88, $22, $88, $22, $88, $22
	byte	$88, $22, $88, $22, $88, $22, $88, $22, $aa, $55, $aa, $55, $aa, $55, $aa, $55
	byte	$aa, $55, $aa, $55, $aa, $55, $aa, $55, $bb, $ee, $bb, $ee, $bb, $ee, $bb, $ee
	byte	$bb, $ee, $bb, $ee, $bb, $ee, $bb, $ee, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18[15]
	byte	$1f, $18, $18, $18, $18, $18, $18, $18, $18, $30, $18, $00, $08, $1c, $36, $63
	byte	$63, $7f, $63, $63, $63, $63, $00, $00, $00, $1c, $36, $00, $08, $1c, $36, $63
	byte	$63, $7f, $63, $63, $63, $63, $00, $00, $00, $36, $1c, $00, $7f, $66, $46, $16
	byte	$1e, $16, $06, $46, $66, $7f, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $06
	byte	$1c, $30, $60, $63, $63, $3e, $18, $30, $1e, $6c, $6c, $6c, $6c, $6c, $6f, $60
	byte	$6f, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$6c[9]
	byte	$00[5]
	byte	$7f, $60, $6f, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$6f, $60, $7f, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $00, $7f, $63
	byte	$61, $30, $18, $0c, $06, $43, $63, $7f, $00, $00, $00, $00, $00, $00, $18, $18
	byte	$00, $7f, $33, $18, $0c, $06, $63, $7f, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $1f, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $f8, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18
	byte	$18, $18, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $ff, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $f8, $18, $18, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00
	byte	$00, $00, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18
	byte	$18, $18, $ff, $18, $18, $18, $18, $18, $18, $18, $18, $63, $3e, $00, $08, $1c
	byte	$36, $63, $63, $7f, $63, $63, $63, $63, $00, $00, $00, $00, $00, $00, $63, $3e
	byte	$00, $1e, $30, $3e, $33, $33, $33, $6e, $00, $00, $00, $6c, $6c, $6c, $6c, $6c
	byte	$ec, $0c, $fc, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$fc, $0c, $ec, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$ef, $00, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$ff, $00, $ef, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$ec, $0c, $ec, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $00, $00, $00, $00, $00
	byte	$ff, $00, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $6c, $6c, $6c, $6c, $6c
	byte	$ef, $00, $ef, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $00, $00, $00, $00, $00
	byte	$63, $3e, $63, $63, $63, $63, $3e, $63, $00, $00, $00, $00, $00, $00, $30, $7e
	byte	$30, $3c, $36, $33, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00, $1f, $36
	byte	$66, $66, $6f, $66, $66, $66, $36, $1f, $00, $00, $00, $36, $1c, $00, $1f, $36
	byte	$66[6]
	byte	$36, $1f, $00, $00, $00, $00, $63, $00, $7f, $66, $46, $16, $1e, $16, $06, $46
	byte	$66, $7f, $00, $00, $00, $6c, $38, $00, $38, $30, $30, $3c, $36, $33, $33, $33
	byte	$33, $6e, $00, $00, $00, $36, $1c, $00, $63, $67, $6f, $7f, $7b, $73, $63, $63
	byte	$63, $63, $00, $00, $00, $30, $18, $00, $3c, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $3c, $00, $00, $00, $3c, $66, $00, $3c, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $3c, $00, $00, $00, $00, $00, $36, $1c, $08, $00, $3e, $63, $7f, $03, $03
	byte	$63, $3e, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18, $1f, $00, $00, $00
	byte	$00[12]
	byte	$f8, $18, $18, $18, $18, $18, $18, $18, $18, $ff, $ff, $ff, $ff, $ff, $ff, $ff
	byte	$ff[9]
	byte	$00[7]
	byte	$ff[9]
	byte	$00, $00, $00, $7e, $7e, $5a, $18, $18, $18, $18, $18, $18, $3c, $18, $30, $1e
	byte	$1c, $36, $1c, $63, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$ff[7]
	byte	$00[9]
	byte	$30, $18, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $00, $1e, $33, $33, $33, $1b, $33, $63, $63, $63, $33, $00, $00, $00
	byte	$1c, $36, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$30, $18, $00, $63, $67, $6f, $7f, $7b, $73, $63, $63, $63, $63, $00, $00, $00
	byte	$00, $00, $60, $30, $18, $00, $3b, $66, $66, $66, $66, $66, $66, $00, $00, $00
	byte	$00, $00, $36, $1c, $08, $00, $3b, $66, $66, $66, $66, $66, $66, $00, $00, $00
	byte	$36, $1c, $00, $3e, $63, $63, $06, $1c, $30, $60, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $36, $1c, $08, $00, $3e, $63, $06, $1c, $30, $63, $3e, $00, $00, $00
	byte	$30, $18, $00, $3f, $66, $66, $66, $3e, $36, $66, $66, $66, $6f, $00, $00, $00
	byte	$30, $18, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $60, $30, $18, $00, $3b, $6e, $66, $06, $06, $06, $0f, $00, $00, $00
	byte	$66, $33, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $60, $30, $18, $00, $63, $63, $63, $63, $63, $63, $7e, $60, $30, $1f
	byte	$30, $18, $00, $66, $66, $66, $66, $3c, $18, $18, $18, $18, $3c, $00, $00, $00
	byte	$00, $00, $00, $08, $0c, $0c, $3f, $0c, $0c, $0c, $0c, $6c, $38, $18, $30, $1e
	byte	$30, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[8]
	byte	$7f, $00, $00, $00, $00, $00, $00, $00, $66, $33, $00, $00, $00, $00, $00, $00
	byte	$00[21]
	byte	$0c, $06, $3c, $36, $1c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $63, $3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $3e, $63, $06, $1c, $36, $63, $63, $36, $1c, $30, $63, $3e
	byte	$00[8]
	byte	$18, $00, $7e, $00, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[8]
	byte	$18, $30, $1e, $00, $00, $00, $1c, $36, $36, $1c, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $63, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[5]
	byte	$cc, $66, $33, $00, $33, $33, $33, $33, $33, $33, $6e, $00, $00, $00, $36, $1c
	byte	$00, $3f, $66, $66, $66, $3e, $36, $66, $66, $66, $6f, $00, $00, $00, $00, $00
	byte	$36, $1c, $08, $00, $3b, $6e, $66, $06, $06, $06, $0f, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $7e, $7e, $7e, $7e, $7e, $7e, $7e, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
'-' st_font        file "st4font.def"
	byte	$00[55]
	byte	$ff, $ff, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$18[9]
	byte	$00[7]
	byte	$ff, $ff, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$ff, $ff, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$1f, $1f, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$f8, $f8, $18, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$1f, $1f, $18, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$f8, $f8, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$1f, $1f, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$f8, $f8, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$ff, $ff, $18, $18, $18, $18, $18, $18, $18, $00, $00, $18, $3c, $7e, $66, $66
	byte	$66, $7e, $7e, $66, $66, $66, $66, $30, $18, $00, $00, $7e, $7e, $06, $06, $3e
	byte	$3e, $06, $06, $06, $06, $7e, $7e, $18, $0c, $30, $18, $3c, $7e, $66, $66, $06
	byte	$06, $06, $06, $66, $66, $7e, $3c, $00, $00, $30, $18, $66, $66, $66, $6e, $6e
	byte	$7e, $7e, $76, $76, $66, $66, $66, $00, $00, $30, $18, $7c, $7e, $06, $06, $0e
	byte	$1c, $38, $70, $60, $60, $7e, $3e, $00, $00, $30, $18, $7e, $7e, $30, $30, $18
	byte	$18, $0c, $0c, $06, $06, $7e, $7e, $00, $00, $18, $18, $00, $7e, $7e, $30, $30
	byte	$18, $18, $0c, $0c, $06, $7e, $7e, $00, $00, $30, $18, $3c, $7e, $66, $66, $66
	byte	$66[5]
	byte	$7e, $3c, $00, $00, $00, $00, $06, $06, $06, $06, $16, $1e, $0e, $06, $06, $06
	byte	$7e, $7e, $00, $00, $00, $00, $00, $00, $00, $3c, $7c, $60, $7c, $7e, $66, $66
	byte	$7e, $7c, $30, $18, $00, $00, $00, $00, $00, $3c, $7e, $66, $66, $7e, $06, $06
	byte	$7e, $7c, $18, $0c, $00, $00, $30, $18, $00, $3c, $3e, $06, $06, $06, $06, $06
	byte	$7e, $7c, $00, $00, $00, $00, $30, $18, $00, $3e, $7e, $66, $66, $66, $66, $66
	byte	$66, $66, $00, $00, $00, $00, $30, $18, $00, $7c, $7e, $06, $0e, $3c, $70, $60
	byte	$7e, $3e, $00, $00, $00, $00, $30, $18, $00, $7e, $7e, $30, $18, $18, $0c, $0c
	byte	$7e, $7e, $00, $00, $00, $00, $18, $18, $00, $7e, $7e, $30, $18, $18, $0c, $0c
	byte	$7e, $7e, $00, $00, $00, $00, $30, $18, $00, $3c, $7e, $66, $66, $66, $66, $66
	byte	$7e, $3c, $00, $00, $00, $00, $1c, $1c, $18, $18, $38, $3c, $1c, $18, $18, $18
	byte	$3c, $3c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[6]
	byte	$18[8]
	byte	$00, $00, $18, $18, $00, $00, $00, $00, $66, $66, $66, $66, $00, $00, $00, $00
	byte	$00[9]
	byte	$66, $66, $ff, $ff, $66, $66, $ff, $ff, $66, $66, $00, $00, $00, $00, $18, $18
	byte	$7c, $7e, $06, $06, $3e, $7c, $60, $60, $7e, $3e, $18, $18, $00, $00, $00, $66
	byte	$66, $30, $30, $18, $18, $0c, $0c, $66, $66, $00, $00, $00, $00, $00, $3c, $7e
	byte	$66, $66, $3c, $1c, $1c, $fc, $fe, $66, $66, $fe, $fc, $00, $00, $00, $00, $18
	byte	$18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $30
	byte	$18, $1c, $0c, $0c, $0c, $0c, $0c, $0c, $1c, $18, $30, $00, $00, $00, $00, $0c
	byte	$18, $38, $30, $30, $30, $30, $30, $30, $38, $18, $0c, $00, $00, $00, $00, $00
	byte	$66, $66, $3c, $3c, $ff, $ff, $3c, $3c, $66, $66, $00, $00, $00, $00, $00, $00
	byte	$00, $18, $18, $18, $7e, $7e, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$00[6]
	byte	$18[5]
	byte	$0c, $04, $00, $00, $00, $00, $00, $00, $7e, $7e, $00, $00, $00, $00, $00, $00
	byte	$00[13]
	byte	$18, $18, $18, $00, $00, $00, $00, $60, $60, $60, $30, $30, $18, $18, $0c, $0c
	byte	$06, $06, $06, $00, $00, $00, $00, $3c, $7e, $66, $66, $66, $76, $6e, $66, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $18, $18, $1c, $1c, $18, $18, $18, $18, $18
	byte	$18, $7e, $7e, $00, $00, $00, $00, $3c, $7e, $66, $66, $30, $30, $18, $18, $0c
	byte	$0c, $7e, $7e, $00, $00, $00, $00, $7e, $7e, $30, $30, $18, $18, $30, $30, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $30, $30, $38, $38, $3c, $3c, $36, $36, $7e
	byte	$7e, $30, $30, $00, $00, $00, $00, $7e, $7e, $06, $06, $3e, $7e, $60, $60, $60
	byte	$66, $7e, $3c, $00, $00, $00, $00, $38, $3c, $0e, $06, $06, $3e, $7e, $66, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $7e, $7e, $60, $60, $30, $30, $18, $18, $0c
	byte	$0c, $0c, $0c, $00, $00, $00, $00, $3c, $7e, $66, $66, $3c, $3c, $66, $66, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $3c, $7e, $66, $66, $7e, $7c, $60, $60, $60
	byte	$70, $3c, $1c, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $00, $00, $00
	byte	$18, $18, $18, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $00, $00, $18
	byte	$18, $18, $18, $0c, $04, $00, $00, $00, $70, $38, $1c, $0e, $07, $0e, $1c, $38
	byte	$70, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7e, $7e, $00, $00, $7e, $7e
	byte	$00[8]
	byte	$0e, $1c, $38, $70, $e0, $70, $38, $1c, $0e, $00, $00, $00, $00, $00, $00, $3c
	byte	$7e, $66, $66, $30, $30, $18, $18, $18, $00, $18, $18, $00, $00, $00, $00, $3c
	byte	$7e, $66, $66, $66, $66, $36, $06, $66, $66, $7e, $3c, $00, $00, $00, $00, $18
	byte	$3c, $7e, $66, $66, $66, $7e, $7e, $66, $66, $66, $66, $00, $00, $00, $00, $3e
	byte	$7e, $66, $66, $7e, $3e, $66, $66, $66, $66, $7e, $3e, $00, $00, $00, $00, $3c
	byte	$7e, $66, $66, $06, $06, $06, $06, $66, $66, $7e, $3c, $00, $00, $00, $00, $3e
	byte	$7e, $66, $66, $66, $66, $66, $66, $66, $66, $7e, $3e, $00, $00, $00, $00, $7e
	byte	$7e, $06, $06, $3e, $3e, $06, $06, $06, $06, $7e, $7e, $00, $00, $00, $00, $7e
	byte	$7e, $06, $06, $3e, $3e, $06, $06, $06, $06, $06, $06, $00, $00, $00, $00, $7c
	byte	$7e, $06, $06, $76, $76, $66, $66, $66, $66, $7e, $3c, $00, $00, $00, $00, $66
	byte	$66, $66, $66, $7e, $7e, $66, $66, $66, $66, $66, $66, $00, $00, $00, $00, $7e
	byte	$7e, $18, $18, $18, $18, $18, $18, $18, $18, $7e, $7e, $00, $00, $00, $00, $60
	byte	$60[7]
	byte	$66, $66, $7e, $3c, $00, $00, $00, $00, $66, $66, $36, $36, $1e, $1e, $36, $36
	byte	$66, $66, $c6, $c6, $00, $00, $00, $00, $06, $06, $06, $06, $06, $06, $06, $06
	byte	$06, $06, $7e, $7e, $00, $00, $00, $00, $c6, $c6, $ee, $ee, $fe, $d6, $d6, $c6
	byte	$c6, $c6, $c6, $c6, $00, $00, $00, $00, $66, $66, $66, $6e, $6e, $7e, $7e, $76
	byte	$76, $66, $66, $66, $00, $00, $00, $00, $3c, $7e, $66, $66, $66, $66, $66, $66
	byte	$66, $66, $7e, $3c, $00, $00, $00, $00, $3e, $7e, $66, $66, $66, $66, $7e, $3e
	byte	$06, $06, $06, $06, $00, $00, $00, $00, $3c, $7e, $66, $66, $66, $66, $66, $66
	byte	$66, $56, $3e, $6c, $00, $00, $00, $00, $3e, $7e, $66, $66, $66, $7e, $3e, $36
	byte	$66, $66, $c6, $c6, $00, $00, $00, $00, $7c, $7e, $06, $06, $0e, $1c, $38, $70
	byte	$60, $60, $7e, $3e, $00, $00, $00, $00, $7e, $7e, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $18, $18, $00, $00, $00, $00, $66, $66, $66, $66, $66, $66, $66, $66
	byte	$66, $66, $7e, $3c, $00, $00, $00, $00, $66, $66, $66, $66, $66, $66, $66, $66
	byte	$3c, $3c, $18, $18, $00, $00, $00, $00, $c6, $c6, $c6, $c6, $c6, $d6, $d6, $fe
	byte	$fe, $ee, $c6, $82, $00, $00, $00, $00, $66, $66, $66, $3c, $3c, $18, $18, $3c
	byte	$3c, $66, $66, $66, $00, $00, $00, $00, $66, $66, $66, $66, $66, $3c, $3c, $18
	byte	$18, $18, $18, $18, $00, $00, $00, $00, $7e, $7e, $30, $30, $18, $18, $0c, $0c
	byte	$06, $06, $7e, $7e, $00, $00, $00, $00, $3c, $3c, $0c, $0c, $0c, $0c, $0c, $0c
	byte	$0c, $0c, $3c, $3c, $00, $00, $00, $00, $06, $06, $0c, $0c, $18, $18, $30, $30
	byte	$60, $60, $c0, $c0, $00, $00, $00, $00, $3c, $3c, $30, $30, $30, $30, $30, $30
	byte	$30, $30, $3c, $3c, $00, $00, $00, $00, $18, $18, $3c, $3c, $66, $66, $00, $00
	byte	$00[18]
	byte	$fe, $fe, $00, $00, $00, $00, $0c, $0c, $18, $18, $00, $00, $00, $00, $00, $00
	byte	$00[9]
	byte	$3c, $7c, $60, $7c, $7e, $66, $66, $7e, $7c, $00, $00, $00, $00, $06, $06, $06
	byte	$3e, $7e, $66, $66, $66, $66, $66, $7e, $3e, $00, $00, $00, $00, $00, $00, $00
	byte	$3c, $3e, $06, $06, $06, $06, $06, $7e, $7c, $00, $00, $00, $00, $60, $60, $60
	byte	$7c, $7e, $66, $66, $66, $66, $66, $7e, $7c, $00, $00, $00, $00, $00, $00, $00
	byte	$3c, $7e, $66, $66, $7e, $06, $06, $7e, $7c, $00, $00, $00, $00, $70, $78, $18
	byte	$18, $7e, $7e, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$7c, $7e, $66, $66, $66, $66, $7e, $7c, $60, $7e, $3e, $00, $00, $06, $06, $06
	byte	$3e, $7e, $66, $66, $66, $66, $66, $66, $66, $00, $00, $00, $00, $18, $18, $00
	byte	$1c, $1c, $18, $18, $18, $18, $18, $3c, $3c, $00, $00, $00, $00, $30, $30, $00
	byte	$30[9]
	byte	$3e, $1e, $00, $00, $06, $06, $06, $36, $36, $1e, $1e, $1e, $36, $36, $66, $66
	byte	$00, $00, $00, $00, $1c, $1c, $18, $18, $18, $18, $18, $18, $18, $18, $3c, $3c
	byte	$00[7]
	byte	$6c, $fe, $fe, $d6, $d6, $c6, $c6, $c6, $c6, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $7e, $66, $66, $66, $66, $66, $66, $66, $00, $00, $00, $00, $00, $00, $00
	byte	$3c, $7e, $66, $66, $66, $66, $66, $7e, $3c, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $7e, $66, $66, $66, $66, $66, $7e, $3e, $06, $06, $00, $00, $00, $00, $00
	byte	$7c, $7e, $66, $66, $66, $66, $66, $7e, $7c, $60, $60, $00, $00, $00, $00, $00
	byte	$3e, $7e, $66, $06, $06, $06, $06, $06, $06, $00, $00, $00, $00, $00, $00, $00
	byte	$7c, $7e, $06, $0e, $3c, $70, $60, $7e, $3e, $00, $00, $00, $00, $00, $18, $18
	byte	$7e, $7e, $18, $18, $18, $18, $18, $78, $70, $00, $00, $00, $00, $00, $00, $00
	byte	$66[7]
	byte	$7e, $7c, $00, $00, $00, $00, $00, $00, $00, $66, $66, $66, $66, $66, $3c, $3c
	byte	$18, $18, $00, $00, $00, $00, $00, $00, $00, $c6, $c6, $d6, $d6, $fe, $fe, $ee
	byte	$c6, $82, $00, $00, $00, $00, $00, $00, $00, $66, $66, $3c, $3c, $18, $3c, $3c
	byte	$66, $66, $00, $00, $00, $00, $00, $00, $00, $66, $66, $66, $66, $66, $66, $7e
	byte	$7c, $60, $7e, $3e, $00, $00, $00, $00, $00, $7e, $7e, $30, $18, $18, $0c, $0c
	byte	$7e, $7e, $00, $00, $00, $00, $30, $18, $18, $18, $18, $0c, $0c, $18, $18, $18
	byte	$18, $30, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $00, $00, $00, $00, $0c, $18, $18, $18, $18, $30, $30, $18, $18, $18
	byte	$18, $0c, $00, $00, $00, $00, $6c, $7e, $36, $00, $00, $00, $00, $00, $00, $00
	byte	$00[9]
	byte	$18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00
'-' ataripalette   file "ataripalettep2.def"
	byte	$00[5]
	byte	$11, $11, $11, $00, $22, $22, $22, $00, $33, $33, $33, $00, $44, $44, $44, $00
	byte	$55, $55, $55, $00, $66, $66, $66, $00, $77, $77, $77, $00, $88, $88, $88, $00
	byte	$99, $99, $99, $00, $aa, $aa, $aa, $00, $bb, $bb, $bb, $00, $cc, $cc, $cc, $00
	byte	$dd, $dd, $dd, $00, $ee, $ee, $ee, $00, $ff, $ff, $ff, $00, $00, $0a, $20, $00
	byte	$00, $14, $40, $00, $00, $1e, $60, $00, $00, $28, $80, $00, $00, $32, $9f, $00
	byte	$00, $3c, $bf, $00, $00, $46, $df, $00, $00, $50, $ff, $00, $1c, $63, $ff, $00
	byte	$39, $77, $ff, $00, $55, $8a, $ff, $00, $71, $9e, $ff, $00, $8e, $b1, $ff, $00
	byte	$aa, $c5, $ff, $00, $c6, $d8, $ff, $00, $e3, $ec, $ff, $00, $00, $00, $20, $00
	byte	$00, $00, $40, $00, $00, $00, $60, $00, $00, $00, $80, $00, $00, $00, $9f, $00
	byte	$00, $00, $bf, $00, $00, $00, $df, $00, $00, $00, $ff, $00, $1c, $1c, $ff, $00
	byte	$39, $39, $ff, $00, $55, $55, $ff, $00, $71, $71, $ff, $00, $8e, $8e, $ff, $00
	byte	$aa, $aa, $ff, $00, $c6, $c6, $ff, $00, $e3, $e3, $ff, $00, $10, $00, $20, $00
	byte	$20, $00, $40, $00, $30, $00, $60, $00, $40, $00, $80, $00, $50, $00, $9f, $00
	byte	$60, $00, $bf, $00, $70, $00, $df, $00, $80, $00, $ff, $00, $8e, $1c, $ff, $00
	byte	$9c, $39, $ff, $00, $aa, $55, $ff, $00, $b8, $71, $ff, $00, $c7, $8e, $ff, $00
	byte	$d5, $aa, $ff, $00, $e3, $c6, $ff, $00, $f1, $e3, $ff, $00, $20, $00, $20, $00
	byte	$40, $00, $40, $00, $60, $00, $60, $00, $80, $00, $80, $00, $9f, $00, $9f, $00
	byte	$bf, $00, $bf, $00, $df, $00, $df, $00, $ff, $00, $ff, $00, $ff, $1c, $ff, $00
	byte	$ff, $39, $ff, $00, $ff, $55, $ff, $00, $ff, $71, $ff, $00, $ff, $8e, $ff, $00
	byte	$ff, $aa, $ff, $00, $ff, $c6, $ff, $00, $ff, $e3, $ff, $00, $20, $00, $10, $00
	byte	$40, $00, $20, $00, $60, $00, $30, $00, $80, $00, $40, $00, $9f, $00, $50, $00
	byte	$bf, $00, $60, $00, $df, $00, $70, $00, $ff, $00, $80, $00, $ff, $1c, $8e, $00
	byte	$ff, $39, $9c, $00, $ff, $55, $aa, $00, $ff, $71, $b8, $00, $ff, $8e, $c7, $00
	byte	$ff, $aa, $d5, $00, $ff, $c6, $e3, $00, $ff, $e3, $f1, $00, $20, $00, $00, $00
	byte	$40, $00, $00, $00, $60, $00, $00, $00, $80, $00, $00, $00, $9f, $00, $00, $00
	byte	$bf, $00, $00, $00, $df, $00, $00, $00, $ff, $00, $00, $00, $ff, $1c, $1c, $00
	byte	$ff, $39, $39, $00, $ff, $55, $55, $00, $ff, $71, $71, $00, $ff, $8e, $8e, $00
	byte	$ff, $aa, $aa, $00, $ff, $c6, $c6, $00, $ff, $e3, $e3, $00, $20, $08, $00, $00
	byte	$40, $10, $00, $00, $60, $18, $00, $00, $80, $20, $00, $00, $9f, $28, $00, $00
	byte	$bf, $30, $00, $00, $df, $38, $00, $00, $ff, $40, $00, $00, $ff, $55, $1c, $00
	byte	$ff, $6a, $39, $00, $ff, $80, $55, $00, $ff, $95, $71, $00, $ff, $aa, $8e, $00
	byte	$ff, $bf, $aa, $00, $ff, $d5, $c6, $00, $ff, $ea, $e3, $00, $20, $10, $00, $00
	byte	$40, $20, $00, $00, $60, $30, $00, $00, $80, $40, $00, $00, $9f, $50, $00, $00
	byte	$bf, $60, $00, $00, $df, $70, $00, $00, $ff, $80, $00, $00, $ff, $8e, $1c, $00
	byte	$ff, $9c, $39, $00, $ff, $aa, $55, $00, $ff, $b8, $71, $00, $ff, $c7, $8e, $00
	byte	$ff, $d5, $aa, $00, $ff, $e3, $c6, $00, $ff, $f1, $e3, $00, $20, $18, $00, $00
	byte	$40, $30, $00, $00, $60, $48, $00, $00, $80, $60, $00, $00, $9f, $78, $00, $00
	byte	$bf, $90, $00, $00, $df, $a8, $00, $00, $ff, $c0, $00, $00, $ff, $c7, $1c, $00
	byte	$ff, $ce, $39, $00, $ff, $d5, $55, $00, $ff, $dc, $71, $00, $ff, $e3, $8e, $00
	byte	$ff, $ea, $aa, $00, $ff, $f1, $c6, $00, $ff, $f8, $e3, $00, $18, $20, $00, $00
	byte	$30, $40, $00, $00, $48, $60, $00, $00, $60, $80, $00, $00, $78, $9f, $00, $00
	byte	$90, $bf, $00, $00, $a8, $df, $00, $00, $c0, $ff, $00, $00, $c7, $ff, $1c, $00
	byte	$ce, $ff, $39, $00, $d5, $ff, $55, $00, $dc, $ff, $71, $00, $e3, $ff, $8e, $00
	byte	$ea, $ff, $aa, $00, $f1, $ff, $c6, $00, $f8, $ff, $e3, $00, $00, $20, $00, $00
	byte	$00, $40, $00, $00, $00, $60, $00, $00, $00, $80, $00, $00, $00, $9f, $00, $00
	byte	$00, $bf, $00, $00, $00, $df, $00, $00, $00, $ff, $00, $00, $1c, $ff, $1c, $00
	byte	$39, $ff, $39, $00, $55, $ff, $55, $00, $71, $ff, $71, $00, $8e, $ff, $8e, $00
	byte	$aa, $ff, $aa, $00, $c6, $ff, $c6, $00, $e3, $ff, $e3, $00, $00, $20, $0a, $00
	byte	$00, $40, $14, $00, $00, $60, $1e, $00, $00, $80, $28, $00, $00, $9f, $32, $00
	byte	$00, $bf, $3c, $00, $00, $df, $46, $00, $00, $ff, $50, $00, $1c, $ff, $63, $00
	byte	$39, $ff, $77, $00, $55, $ff, $8a, $00, $71, $ff, $9e, $00, $8e, $ff, $b1, $00
	byte	$aa, $ff, $c5, $00, $c6, $ff, $d8, $00, $e3, $ff, $ec, $00, $00, $20, $14, $00
	byte	$00, $40, $28, $00, $00, $60, $3c, $00, $00, $80, $50, $00, $00, $9f, $64, $00
	byte	$00, $bf, $78, $00, $00, $df, $8c, $00, $00, $ff, $a0, $00, $1c, $ff, $ab, $00
	byte	$39, $ff, $b5, $00, $55, $ff, $c0, $00, $71, $ff, $ca, $00, $8e, $ff, $d5, $00
	byte	$aa, $ff, $df, $00, $c6, $ff, $ea, $00, $e3, $ff, $f4, $00, $00, $20, $20, $00
	byte	$00, $40, $40, $00, $00, $60, $60, $00, $00, $80, $80, $00, $00, $9f, $9f, $00
	byte	$00, $bf, $bf, $00, $00, $df, $df, $00, $00, $ff, $ff, $00, $1c, $ff, $ff, $00
	byte	$39, $ff, $ff, $00, $55, $ff, $ff, $00, $71, $ff, $ff, $00, $8e, $ff, $ff, $00
	byte	$aa, $ff, $ff, $00, $c6, $ff, $ff, $00, $e3, $ff, $ff, $00, $00, $14, $20, $00
	byte	$00, $28, $40, $00, $00, $3c, $60, $00, $00, $50, $80, $00, $00, $64, $9f, $00
	byte	$00, $78, $bf, $00, $00, $8c, $df, $00, $00, $a0, $ff, $00, $1c, $ab, $ff, $00
	byte	$39, $b5, $ff, $00, $55, $c0, $ff, $00, $71, $ca, $ff, $00, $8e, $d5, $ff, $00
	byte	$aa, $df, $ff, $00, $c6, $ea, $ff, $00, $e3, $f4, $ff
'-' vga16		   long  $00000000,$00008000,$00800000,$00808000,$80000000,$80008000,$80400000,$AAAAAA00,$55555500,$0000FF00,$00FF0000,$00FFFF00,$FF000000,$FF00FF00,$FFFF0000,$FFFFFF00
	byte	$00[5]
	byte	$80, $00, $00, $00, $00, $80, $00, $00, $80, $80, $00, $00, $00, $00, $80, $00
	byte	$80, $00, $80, $00, $00, $40, $80, $00, $aa, $aa, $aa, $00, $55, $55, $55, $00
	byte	$ff, $00, $00, $00, $00, $ff, $00, $00, $ff, $ff, $00, $00, $00, $00, $ff, $00
	byte	$ff, $00, $ff, $00, $00, $ff, $ff, $00, $ff, $ff, $ff
'-' fourcolors     long  $00000000,$80808000,$FF000000,$FFFFFF00 'black,red,gray,white
	byte	$00, $00, $00, $00, $00, $80, $80, $80, $00, $00, $00, $ff, $00, $ff, $ff, $ff
'-' twocolors      long  $00000000,$FFFFFF00
	byte	$00, $00, $00, $00, $00, $ff, $ff, $ff
'-' '**********************************************************************************
'-' '
'-' '        Timings and colors definitions
'-' '
'-' '**********************************************************************************
'-' 
'-'    'streamer sets for text mode, to add to timings[0..5]
'-' 
'-' 
'-' '                     bf.hs, hs,  bf.vis  visible, lr bord, pixel, ud bord,  up p., vsync, down p., mode, cpl, scanlines,  clock,                  hubset                  total vis lines
'-' timings000      long   16,   80,    20,    1024,    112,     8,     48,      16,      16,    16,      0,  100,   480,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$70, $00, $00, $00, $08, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $00, $00, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' timings064      long   18,   48,    16,     944,     24,     8,     24,      24,      32,    24,     64,  112,   496,     319215686,   %1_110010__11_0010_1101__1111_1011,   544
	byte	$12, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00, $b0, $03, $00, $00
	byte	$18, $00, $00, $00, $08, $00, $00, $00, $18, $00, $00, $00, $18, $00, $00, $00
	byte	$20, $00, $00, $00, $18, $00, $00, $00, $40, $00, $00, $00, $70, $00, $00, $00
	byte	$f0, $01, $00, $00, $46, $d8, $06, $13, $fb, $2d, $cb, $01, $20, $02, $00, $00
'-' timings128      long   16,   64,    16,     816,      8,     8,     8,       32,      64,    32,    128,  100,   480,     283750000,   %1_111111__11_1000_1011__1111_1011,   496
	byte	$10, $00, $00, $00, $40, $00, $00, $00, $10, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $20, $00, $00, $00
	byte	$40, $00, $00, $00, $20, $00, $00, $00, $80, $00, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $70, $ae, $e9, $10, $fb, $8b, $ff, $01, $f0, $01, $00, $00
'-' timings192      long   16,   80,    20,    1024,      0,     8,     0,       16,      16,    16,    192,  128,   576,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$00, $00, $00, $00, $08, $00, $00, $00, $00, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $c0, $00, $00, $00, $80, $00, $00, $00
	byte	$40, $02, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' timings256      long   80,  160,    84,     816,      8,     8,     8,        8,      12,     8,    256,  100,   480,     357959184,   %1_110000__11_0110_0100__1111_1011,   496
	byte	$50, $00, $00, $00, $a0, $00, $00, $00, $54, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $00, $01, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $10, $06, $56, $15, $fb, $64, $c3, $01, $f0, $01, $00, $00
'-' timings320      long   80,   50,    80,     816,      8,     8,     8,        8,      12,     8,    320,  100,   480,     322162162,   %1_100100__10_0101_0011__1111_1011,   496
	byte	$50, $00, $00, $00, $32, $00, $00, $00, $50, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $40, $01, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f2, $cd, $33, $13, $fb, $53, $92, $01, $f0, $01, $00, $00
'-' timings384      long   24,   48,    24,     816,      8,     8,     8,        8,      12,     8,    384,  100,   480,     286363636,   %1_010101__01_0011_1010__1111_1011,   496
	byte	$18, $00, $00, $00, $30, $00, $00, $00, $18, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $80, $01, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f4, $8f, $11, $11, $fb, $3a, $55, $01, $f0, $01, $00, $00
'-' timings448      long   32,   64,    34,     896,      0,     8,     0,        8,      12,     8,    448,  112,   496,     322162162,   %1_100100__10_0101_0011__1111_1011,   496
	byte	$20, $00, $00, $00, $40, $00, $00, $00, $22, $00, $00, $00, $80, $03, $00, $00
	byte	$00, $00, $00, $00, $08, $00, $00, $00, $00, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $c0, $01, $00, $00, $70, $00, $00, $00
	byte	$f0, $01, $00, $00, $f2, $cd, $33, $13, $fb, $53, $92, $01, $f0, $01, $00, $00
'-' 
'-' timings512      long   16,   80,    20,    1024,    112,     8,     48,      16,      16,    16,    544,  100,   480,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$70, $00, $00, $00, $08, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $20, $02, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' timings560      long   16,   80,    20,    1024,    112,     4,     48,      16,      16,    16,    544,  200,   480,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$70, $00, $00, $00, $04, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $20, $02, $00, $00, $c8, $00, $00, $00
	byte	$e0, $01, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' 
'-' 
'-' vgacolors       byte   0, 117, 199, 151, 39, 71, 246, 10, 5, 121, 203, 155, 43, 75, 234, 15
	byte	$00, $75, $c7, $97, $27, $47, $f6, $0a, $05, $79, $cb, $9b, $2b, $4b, $ea, $0f
'-' 
'-' hdmi            setq    #10
	byte	$28, $14, $64, $fd
'-'                 rdlong  framebuf,  ptra                 'read pointers
	byte	$00, $d9, $06, $fb
'-' 
'-'                 setq2   #255
	byte	$29, $fe, $65, $fd
'-'                 rdlong  $000, paletteptr                'read palette
	byte	$72, $01, $00, $fb
'-'                 add     paletteptr,##1024                ' Atari type 256 colors  
	byte	$02, $00, $00, $ff, $00, $e4, $06, $f1
'-'                 setq2   #15
	byte	$29, $1e, $64, $fd
'-'                 rdlong  480,paletteptr                  ' 16 color palette at 480
	byte	$72, $c1, $03, $fb
'-'                 add     paletteptr,##64                 ' 
	byte	$00, $00, $00, $ff, $40, $e4, $06, $f1
'-'                 setq2   #3
	byte	$29, $06, $64, $fd
'-'                 rdlong  448,paletteptr                  ' 4  color palette at 448
	byte	$72, $81, $03, $fb
'-'                 add     paletteptr,##16                
	byte	$00, $00, $00, $ff, $10, $e4, $06, $f1
'-'                 setq2   #1
	byte	$29, $02, $64, $fd
'-'                 rdlong  416,paletteptr                  ' 2 color palette at 416
	byte	$72, $41, $03, $fb
'-'                 
'-' 
'-'                 wrlong  #aend,#0                         'write driver length to hub#0: DEBUG/demo
	byte	$00, $14, $6f, $fc
'-'                 setcmod #$100                           'enable HDMI mode
	byte	$3c, $00, $66, $fd
'-'                 mov     ii,#7
	byte	$07, $f4, $06, $f6
'-'                 shl     ii,#6
	byte	$06, $f4, $66, $f0
'-'                 add     ii,hbase
	byte	$76, $f5, $02, $f1
'-'                 drvl    ii                                 '#7<<6 + hdmi_base      ' enable HDMI pins
	byte	$58, $f4, $62, $fd
'-'                 wrpin   ##%10110_1111_0111_10_00000_0, ii  '#7<<6 + hdmi_base      ' a '123 ohm BITDAC for pins
	byte	$7b, $0b, $80, $ff, $7a, $01, $0b, $fc
'-' 
'-'                 setxfrq ##$0CCCCCCC+1                   'set streamer freq to 1/10th clk
	byte	$66, $66, $86, $ff, $1d, $9a, $65, $fd
'-' 
'-' 
'-' ''--------  frame rendering main loop  ---------------------------------------------------
'-' 
'-' p101            
'-'                 setq    #10
	byte	$28, $14, $64, $fd
'-'                 rdlong  framebuf,  ptra 
	byte	$00, $d9, $06, $fb
'-'                 setq    #15
	byte	$28, $1e, $64, $fd
'-'                 rdlong  m_bs,modeptr                     ' read timings
	byte	$71, $95, $02, $fb
'-'                 rdlong border,borderptr
	byte	$6e, $93, $02, $fb
'-'      
'-'                 add     frames,#1
	byte	$01, $be, $06, $f1
'-'                 mov     dlptr2,dlptr
	byte	$74, $f1, $02, $f6
'-' 
'-'                 rdlong  cursorx, cursorptr               ' read cursor position
	byte	$70, $c1, $02, $fb
'-'                 getbyte cursory, cursorx,#1              ' y position at byte #1
	byte	$60, $c3, $ea, $f8
'-'                 getbyte cursorsh,cursorx,#2              ' shape at byte #2
	byte	$60, $bd, $f2, $f8
'-'                 and     cursorx,#255                     ' clear the cursor x varioble from y and shape
	byte	$ff, $c0, $06, $f5
'-'  '' mailbox
'-'                 rdlong  t1,commandptr                    ' A mailbox interface, read the command
	byte	$73, $ff, $02, $fb
'-'                 add     commandptr,#4
	byte	$04, $e6, $06, $f1
'-'                 rdlong  t2,commandptr                    ' read the argument
	byte	$73, $01, $03, $fb
'-'                 sub     commandptr,#4                    ' restore the pionter
	byte	$04, $e6, $86, $f1
'-'                 cmp     t1,#256  wcz                     '
	byte	$00, $ff, $1e, $f2
'-'          if_lt  wrlut   t2,t1                            ' command 0..255-> set the color in LUT
	byte	$7f, $01, $33, $cc
'-'                 mov     t1, #257                         ' 257=idle
	byte	$01, $ff, $06, $f6
'-'                 wrlong  t1,commandptr                    ' write 257 to hub variable so the program can test if command was done
	byte	$73, $ff, $62, $fc
'-'  '' up porch
'-' 
'-'                 mov     hsync0,sync_000                  '
	byte	$45, $f9, $02, $f6
'-'                 mov     hsync1,sync_001
	byte	$46, $fb, $02, $f6
'-'                 callpa  i_upporch ,#blank
	byte	$1b, $a2, $46, $fb
'-'                 wrlong  #0,vblankptr
	byte	$6f, $01, $68, $fc
'-' 
'-' '' cursor blinking
'-' 
'-'                 testb   frames,#4 wz                     ' cursor blinks at framerate/16, todo: define
	byte	$04, $be, $0e, $f4
'-'          if_z   mov     cursorx,#129                     ' to switch the cursor off, move it out of the screen
	byte	$81, $c0, $06, $a6
'-' 
'-' '' main screen
'-' 
'-'                 mov linenum,#0
	byte	$00, $b8, $06, $f6
'-' 
'-' p301            rdlong  dl,dlptr2
	byte	$78, $f3, $02, $fb
'-' 
'-'                 mov     framebuf2,dl                    ' read a line start in the framebuffer from DL entry
	byte	$79, $f7, $02, $f6
'-'                 shr     framebuf2,#14
	byte	$0e, $f6, $46, $f0
'-'                 shl     framebuf2,#2     
	byte	$02, $f6, $66, $f0
'-' 
'-'                 getbyte t1,dl,#0 
	byte	$79, $ff, $e2, $f8
'-'                 cmp     t1,#0 wz
	byte	$00, $fe, $0e, $f2
'-'     if_z        jmp     #borderline
	byte	$34, $00, $90, $ad
'-'     
'-'                  testb   dl,#0  wc     ' bit 0 set = text OR extended:TODO     
	byte	$00, $f2, $16, $f4
'-'           if_c   jmp     #textline
	byte	$50, $00, $90, $cd
'-'           if_nc  jmp     #graphline
	byte	$50, $02, $90, $3d
'-' '        
'-' p302            add     linenum,#1
	byte	$01, $b8, $06, $f1
'-'                 add     dlptr2,#4
	byte	$04, $f0, $06, $f1
'-'                 cmp     linenum,i_totalvis  wz
	byte	$59, $b9, $0a, $f2
'-'          if_nz  jmp     #p301                                  
	byte	$c8, $ff, $9f, $5d
'-'                
'-' p112            wrlong  #1,vblankptr 
	byte	$6f, $03, $68, $fc
'-'                 callpa  i_downporch ,#blank             'bottom blanks
	byte	$07, $a6, $46, $fb
'-' 
'-'                 mov     hsync0,sync_222                 'vsync on
	byte	$47, $f9, $02, $f6
'-'                 mov     hsync1,sync_223
	byte	$48, $fb, $02, $f6
'-'                 callpa  i_vsync,#blank                  'vertical sync blanks
	byte	$04, $a4, $46, $fb
'-'                 jmp     #p101                    
	byte	$48, $ff, $9f, $fd
'-'   
'-' '' ---------------  END of frame rendering loop -------------------------------------------  
'-' 
'-' 
'-' borderline      call    #hsync                      ' make a border
	byte	$14, $00, $b0, $fd
'-'                 xcont   m_vi,border 
	byte	$49, $9b, $c2, $fc
'-'                 jmp     #p302 
	byte	$cc, $ff, $9f, $fd
'-' 
'-' 
'-' blank           call    #hsync                          'blank lines
	byte	$08, $00, $b0, $fd
'-'                 xcont   m_vi,hsync0
	byte	$7c, $9b, $c2, $fc
'-'         _ret_   djnz    pa,#blank
	byte	$fd, $ed, $6f, $0b
'-' 
'-' hsync           xcont   m_bs,hsync0                     'horizontal sync
	byte	$7c, $95, $c2, $fc
'-'                 xzero   m_sn,hsync1
	byte	$7d, $97, $b2, $fc
'-'         _ret_   xcont   m_bv,hsync0
	byte	$7c, $99, $c2, $0c
'-' 
'-' 
'-' 
'-' ''--%aaaa_aaaa_aaaa_aaaa_aazz_nnnn_llll_ll_01 - txt
'-'   '' aaaa_aaaa_aaaa_aaaa_aazz_rrrr_rrrr_cc_10 - graph
'-'   '' aaaa_aaaa_aaaa-aaaa_aarr_rrrr_rrrr_rr_11 - extended, next long to read 
'-'   
'-' '' Display a text line DL[31..12]=addr, nibble #1=textline, zoom: todo
'-' 
'-' textline        mov     cursorpos2,cursorx              ' we need another var for cursor as this code will repeat 16x for every char line
	byte	$60, $c7, $02, $f6
'-' 
'-'                 getnib  fontline,dl,#2                 ' fontline is 0 to 15, a line in font def
	byte	$79, $fd, $52, $f8
'-'                 getnib  zoom, dl,#3
	byte	$79, $13, $5b, $f8
'-'                 and		zoom, #3  
	byte	$03, $12, $07, $f5
'-'                 
'-' 
'-' 
'-'                 mov     linestart,dl                    ' linestart will be used for checking cursor y and compute line start addr in the buffer
	byte	$79, $b7, $02, $f6
'-'                 shr     linestart,#2                    ' scanline to char line
	byte	$02, $b6, $46, $f0
'-'                 and     linestart,#63
	byte	$3f, $b6, $06, $f5
'-'                 cmp     linestart,cursory wz            ' if the cursor is not here
	byte	$61, $b7, $0a, $f2
'-'           if_nz mov     cursorpos2,#129                 ' move it out of the screen
	byte	$81, $c6, $06, $56
'-' 
'-'                 call    #hsync                          ' now call hsync to gain some time between xconts
	byte	$cc, $ff, $bf, $fd
'-' 
'-'                        ' if fontline =0, get a border color
'-'                 
'-' p102            getword t1,m_border,#0                  
	byte	$4e, $ff, $32, $f9
'-'                 cmp     t1, #0 wz
	byte	$00, $fe, $0e, $f2
'-'           if_nz xcont   m_border,border                 ' display a left border if exists
	byte	$49, $9d, $c2, $5c
'-'         
'-'                 cmp     fontline,cursorsh wcz           ' if the cursor have to be not displayed due to its shape
	byte	$5e, $fd, $1a, $f2
'-'           if_c  mov     cursorpos,#129                  ' move it out of the screen
	byte	$81, $c4, $06, $c6
'-'          if_nc  mov     cursorpos,cursorpos2
	byte	$63, $c5, $02, $36
'-'                 add     cursorpos,#1                    ' we will substract #1 below so compensate this here
	byte	$01, $c4, $06, $f1
'-'                 mov     t2,fontbuf                      ' font definition pointer
	byte	$6d, $01, $03, $f6
'-'                 add     t2,fontline                     ' add a current font line
	byte	$7e, $01, $03, $f1
'-'                 mov m_lut2, m_lut1
	byte	$4f, $b5, $02, $f6
'-'                 add m_lut2, lutt1
	byte	$67, $b5, $02, $f1
'-'                 mov cpl2,i_cpl
	byte	$55, $0b, $03, $f6
'-'   
'-'                cmp zoom,#2 wz
	byte	$02, $12, $0f, $f2
'-'           if_z jmp #p420
	byte	$e4, $00, $90, $ad
'-'                cmp zoom,#1 wz
	byte	$01, $12, $0f, $f2
'-'           if_z jmp #p410
	byte	$64, $00, $90, $ad
'-'                 cmp zoom,#0 wz
	byte	$00, $12, $0f, $f2
'-'           if_z jmp #p400    
	byte	$04, $00, $90, $ad
'-'                jmp #p430  
	byte	$50, $01, $90, $fd
'-'           
'-'                    '   
'-'  ''---------------------------------------------------------------------------------------------------------          
'-'  p400                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$7b, $0d, $03, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$86, $0f, $f3, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$86, $11, $fb, $f8
'-'                         getbyte char,char, #0           ' word #0 - char code                       '4
	byte	$86, $0d, $e3, $f8
'-'                         add     framebuf2,#4            ' point to the next long                    '5
	byte	$04, $f6, $06, $f1
'-'                         shl     char,#4                 ' 1 char=16 bytes in font def               '6
	byte	$04, $0c, $67, $f0
'-'                         add     char,t2                 ' add this to font/line pointer             '7
	byte	$80, $0d, $03, $f1
'-'                         rdbyte  t1,char                 ' and get 8 pixels prom there               '8
	byte	$86, $ff, $c2, $fa
'-'                         sub     cursorpos,#1 wz         ' if there is a cursor                      '9
	byte	$01, $c4, $8e, $f1
'-'                   if_z  xor     t1, #$FF                ' reverse the colors                        '10         
	byte	$ff, $fe, $66, $a5
'-' 
'-'                         xcont m_lut2,t1
	byte	$7f, $b5, $c2, $fc
'-'    
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$87, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$5d, $07, $33, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $ba, $06, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$88, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$5d, $07, $33, $fc
'-'                         sub     lutaddr,#1  
	byte	$01, $ba, $86, $f1
'-' 
'-'                         bitnot  m_lut2,#16                                                          '19
	byte	$10, $b4, $e6, $f4
'-'                         bitnot  m_lut1,#16                                                          '19
	byte	$10, $9e, $e6, $f4
'-'                         xor     lutaddr,#32             ' use LUT #0-1 and 32-33                    '20
	byte	$20, $ba, $66, $f5
'-' 
'-'                         djnz   cpl2,#p400   
	byte	$eb, $0b, $6f, $fb
'-'  p401                   jmp    #p103
	byte	$28, $01, $90, $fd
'-'                         
'-' ''------------------------------------------------------------------------------------------------------------
'-'   
'-'  p410                   shr cpl2,#1 
	byte	$01, $0a, $47, $f0
'-'                      
'-' ''---------------------------------------------------------------------------------------------------------          
'-'  p412                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$7b, $0d, $03, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$86, $0f, $f3, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$86, $11, $fb, $f8
'-'                         getbyte char,char, #0           ' word #0 - char code                       '4
	byte	$86, $0d, $e3, $f8
'-'                         add     framebuf2,#4            ' point to the next long                    '5
	byte	$04, $f6, $06, $f1
'-'                         shl     char,#4                 ' 1 char=16 bytes in font def               '6
	byte	$04, $0c, $67, $f0
'-'                         add     char,t2                 ' add this to font/line pointer             '7
	byte	$80, $0d, $03, $f1
'-'                         rdbyte  t1,char                 ' and get 8 pixels prom there               '8
	byte	$86, $ff, $c2, $fa
'-'                         sub     cursorpos,#1 wz         ' if there is a cursor                      '9
	byte	$01, $c4, $8e, $f1
'-'                   if_z  xor     t1, #$FF                ' reverse the colors                        '10         
	byte	$ff, $fe, $66, $a5
'-'   
'-'   
'-'                         getnib t3,t1,#1                   ' 4 pixels to t3  						'1  - +
	byte	$7f, $03, $4b, $f8
'-'                         getnib t1,t1,#0                   ' 4 pixels to t1							'2  - +
	byte	$7f, $ff, $42, $f8
'-'                         mergew t1                         ' make 01010101 from 1111					'3  - +
	byte	$63, $fe, $62, $fd
'-'                         mul t1,#3 
	byte	$03, $fe, $06, $fa
'-'                         xcont m_lut2,t1
	byte	$7f, $b5, $c2, $fc
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$87, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$5d, $07, $33, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $ba, $06, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$88, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$5d, $07, $33, $fc
'-'                         sub     lutaddr,#1                         
	byte	$01, $ba, $86, $f1
'-'                         mergew t3
	byte	$63, $02, $63, $fd
'-'                         mul t3,#3
	byte	$03, $02, $07, $fa
'-'                         xcont m_lut2,t3
	byte	$81, $b5, $c2, $fc
'-'    
'-'                         bitnot  m_lut2,#16                                                          '19
	byte	$10, $b4, $e6, $f4
'-'                         bitnot  m_lut1,#16                                                          '19
	byte	$10, $9e, $e6, $f4
'-'                         
'-'                         xor     lutaddr,#32             ' use LUT #0-1 and 32-33                    '20
	byte	$20, $ba, $66, $f5
'-' 
'-'                         djnz   cpl2,#p412              
	byte	$e4, $0b, $6f, $fb
'-'  p411                   jmp    #p103
	byte	$b0, $00, $90, $fd
'-'                         
'-' ''------------------------------------------------------------------------------------------------------------
'-' 
'-'  p420                   shr cpl2,#2
	byte	$02, $0a, $47, $f0
'-' 
'-' ''---------------------------------------------------------------------------------------
'-'  p422                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$7b, $0d, $03, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$86, $0f, $f3, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$86, $11, $fb, $f8
'-'                         getbyte char,char, #0           ' word #0 - char code                       '4
	byte	$86, $0d, $e3, $f8
'-'                         add     framebuf2,#4            ' point to the next long                    '5
	byte	$04, $f6, $06, $f1
'-'                         shl     char,#4                 ' 1 char=16 bytes in font def               '6
	byte	$04, $0c, $67, $f0
'-'                         add     char,t2                 ' add this to font/line pointer             '7
	byte	$80, $0d, $03, $f1
'-'                         rdbyte  t1,char                 ' and get 8 pixels prom there               '8
	byte	$86, $ff, $c2, $fa
'-'                         sub     cursorpos,#1 wz         ' if there is a cursor                      '9
	byte	$01, $c4, $8e, $f1
'-'                   if_z  xor     t1, #$FF                ' reverse the colors                        '10
	byte	$ff, $fe, $66, $a5
'-' 
'-'                         mergeb t1
	byte	$61, $fe, $62, $fd
'-'                         getword t3,t1,#1
	byte	$7f, $03, $3b, $f9
'-'                         mul t1,#15
	byte	$0f, $fe, $06, $fa
'-'                         xcont m_lut2,t1
	byte	$7f, $b5, $c2, $fc
'-'                         
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$87, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$5d, $07, $33, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $ba, $06, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$88, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$5d, $07, $33, $fc
'-'                         sub     lutaddr,#1 
	byte	$01, $ba, $86, $f1
'-'                         
'-'                         getbyte t4,t1,#1        '          
	byte	$7f, $05, $eb, $f8
'-'                         xcont m_lut2,t4                                                                                                           ' 
	byte	$82, $b5, $c2, $fc
'-'                        
'-'                         mul t3,#15
	byte	$0f, $02, $07, $fa
'-'                         xcont m_lut2,t3
	byte	$81, $b5, $c2, $fc
'-'                         
'-'                         getbyte t5,t3,#1
	byte	$81, $07, $eb, $f8
'-'                         xcont m_lut2, t5
	byte	$83, $b5, $c2, $fc
'-'                         bitnot  m_lut2,#16                                                          '19
	byte	$10, $b4, $e6, $f4
'-'                         bitnot  m_lut1,#16                                                          '19
	byte	$10, $9e, $e6, $f4
'-'                         
'-'                         xor     lutaddr,#32             ' use LUT #0-1 and 32-33                    '20
	byte	$20, $ba, $66, $f5
'-' 
'-'                         djnz   cpl2,#p422              
	byte	$e2, $0b, $6f, $fb
'-'  p421                   jmp    #p103 
	byte	$30, $00, $90, $fd
'-'                         
'-' '--------------------------------------------------------------------------------------------------------------                      
'-'         
'-'  p430                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$7b, $0d, $03, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$86, $0f, $f3, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$86, $11, $fb, $f8
'-'      
'-'                         xcont m_lut2,#0
	byte	$00, $b4, $c6, $fc
'-'    
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$87, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$5d, $07, $33, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $ba, $06, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$88, $07, $a3, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$5d, $07, $33, $fc
'-'                         sub     lutaddr,#1  
	byte	$01, $ba, $86, $f1
'-' 
'-'                         djnz   cpl2,#p430   
	byte	$f5, $0b, $6f, $fb
'-'  p431                   jmp    #p103
	byte	$00, $00, $90, $fd
'-'                         
'-' ''------------------------------------------------------------------------------------------------------------
'-'   
'-'                     
'-' 
'-' p103            getword  t1,m_border,#0
	byte	$4e, $ff, $32, $f9
'-'                 cmp      t1, #0 wz
	byte	$00, $fe, $0e, $f2
'-'                 if_nz    xcont   m_border,border            'display a right border if exists
	byte	$49, $9d, $c2, $5c
'-'                 
'-'                 jmp #p302
	byte	$b0, $fd, $9f, $fd
'-'                 
'-' '' -------------------------------------- END of text line ---------------------------------              
'-'                 
'-'   '' aaaa_aaaa_aaaa_aaaa_aazz_rrrr_rrrr_cc_10 - graph - display a graphics line
'-' 
'-' graphline       call    #hsync                          ' now call hsync to gain some time between xconts
	byte	$ec, $fd, $bf, $fd
'-' 
'-'                
'-' p202            getword t1,m_border,#0                  
	byte	$4e, $ff, $32, $f9
'-'                 cmp     t1, #0 wz
	byte	$00, $fe, $0e, $f2
'-'           if_nz xcont   m_border,border                 ' display a left border if exists
	byte	$49, $9d, $c2, $5c
'-'           
'-' '----------------------------------------- display pixels
'-'  
'-'                 mov     m_lut2,m_lut1                   ' m_lut1 loaded from hub timing block, pixel per long
	byte	$4f, $b5, $02, $f6
'-'                 mov     cpl2,i_cpl                      ' i_cpl in graphic modes is longs per line
	byte	$55, $0b, $03, $f6
'-' 
'-'                 getnib  zoom, dl,#3
	byte	$79, $13, $5b, $f8
'-'                 and		zoom, #3                        ' get a horizontal zoom for the line
	byte	$03, $12, $07, $f5
'-'              
'-'                 mov     colordepth,dl                   ' get a color depth, reuse linestart var f         '
	byte	$79, $b7, $02, $f6
'-'                 and     colordepth,#12
	byte	$0c, $b6, $06, $f5
'-'  
'-'                 cmp     colordepth,#%0000 wz            ' 1 bpp modes
	byte	$00, $b6, $0e, $f2
'-'           if_z  add     m_lut2,lutg1   
	byte	$68, $b5, $02, $a1
'-'           if_z  jmp     #p240
	byte	$68, $00, $90, $ad
'-'           
'-'                 cmp     colordepth,#%0100 wz            ' 2 bpp modes
	byte	$04, $b6, $0e, $f2
'-'           if_z  add     m_lut2,lutg2   
	byte	$69, $b5, $02, $a1
'-'           if_z  jmp     #p250
	byte	$9c, $00, $90, $ad
'-'           
'-'                 cmp     colordepth,#%1000 wz            ' 4 bpp modes
	byte	$08, $b6, $0e, $f2
'-'           if_z  add     m_lut2,lutg4   
	byte	$6a, $b5, $02, $a1
'-'           if_z  jmp     #p260
	byte	$00, $01, $90, $ad
'-' 
'-'                 add m_lut2,lutg8                        ' 8 bpp modes
	byte	$6b, $b5, $02, $f1
'-'             
'-' '' --- 8 bit color modes 
'-' 
'-'                 cmp zoom, #%00 wz   '256 colors, zoom x1
	byte	$00, $12, $0f, $f2
'-'                 if_z jmp #p251      'there is an universal loop for 1x zoom at p251, saves one long of skip pattern
	byte	$54, $01, $90, $ad
'-'                    
'-'                 cmp zoom, #%01 wz   '256 colors, zoom x2
	byte	$01, $12, $0f, $f2
'-'            if_z mov skippattern,#%101010
	byte	$2a, $08, $07, $a6
'-'  '         
'-'                 cmp zoom, #%10 wz   '256 colors, zoom x4
	byte	$02, $12, $0f, $f2
'-'            if_z mov skippattern,#%011001
	byte	$19, $08, $07, $a6
'-'  '     
'-'                 cmp zoom, #%11 wz   '256 colors, zoom x8
	byte	$03, $12, $0f, $f2
'-'           if_z  mov skippattern,#%010001
	byte	$11, $08, $07, $a6
'-'           if_z  shr cpl2,#1         ' if 8x zoom, 2 xconts used in one loop, so divide loop count by 2
	byte	$01, $0a, $47, $a0
'-'               '
'-'                
'-' p231               rdlong  char,framebuf2           
	byte	$7b, $0d, $03, $fb
'-'                    skipf skippattern
	byte	$32, $08, $63, $fd
'-'                    movbyts char,#%01010000         '0 1 1
	byte	$50, $0c, $ff, $f9
'-'                    movbyts char,#%00000000         '1 0 0
	byte	$00, $0c, $ff, $f9
'-'                    xcont   m_lut2,char             '0 0 0   
	byte	$86, $b5, $c2, $fc
'-'                    xcont   m_lut2,char             '1 1 0
	byte	$86, $b5, $c2, $fc
'-'               '    add     framebuf2,#4            '1 1 1
'-'                    add     framebuf2,#2			   '0 1 1
	byte	$02, $f6, $06, $f1
'-'                    add     framebuf2,#1		       '1 0 0
	byte	$01, $f6, $06, $f1
'-'                    djnz    cpl2,#p231                  
	byte	$f7, $0b, $6f, $fb
'-'  
'-'                jmp    #p203
	byte	$20, $01, $90, $fd
'-'          
'-' '' --- 1 bit color modes   
'-' 
'-' p240          cmp zoom, #%00 wz     '2 colors, zoom x1
	byte	$00, $12, $0f, $f2
'-'        if_z   jmp #p251              'there is an universal loop for 1x zoom at p251, saves one long of skip pattern 
	byte	$08, $01, $90, $ad
'-'                  
'-'               cmp zoom, #%01 wz     '2 colors, zoom x2
	byte	$01, $12, $0f, $f2
'-'        if_z   mov skippattern,#%10011
	byte	$13, $08, $07, $a6
'-'        if_nz  mov skippattern,#%01000
	byte	$08, $08, $07, $56
'-'     
'-'          
'-' p241               rdword  char,framebuf2    
	byte	$7b, $0d, $e3, $fa
'-'                    movbyts char,#%01000100        
	byte	$44, $0c, $ff, $f9
'-'                    mergew  char                   
	byte	$63, $0c, $63, $fd
'-'                    skipf skippattern                   
	byte	$32, $08, $63, $fd
'-'                    movbyts char,#%01000100         ' 1 0 
	byte	$44, $0c, $ff, $f9
'-'                    mergew  char                    ' 1 0 
	byte	$63, $0c, $63, $fd
'-'                    xcont   m_lut2,char             ' 0 0  
	byte	$86, $b5, $c2, $fc
'-'                    add     framebuf2,#2			   ' 0 1 
	byte	$02, $f6, $06, $f1
'-'                    add     framebuf2,#1		       ' 1 0 
	byte	$01, $f6, $06, $f1
'-'                    djnz   cpl2,#p241     
	byte	$f6, $0b, $6f, $fb
'-'                 
'-'  
'-'                jmp    #p203
	byte	$e0, $00, $90, $fd
'-' 
'-' '' --- 2 bit color modes   
'-' 
'-' p250          cmp zoom, #%00 wz     '4 colors, zoom x1
	byte	$00, $12, $0f, $f2
'-'        if_z   jmp #p251 
	byte	$c8, $00, $90, $ad
'-'              
'-'               cmp zoom, #%01 wz     '4 colors, zoom x2
	byte	$01, $12, $0f, $f2
'-'        if_z   jmp #p252   
	byte	$30, $00, $90, $ad
'-'            
'-'                 
'-' p254               rdbyte char,framebuf2
	byte	$7b, $0d, $c3, $fa
'-'                    mov  t5,#4  
	byte	$04, $06, $07, $f6
'-' p255               shl  char,#2              
	byte	$02, $0c, $67, $f0
'-'                    getnib  t1,char,#2           
	byte	$86, $ff, $52, $f8
'-'                    and     t1,#3                 
	byte	$03, $fe, $06, $f5
'-'                    mul     t1,#$55               
	byte	$55, $fe, $06, $fa
'-'                    rolbyte  t2,t1,#0             
	byte	$7f, $01, $03, $f9
'-'                    djnz    t5,#p255             
	byte	$fa, $07, $6f, $fb
'-'                    xcont   m_lut2,t2 
	byte	$80, $b5, $c2, $fc
'-'                    add     framebuf2,#1         
	byte	$01, $f6, $06, $f1
'-'                    djnz    cpl2,#p254  
	byte	$f5, $0b, $6f, $fb
'-'                    jmp     #p203          
	byte	$a0, $00, $90, $fd
'-'          
'-' p252               rdword char,framebuf2
	byte	$7b, $0d, $e3, $fa
'-'                    mov  t5,#8  
	byte	$08, $06, $07, $f6
'-' p253               shl  char,#2                  
	byte	$02, $0c, $67, $f0
'-'                    getnib  t1,char,#4            
	byte	$86, $ff, $62, $f8
'-'                    and     t1,#3                
	byte	$03, $fe, $06, $f5
'-'                    mul     t1,#5                
	byte	$05, $fe, $06, $fa
'-'                    rolnib  t2,t1,#0              
	byte	$7f, $01, $83, $f8
'-'                    djnz    t5,#p253              
	byte	$fa, $07, $6f, $fb
'-'                    xcont   m_lut2,t2 
	byte	$80, $b5, $c2, $fc
'-'                    add     framebuf2,#2          
	byte	$02, $f6, $06, $f1
'-'                    djnz    cpl2,#p252  
	byte	$f5, $0b, $6f, $fb
'-'                    jmp     #p203                    
	byte	$70, $00, $90, $fd
'-'   
'-' '' ------ 4 bit color modes 
'-' 
'-' p260          cmp zoom, #%00 wz     '4 colors, zoom x1, the same loop as 2bpp
	byte	$00, $12, $0f, $f2
'-'        if_z   jmp #p251 
	byte	$58, $00, $90, $ad
'-'              
'-'               cmp zoom, #%01 wz     '4 colors, zoom x2
	byte	$01, $12, $0f, $f2
'-'        if_z   jmp #p262   
	byte	$2c, $00, $90, $ad
'-'            
'-'        
'-' p263               rdbyte char,framebuf2           
	byte	$7b, $0d, $c3, $fa
'-'     			   rep #5,#2
	byte	$02, $0a, $dc, $fc
'-'     			     rolnib t2,char,#1
	byte	$86, $01, $8b, $f8
'-'    		  	         rolnib t2,char,#1
	byte	$86, $01, $8b, $f8
'-'     			     rolnib t2,char,#1
	byte	$86, $01, $8b, $f8
'-'    		  	         rolnib t2,char,#1
	byte	$86, $01, $8b, $f8
'-'     			     shl char,#4
	byte	$04, $0c, $67, $f0
'-'                    xcont   m_lut2,t2 
	byte	$80, $b5, $c2, $fc
'-'                    add     framebuf2,#1          
	byte	$01, $f6, $06, $f1
'-'                    djnz    cpl2,#p263  
	byte	$f6, $0b, $6f, $fb
'-'                    jmp     #p203                
	byte	$34, $00, $90, $fd
'-'         
'-' p262               rdword  char,framebuf2           
	byte	$7b, $0d, $e3, $fa
'-'     			   rep #3,#4
	byte	$04, $06, $dc, $fc
'-'     			     rolnib t2,char,#3
	byte	$86, $01, $9b, $f8
'-'    		  	         rolnib t2,char,#3
	byte	$86, $01, $9b, $f8
'-'     			     shl char,#4
	byte	$04, $0c, $67, $f0
'-'                    xcont   m_lut2,t2 
	byte	$80, $b5, $c2, $fc
'-'                    add     framebuf2,#2          
	byte	$02, $f6, $06, $f1
'-'                    djnz    cpl2,#p262  
	byte	$f8, $0b, $6f, $fb
'-'                    jmp     #p203 
	byte	$10, $00, $90, $fd
'-' 
'-' ''---------- all color modes without zoom
'-' 
'-' p251               rdlong  char,framebuf2           
	byte	$7b, $0d, $03, $fb
'-'                    xcont   m_lut2,char 
	byte	$86, $b5, $c2, $fc
'-'                    add     framebuf2,#4          
	byte	$04, $f6, $06, $f1
'-'                    djnz    cpl2,#p251     ' no jmp #p203, not needed here
	byte	$fc, $0b, $6f, $fb
'-' 
'-'  ''-----------------------------------------------------------------------------------------
'-' p203            getword  t1,m_border,#0
	byte	$4e, $ff, $32, $f9
'-'                 cmp      t1, #0 wz
	byte	$00, $fe, $0e, $f2
'-'                 if_nz    xcont   m_border,border            'display a right border if exists
	byte	$49, $9d, $c2, $5c
'-'                 
'-'                 jmp #p302
	byte	$e4, $fb, $9f, $fd
'-'                 
'-' '' -------------------------------------- END of graph  line ---------------------------------              
'-' 
'-' '' consts and vars
'-' 
'-' sync_000        long    %1101010100_1101010100_1101010100_10    '
	byte	$52, $4d, $35, $d5
'-' sync_001        long    %1101010100_1101010100_0010101011_10    '        hsync
	byte	$ae, $42, $35, $d5
'-' sync_222        long    %0101010100_0101010100_0101010100_10    'vsync
	byte	$52, $45, $15, $55
'-' sync_223        long    %0101010100_0101010100_1010101011_10    'vsync + hsync
	byte	$ae, $4a, $15, $55
'-' 
'-' border          long    %00000000_00011010_00101100_00000000
	byte	$00, $2c, $1a, $00
'-' 
'-' '------ these longs will be set by setmode function
'-' 
'-' m_bs            long    0        'blanks before sync
	byte	$00, $00, $00, $00
'-' m_sn            long    0        'sync
	byte	$00, $00, $00, $00
'-' m_bv            long    0        'blanks before visible
	byte	$00, $00, $00, $00
'-' m_vi            long    0        'visible pixels #
	byte	$00, $00, $00, $00
'-' m_border        long    0        'left/right borders
	byte	$00, $00, $00, $00
'-' m_lut1          long    0        'characters
	byte	$00, $00, $00, $00
'-' i_vborder       long    0        'up/down borders
	byte	$00, $00, $00, $00
'-' i_upporch       long    0        'up porch lines
	byte	$00, $00, $00, $00
'-' i_vsync         long    0        'vsync lines
	byte	$00, $00, $00, $00
'-' i_downporch     long    0        'down porch lines
	byte	$00, $00, $00, $00
'-' i_modenum       long    0        'mode #
	byte	$00, $00, $00, $00
'-' i_cpl           long    0        'chars/longs per line
	byte	$00, $00, $00, $00
'-' i_lines         long    0        'scanlines #
	byte	$00, $00, $00, $00
'-' i_clock         long    0
	byte	$00, $00, $00, $00
'-' i_hubset        long    0
	byte	$00, $00, $00, $00
'-' i_totalvis      long    0 
	byte	$00, $00, $00, $00
'-' 
'-' '-------------------------------------
'-' 
'-' m_lut2          long    0
	byte	$00, $00, $00, $00
'-' 
'-' colordepth
'-' linestart       long    0
	byte	$00, $00, $00, $00
'-' linenum         long    0
	byte	$00, $00, $00, $00
'-' lutaddr         long    256
	byte	$00, $01, $00, $00
'-' 
'-' cursorsh        long    14
	byte	$0e, $00, $00, $00
'-' frames          long    0
	byte	$00, $00, $00, $00
'-' cursorx         long    0
	byte	$00, $00, $00, $00
'-' cursory         long    0
	byte	$00, $00, $00, $00
'-' cursorpos       long    0
	byte	$00, $00, $00, $00
'-' cursorpos2      long    0
	byte	$00, $00, $00, $00
'-' fontstart       long    0
	byte	$00, $00, $00, $00
'-' border2 long 0
	byte	$00, $00, $00, $00
'-' lutiv	        long $70810000
	byte	$00, $00, $81, $70
'-' lutt1           long $00880000 
	byte	$00, $00, $88, $00
'-' lutg1           long $008d0000
	byte	$00, $00, $8d, $00
'-' lutg2           long $108e0000
	byte	$00, $00, $8e, $10
'-' lutg4           long $208f0000 
	byte	$00, $00, $8f, $20
'-' lutg8           long $30800000
	byte	$00, $00, $80, $30
'-' framebuf        res     1
'-' fontbuf         res     1
'-' borderptr       res     1
'-' vblankptr       res     1
'-' cursorptr       res     1
'-' modeptr         res     1
'-' paletteptr      res     1
'-' commandptr      res     1
'-' dlptr			res     1
'-' fontnumptr      res     1
'-' hbase           res     1
'-' borderptr2      res     1
'-' dlptr2 res 1
'-' dl              res 1
'-' ii              res     1
'-' framebuf2       res     1
'-' hsync0          res     1
'-' hsync1          res     1
'-' fontline        res     1
'-' t1              res     1
'-' t2              res     1
'-' t3 res 1
'-' t4 res 1
'-' t5 res 1
'-' skippattern res 1
'-' cpl2 res 1
'-' char            res     1
'-' backcolor       res     1
'-' charcolor       res     1
'-' zoom res 1
'-' aend             long 0
	byte	$00, $00, $00, $00
	alignl
__system__dat_
	byte	$00, $00, $00, $00, $00, $00, $00, $00, $03, $00, $00, $00, $00, $00, $00, $00
__heap_base
	long	0[1026]
objmem
	long	0[61]
stackspace
	long	0[1]
	org	COG_BSS_START
_tmp001_
	res	1
_var01
	res	1
_var02
	res	1
_var03
	res	1
_var04
	res	1
_var05
	res	1
_var06
	res	1
_var07
	res	1
_var08
	res	1
_var09
	res	1
_var10
	res	1
_var11
	res	1
_var12
	res	1
_var13
	res	1
_var14
	res	1
_var15
	res	1
_var16
	res	1
_var17
	res	1
_var18
	res	1
_var19
	res	1
_var20
	res	1
_var21
	res	1
_var22
	res	1
_var23
	res	1
_var24
	res	1
_var25
	res	1
_var26
	res	1
_var27
	res	1
_var28
	res	1
_var29
	res	1
_var30
	res	1
_var31
	res	1
_var32
	res	1
_var33
	res	1
_var34
	res	1
_var35
	res	1
_var36
	res	1
_var37
	res	1
arg01
	res	1
arg02
	res	1
arg03
	res	1
arg04
	res	1
arg05
	res	1
arg06
	res	1
arg07
	res	1
arg08
	res	1
arg09
	res	1
arg10
	res	1
arg11
	res	1
arg12
	res	1
arg13
	res	1
arg14
	res	1
arg15
	res	1
arg16
	res	1
arg17
	res	1
arg18
	res	1
local01
	res	1
local02
	res	1
local03
	res	1
local04
	res	1
local05
	res	1
local06
	res	1
local07
	res	1
local08
	res	1
local09
	res	1
local10
	res	1
local11
	res	1
local12
	res	1
local13
	res	1
local14
	res	1
local15
	res	1
local16
	res	1
local17
	res	1
local18
	res	1
local19
	res	1
local20
	res	1
local21
	res	1
local22
	res	1
local23
	res	1
local24
	res	1
local25
	res	1
local26
	res	1
local27
	res	1
local28
	res	1
local29
	res	1
local30
	res	1
local31
	res	1
local32
	res	1
local33
	res	1
local34
	res	1
local35
	res	1
local36
	res	1
local37
	res	1
local38
	res	1
local39
	res	1
local40
	res	1
muldiva_
	res	1
muldivb_
	res	1
	fit	480
