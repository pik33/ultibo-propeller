' 
' 
' hdmi_base       = 48             'must be a multiple of 8
con
	hdmi_base = 48
' _clkfreq        = 345_000_000    'start safe, hubset will do the rest. The clock will be changed to:
	_clkfreq = 345000000
' 
' ' 354_689_500   200x Atari 8-bit PAL,  50x Amiga PAL  - real settings: 49,869-> 354_693_878  - 1.0000123 - mode 0 and 192
' ' 357_954_500   200x Atari 8-bit NTSC, 50x Amiga NTSC - real settings: 49,877-> 357_959_184  - 1.0000131 - mode 256
' 
' ' 319_220_550   180x PAL  - real settings: 51,814-> 319_215_686 - 0.9999848 - mode 64
' ' 322_159_050   180x NTSC - real settings: 37,596-> 322_162_162 - 1.0000097 - mode 320 and 448
' 
' ' 283_751_600   160x PAL  - real settings: 64,908-> 283_750_000 - 0.9999944 - mode 128
' ' 286_363_600   160x NTSC - real settings: 22,315-> 286_363_636 - 1.0000001 - mode 384
' 
' ''--------- VGA DOS color definition constants
' 
' c_black         =    0
	c_black = 0
' c_blue          =  117
	c_blue = 117
' c_green         =  199
	c_green = 199
' c_cyan          =  149
	c_cyan = 149
' c_red           =   39
	c_red = 39
' c_magenta       =   71
	c_magenta = 71
' c_brown         =  246
	c_brown = 246
' c_lightgray     =   10
	c_lightgray = 10
' c_darkgray      =    5
	c_darkgray = 5
' c_lightblue     =  121
	c_lightblue = 121
' c_lightgreen    =  203
	c_lightgreen = 203
' c_lightcyan     =  155
	c_lightcyan = 155
' c_lightred      =   43
	c_lightred = 43
' c_lightmagenta  =   75
	c_lightmagenta = 75
' c_yellow        =  234
	c_yellow = 234
' c_white         =   15
	c_white = 15
' 
' timingsxxt      =  $70810000
	timingsxxt = 1887502336
dat
	nop
	cogid	pa
	coginit	pa,##$404
	orgh	$10
	long	0	'reserved
	long	0 ' clock frequency: will default to 345000000
	long	0 ' clock mode: will default to $10c44fb
	orgh	$400
 _ret_	mov	result1, #0
	org	0
entry
	cmp	ptra, #0 wz
 if_ne	jmp	#spininit
	mov	ptra, ptr_stackspace_
	rdlong	pa, #20 wz
 if_ne	jmp	#skip_clock_set_
	hubset	#0
	hubset	##17581304
	waitx	##200000
	mov	pa, ##17581307
	hubset	pa
	wrlong	pa, #24
	wrlong	##345000000, #20
	jmp	#skip_clock_set_
	orgf	32
skip_clock_set_
	locknew	__lockreg
	wrlong	__lockreg, ptr___lockreg_
	call	#_dummy
cogexit
	waitx	##160000
	cogid	arg01
	cogstop	arg01
spininit
	rdlong	objptr, ptra
	add	ptra, #4
	rdlong	result1, ptra
	add	ptra, #4
	rdlong	arg01, ptra
	add	ptra, #4
	rdlong	arg02, ptra
	add	ptra, #4
	rdlong	arg03, ptra
	add	ptra, #4
	rdlong	arg04, ptra
	sub	ptra, #16
	call	result1
	jmp	#cogexit
COUNT_
    long 0
RETADDR_
    long 0
fp
    long 0
gosub_
    mov  COUNT_, #0
    mov  pa, arg01
    pop  RETADDR_
    jmp  #pushregs_done_
pushregs_
    pop  pa
    pop  RETADDR_
    tjz  COUNT_, #pushregs_done_
    sub  COUNT_, #1
    setq COUNT_
    wrlong local01, ptra
    add  COUNT_, #1
pushregs_done_
    shl  COUNT_, #2
    add  ptra, COUNT_
    shr  COUNT_, #2
    setq #2 ' push 3 registers starting at COUNT_
    wrlong COUNT_, ptra
    add    ptra, #12
    mov    fp, ptra
    jmp  pa
 popregs_
    pop    pa
    sub    ptra, #12
    setq   #2
    rdlong COUNT_, ptra
    tjz    COUNT_, #popregs__ret
    shl    COUNT_, #2
    sub    ptra, COUNT_
    shr    COUNT_, #2
    sub    COUNT_, #1
    setq   COUNT_
    rdlong local01, ptra
popregs__ret
    push   RETADDR_
    jmp    pa

unsdivide_
       setq    #0
       qdiv    muldiva_, muldivb_
       getqx   muldivb_
 _ret_ getqy   muldiva_

divide_
       abs     muldiva_,muldiva_     wc       'abs(x)
       muxc    itmp2_,#%11                    'store sign of x
       abs     muldivb_,muldivb_     wcz      'abs(y)
 if_c  xor     itmp2_,#%10                    'store sign of y
 if_z  ret
       call    #unsdivide_
       test    itmp2_,#1        wc       'restore sign, remainder
       negc    muldiva_,muldiva_ 
       test    itmp2_,#%10      wc       'restore sign, division result
 _ret_ negc    muldivb_,muldivb_

__lockreg
	long	0
itmp1_
	long	0
itmp2_
	long	0
objptr
	long	@objmem
ptr___lockreg_
	long	@__lockreg
ptr__dat__
	long	@_dat_
ptr_stackspace_
	long	@stackspace
result1
	long	0
COG_BSS_START
	fit	480
	orgh
hubentry

' 
' ''--------- timings
' ' 0  m_bs        - before sync,             16      80
' ' 1  m_sn        - sync                     80     160
' ' 2  m_bv        - before visible           20      84
' ' 3  m_vi        - visible                1024     816
' ' 4  m_border    - left and right borders  112       8
' ' 5  m_lut1      - pixels per char           8       8
' ' 6  i_vborder   - up and down border       48       8
' ' 7  i_upporch   - up non visible           16       8
' ' 8  i_vsync     - vsync                    16      12
' ' 9  i_downporch - down non visible         16       8
' '10  mode #
' '11  cpl         - character per line
' '12  scanlines #
' '13  clock
' '14  hubset value for clock settings
' 
' 
' '*************************************************************************
' '                                                                        *
' '  A dummy start function if someone runs this driver alone              *
' '                                                                        *
' '*************************************************************************
' 
' pub dummy()|i,x,y
_dummy
	mov	COUNT_, #8
	call	#pushregs_
' '' this is not a main program.
' 
' start(0,48)
	mov	local01, #0
	mov	local02, #48
	mov	arg01, local01
	mov	arg02, local02
	call	#_start
	mov	local03, result1
' 'pinwrite(15,0)
' 'start(560,48)
' cls(154,147)
	mov	local01, #154
	mov	local02, #147
	mov	arg01, local01
	mov	arg02, local02
	call	#_cls
	mov	local03, result1
' 'putpixel:=@putpixel8
' writeln(inttostr(buflen))
	add	objptr, #52
	rdlong	local02, objptr
	sub	objptr, #52
	mov	local01, local02
	mov	arg01, local01
	call	#_inttostr
	mov	local03, result1
	mov	arg01, local03
	call	#_writeln
' waitvbl(2400)
	mov	local01, ##2400
	mov	arg01, local01
	call	#_waitvbl
' setmode(560)
	mov	local01, ##560
	mov	arg01, local01
	call	#_setmode
' repeat y from 0 to 479
	mov	local04, #0
LR__0001
'   repeat x from 0 to 799
	mov	local05, #0
LR__0002
'     putpixel8(x,y,(x+y+i)//256)
	mov	local01, local05
	mov	local02, local04
	mov	local03, local05
	add	local03, local04
	add	local03, local06
	abs	local07, local03 wc
	and	local07, #255
 if_b	neg	local07, local07
	mov	local08, local07
	mov	arg01, local01
	mov	arg02, local02
	mov	arg03, local08
	call	#_putpixel8
	mov	local01, local05
	mov	local02, local05
	add	local02, #1
	mov	local05, local02
	cmps	local05, ##800 wcz
 if_b	jmp	#LR__0002
	mov	local01, local04
	mov	local02, local04
	add	local02, #1
	mov	local04, local02
	cmps	local04, #480 wcz
 if_b	jmp	#LR__0001
' repeat i from 0 to 10000
	mov	local06, #0
LR__0003
'   repeat y from 0 to 479
	mov	local04, #0
LR__0004
'     repeat x from 0 to 799
	mov	local05, #0
LR__0005
'       bytemove(buf_ptr,buf_ptr+1,384000-1)
	rdlong	local01, objptr
	rdlong	local02, objptr
	add	local02, #1
	mov	local03, local02
	mov	local07, ##383999
	mov	arg01, local01
	mov	arg02, local03
	mov	arg03, local07
	call	#__system__bytemove
	mov	local08, result1
'       putpixel8(799,479,(x+y+i)//256)
	mov	local01, ##799
	mov	local02, #479
	mov	local03, local05
	add	local03, local04
	add	local03, local06
	abs	local07, local03 wc
	and	local07, #255
 if_b	neg	local07, local07
	mov	local08, local07
	mov	arg01, local01
	mov	arg02, local02
	mov	arg03, local08
	call	#_putpixel8
	mov	local01, local05
	mov	local02, local05
	add	local02, #1
	mov	local05, local02
	cmps	local05, ##800 wcz
 if_b	jmp	#LR__0005
	mov	local01, local04
	mov	local02, local04
	add	local02, #1
	mov	local04, local02
	cmps	local04, #480 wcz
 if_b	jmp	#LR__0004
	mov	local01, local06
	mov	local02, local06
	add	local02, #1
	mov	local06, local02
	cmps	local06, ##10001 wcz
 if_b	jmp	#LR__0003
'      ' putpixel8(x,y,(x+y+i)//256)
'       'waitvbl(0)
'     
' putcharxyc8(50,50,97,40,0)    
	mov	local01, #50
	mov	local02, #50
	mov	local03, #97
	mov	local07, #40
	mov	local08, #0
	mov	arg01, local01
	mov	arg02, local02
	mov	arg03, local03
	mov	arg04, local07
	mov	arg05, local08
	call	#_putcharxyc8
' i:=cpl
	add	objptr, #148
	rdlong	local01, objptr
	sub	objptr, #148
	mov	local06, local01
' waitvbl(2400)
	mov	local01, ##2400
	mov	arg01, local01
	call	#_waitvbl
' setmode (0)
	mov	local01, #0
	mov	arg01, local01
	call	#_setmode
' writeln(inttostr(i))
	mov	local01, local06
	mov	arg01, local01
	call	#_inttostr
	mov	local02, result1
	mov	arg01, local02
	call	#_writeln
' 'cls(154,147)
' 'writeln(inttostr(xzoom))
' 'writeln(inttostr(buflen))
' 'writeln(string("Hello, World!"))
' 'writeln(string("You started the driver instead of your main program!"))
' 'writeln(string("This is an alpha 0.13 version of displaylisted driver"))
' 'writeln(inttohex(buf_ptr,8))
' 'writeln(string("This line is reversed"))
' 'writeln(string("The text above is double height, while this line is single height"))
' 'writeln(string("Did you ever see a BLUE monitor?"))
' 'repeat i from 0 to 300
'  ' write(inttohex(long[dl_ptr+4*i],8))
'   'write(string("  "))
' 'waitms(1000)
' repeat
LR__0006
	jmp	#LR__0006
	mov	ptra, fp
	call	#popregs_
_dummy_ret
	ret

'   'cogstop(cogid())
' 
' 
' 
' pub putcharxyc8(x,y,achar,f,b) |xx, yy,bb
_putcharxyc8
	mov	COUNT_, #13
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
' 
' repeat yy from 0 to 15
	mov	local06, #0
LR__0007
'   bb:=byte[@vga_font+16*achar+yy]
	mov	local07, ptr__dat__
	mov	local08, local03
	shl	local08, #4
	mov	local09, local07
	add	local09, local08
	add	local09, local06
	rdbyte	local10, local09
'   repeat xx from 0 to 7
	mov	local11, #0
LR__0008
'     if (bb&(1<<xx))<>0
	mov	local09, local10
	mov	local07, #1
	shl	local07, local11
	and	local09, local07
	cmp	local09, #0 wz
 if_e	jmp	#LR__0009
'       putpixel8(xx+x,yy+y,f)
	mov	local09, local11
	add	local09, local01
	mov	local07, local09
	mov	local08, local06
	add	local08, local02
	mov	local12, local08
	mov	local13, local04
	mov	arg01, local07
	mov	arg02, local12
	mov	arg03, local13
	call	#_putpixel8
'     else
	jmp	#LR__0010
LR__0009
'       putpixel8(xx+x,yy+y,b)     
	mov	local09, local11
	add	local09, local01
	mov	local07, local09
	mov	local08, local06
	add	local08, local02
	mov	local12, local08
	mov	local13, local05
	mov	arg01, local07
	mov	arg02, local12
	mov	arg03, local13
	call	#_putpixel8
LR__0010
	mov	local09, local11
	mov	local07, local11
	add	local07, #1
	mov	local11, local07
	cmps	local11, #8 wcz
 if_b	jmp	#LR__0008
	mov	local09, local06
	mov	local07, local06
	add	local07, #1
	mov	local06, local07
	cmps	local06, #16 wcz
 if_b	jmp	#LR__0007
	mov	ptra, fp
	call	#popregs_
_putcharxyc8_ret
	ret

' 
' 
' pub putpixel8(x,y,c)
_putpixel8
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
'  
' byte[buf_ptr+4*cpl*y+x]:=c
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	mov	_var07, _var06
	shl	_var07, #2
	qmul	_var07, _var02
	getqx	_var08
	add	_var04, _var08
	add	_var04, _var01
	wrbyte	_var03, _var04
_putpixel8_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' ' Font related functions                                                 *
' '                                                                        *
' '*************************************************************************
' 
' ''--------- Set a font offset. TODO: rremove, use byte#1 instead
' 
' pub setfontnum(afontnum)
_setfontnum
	mov	_var01, arg01
' 
' fontnum:=afontnum
	add	objptr, #164
	wrlong	_var01, objptr
	sub	objptr, #164
_setfontnum_ret
	ret

' 
' ''--------- Redefine a character
' 
' pub defchar(fn,ch,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15) :s
_defchar
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, arg04
	mov	_var05, arg05
	mov	_var06, arg06
	mov	_var07, arg07
	mov	_var08, arg08
	mov	_var09, arg09
	mov	_var10, arg10
	mov	_var11, arg11
	mov	_var12, arg12
	mov	_var13, arg13
	mov	_var14, arg14
	mov	_var15, arg15
	mov	_var16, arg16
	mov	_var17, arg17
	mov	_var18, arg18
	mov	_var19, #0
' 
' s:=@st_font+fn+ch*16
	add	ptr__dat__, ##4096
	mov	_var20, ptr__dat__
	sub	ptr__dat__, ##4096
	mov	_var21, _var20
	add	_var21, _var01
	mov	_var22, _var02
	shl	_var22, #4
	add	_var21, _var22
	mov	_var19, _var21
' byte[s+00]:=b0
	mov	_var21, _var19
	add	_var21, #0
	wrbyte	_var03, _var21
' byte[s+01]:=b1
	mov	_var21, _var19
	add	_var21, #1
	wrbyte	_var04, _var21
' byte[s+02]:=b2
	mov	_var21, _var19
	add	_var21, #2
	wrbyte	_var05, _var21
' byte[s+03]:=b3
	mov	_var21, _var19
	add	_var21, #3
	wrbyte	_var06, _var21
' byte[s+04]:=b4
	mov	_var21, _var19
	add	_var21, #4
	wrbyte	_var07, _var21
' byte[s+05]:=b5
	mov	_var21, _var19
	add	_var21, #5
	wrbyte	_var08, _var21
' byte[s+06]:=b6
	mov	_var21, _var19
	add	_var21, #6
	wrbyte	_var09, _var21
' byte[s+07]:=b7
	mov	_var21, _var19
	add	_var21, #7
	wrbyte	_var10, _var21
' byte[s+08]:=b8
	mov	_var21, _var19
	add	_var21, #8
	wrbyte	_var11, _var21
' byte[s+09]:=b9
	mov	_var21, _var19
	add	_var21, #9
	wrbyte	_var12, _var21
' byte[s+10]:=b10
	mov	_var21, _var19
	add	_var21, #10
	wrbyte	_var13, _var21
' byte[s+11]:=b11
	mov	_var21, _var19
	add	_var21, #11
	wrbyte	_var14, _var21
' byte[s+12]:=b12
	mov	_var21, _var19
	add	_var21, #12
	wrbyte	_var15, _var21
' byte[s+13]:=b13
	mov	_var21, _var19
	add	_var21, #13
	wrbyte	_var16, _var21
' byte[s+14]:=b14
	mov	_var21, _var19
	add	_var21, #14
	wrbyte	_var17, _var21
' byte[s+15]:=b15
	mov	_var21, _var19
	add	_var21, #15
	wrbyte	_var18, _var21
	mov	result1, _var19
	jmp	#_defchar_ret
_defchar_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' '  Cursor functions                                                      *
' '                                                                        *
' '*************************************************************************
' 
' pub cursoron()
_cursoron
' 
' ''---------- Switch the cursor on
' 
' cursor_sh+=16
	add	objptr, #58
	rdbyte	_var01, objptr
	sub	objptr, #58
	mov	_var02, _var01
	add	_var02, #16
	add	objptr, #58
	wrbyte	_var02, objptr
	sub	objptr, #58
_cursoron_ret
	ret

' 
' pub cursoroff()
_cursoroff
' 
' ''---------- Switch the cursor off
' 
' cursor_sh-=16
	add	objptr, #58
	rdbyte	_var01, objptr
	sub	objptr, #58
	mov	_var02, _var01
	sub	_var02, #16
	add	objptr, #58
	wrbyte	_var02, objptr
	sub	objptr, #58
_cursoroff_ret
	ret

' 
' pub setcursorpos(x,y)
_setcursorpos
	mov	_var01, arg01
	mov	_var02, arg02
' 
' ''---------- Set the (x,y) position of cursor
' 
' cursor_x:=x
	add	objptr, #56
	wrbyte	_var01, objptr
	sub	objptr, #56
' cursor_y:=y
	add	objptr, #57
	wrbyte	_var02, objptr
	sub	objptr, #57
_setcursorpos_ret
	ret

' 
' pub setcursorshape(shape)
_setcursorshape
	mov	_var01, arg01
' 
' ''---------- Define a cursor shape (0-full..15-line)
' 
' cursor_sh:=shape
	add	objptr, #58
	wrbyte	_var01, objptr
	sub	objptr, #58
_setcursorshape_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' '  VBlank functions                                                      *
' '                                                                        *
' '*************************************************************************
' 
' pub waitvbl(amount) | i
_waitvbl
	mov	COUNT_, #8
	call	#pushregs_
	mov	local01, arg01
' 
' ''---------- Wait for start of vblank. Amount=delay in frames
' 
' repeat i from 1 to amount
	mov	local02, #1
	cmps	local01, #1 wcz
 if_be	jmp	#LR__0011
	mov	local03, #1
	jmp	#LR__0012
LR__0011
	mov	local03, ##-1
LR__0012
	mov	local04, local03
	mov	local05, local01
	add	local05, local04
	mov	local06, local05
LR__0013
'   repeat until vblank==0
LR__0014
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #0 wz
 if_e	jmp	#LR__0015
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0014
LR__0015
'   repeat until vblank==1
LR__0016
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #1 wz
 if_e	jmp	#LR__0017
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0016
LR__0017
	mov	local08, local02
	add	local08, local04
	mov	local02, local08
	cmp	local02, local06 wz
 if_ne	jmp	#LR__0013
	mov	ptra, fp
	call	#popregs_
_waitvbl_ret
	ret

' 
' 
' pub waitvblend(amount) | i
_waitvblend
	mov	COUNT_, #8
	call	#pushregs_
	mov	local01, arg01
' 
' ''---------- Wait for end of vblank. Amount=delay in frames
' 
' repeat i from 1 to amount
	mov	local02, #1
	cmps	local01, #1 wcz
 if_be	jmp	#LR__0018
	mov	local03, #1
	jmp	#LR__0019
LR__0018
	mov	local03, ##-1
LR__0019
	mov	local04, local03
	mov	local05, local01
	add	local05, local04
	mov	local06, local05
LR__0020
'   repeat until vblank==1
LR__0021
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #1 wz
 if_e	jmp	#LR__0022
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0021
LR__0022
'   repeat until vblank==0
LR__0023
	add	objptr, #68
	rdlong	local07, objptr
	sub	objptr, #68
	mov	local08, local07
	cmp	local08, #0 wz
 if_e	jmp	#LR__0024
'     waitus(100)
	mov	local08, #100
	mov	arg01, local08
	call	#__system___waitus
	jmp	#LR__0023
LR__0024
	mov	local08, local02
	add	local08, local04
	mov	local02, local08
	cmp	local02, local06 wz
 if_ne	jmp	#LR__0020
	mov	ptra, fp
	call	#popregs_
_waitvblend_ret
	ret

' 
' '*************************************************************************
' '                                                                        *
' '  Color functions                                                       *
' '                                                                        *
' '*************************************************************************
' 
' ''---------- Get a VGA color code
' 
' pub getvgacolor(color):r
_getvgacolor
	mov	_var01, arg01
	mov	_var02, #0
' 
' return colors[color]
	mov	_var03, _var01
	add	objptr, #192
	mov	_var04, objptr
	sub	objptr, #192
	add	_var03, _var04
	rdbyte	result1, _var03
	jmp	#_getvgacolor_ret
_getvgacolor_ret
	ret

' 
' pub getpalettecolor(color):r
_getpalettecolor
	mov	_var01, arg01
	mov	_var02, #0
' 
' return long[@ataripalette+4*color]
	add	ptr__dat__, ##6144
	mov	_var03, ptr__dat__
	sub	ptr__dat__, ##6144
	mov	_var04, _var01
	shl	_var04, #2
	mov	_var05, _var03
	add	_var05, _var04
	rdlong	result1, _var05
	jmp	#_getpalettecolor_ret
_getpalettecolor_ret
	ret

' 
' ''---------- Set font and back colors for all screen - from 256 color palette
' 
' pub setscreencolors(ff,bb) | c ,i
_setscreencolors
	mov	_var01, arg01
	mov	_var02, arg02
' 
' c:=ff<<24+bb<<16
	mov	_var03, _var01
	shl	_var03, #24
	mov	_var04, _var02
	shl	_var04, #16
	add	_var03, _var04
	mov	_var05, _var03
' 
' repeat i from 0 to buflen-1
	mov	_var06, #0
	add	objptr, #52
	rdlong	_var04, objptr
	sub	objptr, #52
	mov	_var03, _var04
	sub	_var03, #1
	mov	_var07, _var03
	cmps	_var07, #0 wcz
 if_be	jmp	#LR__0025
	mov	_var08, #1
	jmp	#LR__0026
LR__0025
	mov	_var08, ##-1
LR__0026
	mov	_var09, _var08
	mov	_var10, _var07
	add	_var10, _var09
	mov	_var07, _var10
LR__0027
'    long[buf_ptr+4*i]:= (long[buf_ptr+4*i] & $FFFF) |  c
	rdlong	_var11, objptr
	mov	_var12, _var06
	shl	_var12, #2
	add	_var11, _var12
	rdlong	_var13, _var11
	and	_var13, ##65535
	or	_var13, _var05
	rdlong	_var14, objptr
	mov	_var15, _var06
	shl	_var15, #2
	add	_var14, _var15
	wrlong	_var13, _var14
LR__0028
	mov	_var13, _var06
	add	_var13, _var09
	mov	_var06, _var13
	cmp	_var06, _var07 wz
 if_ne	jmp	#LR__0027
LR__0029
_setscreencolors_ret
	ret

' 
' ''---------- Set the color for the character at line y and position x
' 
' pub setcharcolor(x,y,c) | place, color
_setcharcolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' place:=(x)+(y*cpl)
	mov	_var04, _var01
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	qmul	_var02, _var06
	getqx	_var07
	add	_var04, _var07
	mov	_var08, _var04
' 
' if (place>buflen-1)
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	cmps	_var08, _var04 wcz
 if_be	jmp	#LR__0030
'   place:=buflen-1
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	mov	_var08, _var04
LR__0030
' 
' color:=(long[buf_ptr+4*place] &$FFFFFF) | (c<<24)
	rdlong	_var07, objptr
	mov	_var06, _var08
	shl	_var06, #2
	add	_var07, _var06
	rdlong	_var04, _var07
	and	_var04, ##16777215
	mov	_var05, _var03
	shl	_var05, #24
	or	_var04, _var05
	mov	_var09, _var04
' long[buf_ptr+4*place]:=color
	rdlong	_var04, objptr
	mov	_var07, _var08
	shl	_var07, #2
	add	_var04, _var07
	wrlong	_var09, _var04
_setcharcolor_ret
	ret

' 
' ''---------- Set the background color at line y and position x
' 
' pub setbackcolor(x,y,c) | place, color
_setbackcolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' place:=(x)+(y*cpl)
	mov	_var04, _var01
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	qmul	_var02, _var06
	getqx	_var07
	add	_var04, _var07
	mov	_var08, _var04
' 
' if (place>buflen-1)
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	cmps	_var08, _var04 wcz
 if_be	jmp	#LR__0031
'   place:=buflen-1
	add	objptr, #52
	rdlong	_var07, objptr
	sub	objptr, #52
	mov	_var04, _var07
	sub	_var04, #1
	mov	_var08, _var04
LR__0031
' 
' color:=(long[buf_ptr+4*place] &$FF00FFFF) | (c<<16)
	rdlong	_var07, objptr
	mov	_var06, _var08
	shl	_var06, #2
	add	_var07, _var06
	rdlong	_var04, _var07
	and	_var04, ##-16711681
	mov	_var05, _var03
	shl	_var05, #16
	or	_var04, _var05
	mov	_var09, _var04
' long[buf_ptr+4*place]:=color
	rdlong	_var04, objptr
	mov	_var07, _var08
	shl	_var07, #2
	add	_var04, _var07
	wrlong	_var09, _var04
_setbackcolor_ret
	ret

' 
' ''---------- Set the border color, o is upper border, lines+1 is lower border
' 
' pub setbordercolor(r,g,b) | color
_setbordercolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' color:=r<<24+g<<16+b<<8
	mov	_var04, _var01
	shl	_var04, #24
	mov	_var05, _var02
	shl	_var05, #16
	add	_var04, _var05
	mov	_var06, _var03
	shl	_var06, #8
	add	_var04, _var06
	mov	_var07, _var04
' bordercolor:=color
	add	objptr, #48
	wrlong	_var07, objptr
	sub	objptr, #48
_setbordercolor_ret
	ret

' 
' ''---------- Set colors for putchar, write and writeln
' 
' pub setwritecolors(ff,bb)
_setwritecolors
	mov	_var01, arg01
	mov	_var02, arg02
' 
' 
' write_color:=ff
	add	objptr, #60
	wrlong	_var01, objptr
	sub	objptr, #60
' write_background:=bb
	add	objptr, #64
	wrlong	_var02, objptr
	sub	objptr, #64
_setwritecolors_ret
	ret

' 
' ''---------- Set color #c in palette to r,g,b
' 
' pub setcolor(c,r,g,b)  |cc
_setcolor
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, arg04
' 
' cc:=r<<24+g<<16+b<<8
	mov	_var05, _var02
	shl	_var05, #24
	mov	_var06, _var03
	shl	_var06, #16
	add	_var05, _var06
	mov	_var07, _var04
	shl	_var07, #8
	add	_var05, _var07
	mov	_var08, _var05
' cmd2:=cc
	add	objptr, #160
	wrlong	_var08, objptr
	sub	objptr, #160
' cmd1:=c
	add	objptr, #156
	wrlong	_var01, objptr
	sub	objptr, #156
' repeat until cmd1==257
LR__0032
	add	objptr, #156
	rdlong	_var06, objptr
	sub	objptr, #156
	mov	_var05, _var06
	cmp	_var05, #257 wz
 if_e	jmp	#LR__0033
	jmp	#LR__0032
LR__0033
_setcolor_ret
	ret

' 
' 
' '*************************************************************************
' '                                                                        *
' '  Text functions                                                        *
' '                                                                        *
' '*************************************************************************
' 
' ''---------- Clear the screen, set its foreground/background color
' 
' pub cls(fc,bc)   :c
_cls
	mov	COUNT_, #7
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, #0
' 
' if (graphmode<512)
	add	objptr, #208
	rdlong	local04, objptr
	sub	objptr, #208
	mov	local05, local04
	cmps	local05, ##512 wcz
 if_ae	jmp	#LR__0034
'   c:=fc<<24+bc<<16+$20
	mov	local05, local01
	shl	local05, #24
	mov	local04, local02
	shl	local04, #16
	add	local05, local04
	add	local05, #32
	mov	local03, local05
' else
	jmp	#LR__0035
LR__0034
'   c:=bc
	mov	local03, local02
LR__0035
' longfill(buf_ptr,c,buflen)
	rdlong	local05, objptr
	mov	local04, local03
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local07, local06
	mov	arg01, local05
	mov	arg02, local04
	mov	arg03, local07
	call	#__system__longfill
' setwritecolors(fc,bc)
	mov	local05, local01
	mov	local04, local02
	mov	arg01, local05
	mov	arg02, local04
	call	#_setwritecolors
' cursor_x:=0
	mov	local05, #0
	add	objptr, #56
	wrbyte	local05, objptr
	sub	objptr, #56
' cursor_y:=0
	mov	local05, #0
	add	objptr, #57
	wrbyte	local05, objptr
	sub	objptr, #57
	mov	result1, local03
	jmp	#LR__0036
LR__0036
	mov	ptra, fp
	call	#popregs_
_cls_ret
	ret

' 
' ''---------- Output a char at x,y, don't change colors and cursor position
' 
' pub putcharxy(x,y,achar) | c
_putcharxy
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
' 
' long[buf_ptr+4*(cpl*y+x)]:=(long[buf_ptr+4*(cpl*y+x)] & $FFFFFF00)  |(achar & $000000FF)
	rdlong	_var04, objptr
	add	objptr, #148
	rdlong	_var05, objptr
	sub	objptr, #148
	mov	_var06, _var05
	qmul	_var06, _var02
	getqx	_var07
	mov	_var08, _var07
	add	_var08, _var01
	mov	_var09, _var08
	shl	_var09, #2
	add	_var04, _var09
	rdlong	_var10, _var04
	and	_var10, ##-256
	mov	_var11, _var03
	and	_var11, #255
	or	_var10, _var11
	rdlong	_var12, objptr
	add	objptr, #148
	rdlong	_var13, objptr
	sub	objptr, #148
	mov	_var14, _var13
	qmul	_var14, _var02
	getqx	_var15
	mov	_var16, _var15
	add	_var16, _var01
	mov	_var17, _var16
	shl	_var17, #2
	add	_var12, _var17
	wrlong	_var10, _var12
_putcharxy_ret
	ret

' 
' ''---------- Output a char at x,y and colors f,b, don't change a cursor position
' 
' pub putcharxyc(x,y,achar,f,b) | c
_putcharxyc
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, arg04
	mov	_var05, arg05
' 
' c:=f<<24+b<<16
	mov	_var06, _var04
	shl	_var06, #24
	mov	_var07, _var05
	shl	_var07, #16
	add	_var06, _var07
	mov	_var08, _var06
' long[buf_ptr+4*(cpl*y+x)]:=long[buf_ptr+4*(cpl*y+x)] &$FFFF | c
	rdlong	_var07, objptr
	add	objptr, #148
	rdlong	_var09, objptr
	sub	objptr, #148
	mov	_var10, _var09
	qmul	_var10, _var02
	getqx	_var11
	mov	_var12, _var11
	add	_var12, _var01
	mov	_var13, _var12
	shl	_var13, #2
	add	_var07, _var13
	rdlong	_var06, _var07
	and	_var06, ##65535
	or	_var06, _var08
	rdlong	_var14, objptr
	add	objptr, #148
	rdlong	_var15, objptr
	sub	objptr, #148
	mov	_var16, _var15
	qmul	_var16, _var02
	getqx	_var17
	mov	_var18, _var17
	add	_var18, _var01
	mov	_var19, _var18
	shl	_var19, #2
	add	_var14, _var19
	wrlong	_var06, _var14
' long[buf_ptr+4*(cpl*y+x)]:=(long[buf_ptr+4*(cpl*y+x)] & $FFFFFF00)  |(achar & $000000FF)
	rdlong	_var07, objptr
	add	objptr, #148
	rdlong	_var09, objptr
	sub	objptr, #148
	mov	_var10, _var09
	qmul	_var10, _var02
	getqx	_var11
	mov	_var12, _var11
	add	_var12, _var01
	mov	_var13, _var12
	shl	_var13, #2
	add	_var07, _var13
	rdlong	_var06, _var07
	and	_var06, ##-256
	mov	_var14, _var03
	and	_var14, #255
	or	_var06, _var14
	rdlong	_var18, objptr
	add	objptr, #148
	rdlong	_var19, objptr
	sub	objptr, #148
	mov	_var15, _var19
	qmul	_var15, _var02
	getqx	_var16
	mov	_var17, _var16
	add	_var17, _var01
	mov	_var20, _var17
	shl	_var20, #2
	add	_var18, _var20
	wrlong	_var06, _var18
_putcharxyc_ret
	ret

' 
' ''--------- Output a string at position x,y without changing colors
' 
' pub outtextxy(x,y,text) | iii
_outtextxy
	mov	COUNT_, #26
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
' 
' repeat iii from 0 to strsize(text)-1
	mov	local04, #0
	mov	local05, local03
	mov	arg01, local05
	call	#__system____builtin_strlen
	mov	local06, result1
	mov	local07, local06
	sub	local07, #1
	mov	local08, local07
	cmps	local08, #0 wcz
 if_be	jmp	#LR__0037
	mov	local09, #1
	jmp	#LR__0038
LR__0037
	mov	local09, ##-1
LR__0038
	mov	local10, local09
	mov	local11, local08
	add	local11, local10
	mov	local08, local11
LR__0039
'   long[buf_ptr+4*(cpl*y+x+iii)]:=(long[buf_ptr+4*(cpl*y+x+iii)] & $FFFFFF00)  | byte[text+iii]
	rdlong	local12, objptr
	add	objptr, #148
	rdlong	local13, objptr
	sub	objptr, #148
	mov	local14, local13
	qmul	local14, local02
	getqx	local15
	mov	local16, local15
	add	local16, local01
	add	local16, local04
	mov	local17, local16
	shl	local17, #2
	add	local12, local17
	rdlong	local18, local12
	and	local18, ##-256
	mov	local19, local03
	add	local19, local04
	rdbyte	local20, local19
	or	local18, local20
	rdlong	local21, objptr
	add	objptr, #148
	rdlong	local22, objptr
	sub	objptr, #148
	mov	local23, local22
	qmul	local23, local02
	getqx	local24
	mov	local25, local24
	add	local25, local01
	add	local25, local04
	mov	local26, local25
	shl	local26, #2
	add	local21, local26
	wrlong	local18, local21
	mov	local18, local04
	add	local18, local10
	mov	local04, local18
	cmp	local04, local08 wz
 if_ne	jmp	#LR__0039
	mov	ptra, fp
	call	#popregs_
_outtextxy_ret
	ret

' 
' 
' ''--------- Output a string at position x,y and colors b,f
' 
' pub outtextxyc(x,y,text,f,b) | iii,c
_outtextxyc
	mov	COUNT_, #29
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, arg03
	mov	local04, arg04
	mov	local05, arg05
' 
' c:=f<<24+b<<16
	mov	local06, local04
	shl	local06, #24
	mov	local07, local05
	shl	local07, #16
	add	local06, local07
	mov	local08, local06
' repeat iii from 0 to strsize(text)-1
	mov	local09, #0
	mov	local07, local03
	mov	arg01, local07
	call	#__system____builtin_strlen
	mov	local10, result1
	mov	local06, local10
	sub	local06, #1
	mov	local11, local06
	cmps	local11, #0 wcz
 if_be	jmp	#LR__0040
	mov	local12, #1
	jmp	#LR__0041
LR__0040
	mov	local12, ##-1
LR__0041
	mov	local13, local12
	mov	local14, local11
	add	local14, local13
	mov	local11, local14
LR__0042
'   long[buf_ptr+4*(cpl*y+x+iii)]:=(long[buf_ptr+4*(cpl*y+x+iii)] & $FFFFFF00)  | byte[text+iii]
	rdlong	local15, objptr
	add	objptr, #148
	rdlong	local16, objptr
	sub	objptr, #148
	mov	local17, local16
	qmul	local17, local02
	getqx	local18
	mov	local19, local18
	add	local19, local01
	add	local19, local09
	mov	local20, local19
	shl	local20, #2
	add	local15, local20
	rdlong	local21, local15
	and	local21, ##-256
	mov	local22, local03
	add	local22, local09
	rdbyte	local23, local22
	or	local21, local23
	rdlong	local24, objptr
	add	objptr, #148
	rdlong	local25, objptr
	sub	objptr, #148
	mov	local26, local25
	qmul	local26, local02
	getqx	local27
	mov	local28, local27
	add	local28, local01
	add	local28, local09
	mov	local29, local28
	shl	local29, #2
	add	local24, local29
	wrlong	local21, local24
'   long[buf_ptr+4*(cpl*y+x+iii)]:=(long[buf_ptr+4*(cpl*y+x+iii)] & $0000FFFF)  | c
	rdlong	local15, objptr
	add	objptr, #148
	rdlong	local16, objptr
	sub	objptr, #148
	mov	local17, local16
	qmul	local17, local02
	getqx	local18
	mov	local19, local18
	add	local19, local01
	add	local19, local09
	mov	local20, local19
	shl	local20, #2
	add	local15, local20
	rdlong	local21, local15
	and	local21, ##65535
	or	local21, local08
	rdlong	local22, objptr
	add	objptr, #148
	rdlong	local27, objptr
	sub	objptr, #148
	mov	local28, local27
	qmul	local28, local02
	getqx	local24
	mov	local23, local24
	add	local23, local01
	add	local23, local09
	mov	local26, local23
	shl	local26, #2
	add	local22, local26
	wrlong	local21, local22
	mov	local21, local09
	add	local21, local13
	mov	local09, local21
	cmp	local09, local11 wz
 if_ne	jmp	#LR__0042
	mov	ptra, fp
	call	#popregs_
_outtextxyc_ret
	ret

' 
' ''---------- Output a char at the cursor position, move the cursor
' 
' pub putchar(achar) | c,x,y
_putchar
	mov	COUNT_, #18
	call	#pushregs_
	mov	local01, arg01
' 
' x:=cursor_x
	add	objptr, #56
	rdbyte	local02, objptr
	sub	objptr, #56
	mov	local03, local02
' y:=cursor_y
	add	objptr, #57
	rdbyte	local02, objptr
	sub	objptr, #57
	mov	local04, local02
' c:=write_color<<24+write_background<<16
	add	objptr, #60
	rdlong	local05, objptr
	sub	objptr, #60
	mov	local02, local05
	shl	local02, #24
	add	objptr, #64
	rdlong	local06, objptr
	sub	objptr, #64
	mov	local07, local06
	shl	local07, #16
	add	local02, local07
	mov	local08, local02
' long[buf_ptr+4*(cpl*y+x)]:=long[buf_ptr+4*(cpl*y+x)] &$FFFF | c
	rdlong	local05, objptr
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	qmul	local10, local04
	getqx	local06
	mov	local07, local06
	add	local07, local03
	mov	local11, local07
	shl	local11, #2
	add	local05, local11
	rdlong	local02, local05
	and	local02, ##65535
	or	local02, local08
	rdlong	local12, objptr
	add	objptr, #148
	rdlong	local13, objptr
	sub	objptr, #148
	mov	local14, local13
	qmul	local14, local04
	getqx	local15
	mov	local16, local15
	add	local16, local03
	mov	local17, local16
	shl	local17, #2
	add	local12, local17
	wrlong	local02, local12
' long[buf_ptr+4*(cpl*y+x)]:=(long[buf_ptr+4*(cpl*y+x)] & $FFFFFF00)  |(achar & $000000FF)
	rdlong	local05, objptr
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	qmul	local10, local04
	getqx	local06
	mov	local07, local06
	add	local07, local03
	mov	local11, local07
	shl	local11, #2
	add	local05, local11
	rdlong	local02, local05
	and	local02, ##-256
	mov	local12, local01
	and	local12, #255
	or	local02, local12
	rdlong	local16, objptr
	add	objptr, #148
	rdlong	local17, objptr
	sub	objptr, #148
	mov	local13, local17
	qmul	local13, local04
	getqx	local14
	mov	local15, local14
	add	local15, local03
	mov	local18, local15
	shl	local18, #2
	add	local16, local18
	wrlong	local02, local16
' cursor_x+=1
	add	objptr, #56
	rdbyte	local05, objptr
	sub	objptr, #56
	mov	local02, local05
	add	local02, #1
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
' if cursor_x==cpl
	add	objptr, #56
	rdbyte	local05, objptr
	sub	objptr, #56
	mov	local02, local05
	add	objptr, #148
	rdlong	local06, objptr
	sub	objptr, #148
	mov	local07, local06
	cmp	local02, local07 wz
 if_ne	jmp	#LR__0044
'   cursor_x:=0
	mov	local02, #0
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
'   cursor_y+=1
	add	objptr, #57
	rdbyte	local05, objptr
	sub	objptr, #57
	mov	local02, local05
	add	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
'   if cursor_y>lines-1
	add	objptr, #152
	rdlong	local05, objptr
	sub	objptr, #152
	mov	local02, local05
	sub	local02, #1
	add	objptr, #57
	rdbyte	local06, objptr
	sub	objptr, #57
	mov	local07, local06
	cmps	local07, local02 wcz
 if_be	jmp	#LR__0043
'     scrollup()
	call	#_scrollup
'     cursor_y:=lines-1
	add	objptr, #152
	rdlong	local05, objptr
	sub	objptr, #152
	mov	local02, local05
	sub	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
LR__0043
LR__0044
	mov	ptra, fp
	call	#popregs_
_putchar_ret
	ret

' 
' ''--------- Output a string at the cursor position, move the cursor
' 
' pub write(text) | iii,c,ncx,ncy
_write
	mov	COUNT_, #33
	call	#pushregs_
	mov	local01, arg01
' 
' c:=write_color<<24+write_background<<16
	add	objptr, #60
	rdlong	local02, objptr
	sub	objptr, #60
	mov	local03, local02
	shl	local03, #24
	add	objptr, #64
	rdlong	local04, objptr
	sub	objptr, #64
	mov	local05, local04
	shl	local05, #16
	add	local03, local05
	mov	local06, local03
' 'debug(uhex_long(write_color))
' ncy:=cursor_y
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local07, local03
' ncx:=cursor_x+strsize(text)
	add	objptr, #56
	rdbyte	local02, objptr
	sub	objptr, #56
	mov	local03, local02
	mov	local05, local01
	mov	arg01, local05
	call	#__system____builtin_strlen
	mov	local04, result1
	add	local03, local04
	mov	local08, local03
' repeat while ncx>cpl-1
LR__0045
	add	objptr, #148
	rdlong	local02, objptr
	sub	objptr, #148
	mov	local03, local02
	sub	local03, #1
	cmps	local08, local03 wcz
 if_be	jmp	#LR__0046
'   ncx-=cpl
	mov	local03, local08
	add	objptr, #148
	rdlong	local05, objptr
	sub	objptr, #148
	mov	local02, local05
	sub	local03, local02
	mov	local08, local03
'   ncy+=1
	mov	local03, local07
	add	local03, #1
	mov	local07, local03
	jmp	#LR__0045
LR__0046
' repeat while ncy>lines-1
LR__0047
	add	objptr, #152
	rdlong	local02, objptr
	sub	objptr, #152
	mov	local03, local02
	sub	local03, #1
	cmps	local07, local03 wcz
 if_be	jmp	#LR__0048
'   ncy-=1
	mov	local03, local07
	sub	local03, #1
	mov	local07, local03
'   scrollup()
	call	#_scrollup
'   cursor_y-=1
	add	objptr, #57
	rdbyte	local02, objptr
	sub	objptr, #57
	mov	local03, local02
	sub	local03, #1
	add	objptr, #57
	wrbyte	local03, objptr
	sub	objptr, #57
	jmp	#LR__0047
LR__0048
' 
' repeat iii from 0 to strsize(text)-1
	mov	local09, #0
	mov	local02, local01
	mov	arg01, local02
	call	#__system____builtin_strlen
	mov	local05, result1
	mov	local03, local05
	sub	local03, #1
	mov	local10, local03
	cmps	local10, #0 wcz
 if_be	jmp	#LR__0049
	mov	local04, #1
	jmp	#LR__0050
LR__0049
	mov	local04, ##-1
LR__0050
	mov	local11, local04
	mov	local12, local10
	add	local12, local11
	mov	local10, local12
LR__0051
' 
'   long[buf_ptr+4*(cpl*cursor_y+cursor_x+iii)]:=long[buf_ptr+4*(cpl*cursor_y+cursor_x+iii)] &$FFFF | c
	rdlong	local13, objptr
	add	objptr, #148
	rdlong	local14, objptr
	sub	objptr, #148
	mov	local15, local14
	add	objptr, #57
	rdbyte	local16, objptr
	sub	objptr, #57
	mov	local17, local16
	qmul	local15, local17
	getqx	local18
	mov	local19, local18
	add	objptr, #56
	rdbyte	local20, objptr
	sub	objptr, #56
	mov	local21, local20
	add	local19, local21
	add	local19, local09
	mov	local22, local19
	shl	local22, #2
	add	local13, local22
	rdlong	local23, local13
	and	local23, ##65535
	or	local23, local06
	rdlong	local24, objptr
	add	objptr, #148
	rdlong	local25, objptr
	sub	objptr, #148
	mov	local26, local25
	add	objptr, #57
	rdbyte	local27, objptr
	sub	objptr, #57
	mov	local28, local27
	qmul	local26, local28
	getqx	local29
	mov	local30, local29
	add	objptr, #56
	rdbyte	local31, objptr
	sub	objptr, #56
	mov	local32, local31
	add	local30, local32
	add	local30, local09
	mov	local33, local30
	shl	local33, #2
	add	local24, local33
	wrlong	local23, local24
	mov	local23, local09
	add	local23, local11
	mov	local09, local23
	cmp	local09, local10 wz
 if_ne	jmp	#LR__0051
' 
' outtextxy(cursor_x,cursor_y,text)
	add	objptr, #56
	rdbyte	local02, objptr
	sub	objptr, #56
	mov	local03, local02
	add	objptr, #57
	rdbyte	local04, objptr
	sub	objptr, #57
	mov	local05, local04
	mov	local12, local01
	mov	arg01, local03
	mov	arg02, local05
	mov	arg03, local12
	call	#_outtextxy
' 
' cursor_x:=ncx
	add	objptr, #56
	wrbyte	local08, objptr
	sub	objptr, #56
' cursor_y:=ncy
	add	objptr, #57
	wrbyte	local07, objptr
	sub	objptr, #57
	mov	ptra, fp
	call	#popregs_
_write_ret
	ret

' 
' '--------- Output a string at the cursor position x,y, move the cursor to the next line
' 
' pub writeln(text)
_writeln
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
' 
' write(text)
	mov	local02, local01
	mov	arg01, local02
	call	#_write
' cursor_x:=0
	mov	local02, #0
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
' cursor_y+=1
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local02, local03
	add	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
' if (cursor_y>lines-1)
	add	objptr, #152
	rdlong	local03, objptr
	sub	objptr, #152
	mov	local02, local03
	sub	local02, #1
	add	objptr, #57
	rdbyte	local04, objptr
	sub	objptr, #57
	mov	local05, local04
	cmps	local05, local02 wcz
 if_be	jmp	#LR__0052
'   scrollup()
	call	#_scrollup
'   cursor_y:=lines-1
	add	objptr, #152
	rdlong	local03, objptr
	sub	objptr, #152
	mov	local02, local03
	sub	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
LR__0052
	mov	ptra, fp
	call	#popregs_
_writeln_ret
	ret

' 
' ''-----------  Scroll the screen one line up
' 
' pub scrollup() | i
_scrollup
	mov	COUNT_, #20
	call	#pushregs_
' 
' longmove(buf_ptr,buf_ptr+4*cpl,buflen-cpl)
	rdlong	local01, objptr
	rdlong	local02, objptr
	add	objptr, #148
	rdlong	local03, objptr
	sub	objptr, #148
	mov	local04, local03
	mov	local05, local04
	shl	local05, #2
	add	local02, local05
	mov	local06, local02
	add	objptr, #52
	rdlong	local07, objptr
	sub	objptr, #52
	mov	local08, local07
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	sub	local08, local10
	mov	local11, local08
	mov	arg01, local01
	mov	arg02, local06
	mov	arg03, local11
	call	#__system__longmove
	mov	local12, result1
' repeat i from buflen-cpl to buflen-1
	add	objptr, #52
	rdlong	local02, objptr
	sub	objptr, #52
	mov	local01, local02
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	local05, local04
	sub	local01, local05
	mov	local13, local01
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local03, local06
	sub	local03, #1
	mov	local14, local03
	add	objptr, #52
	rdlong	local10, objptr
	sub	objptr, #52
	mov	local07, local10
	add	objptr, #148
	rdlong	local11, objptr
	sub	objptr, #148
	mov	local09, local11
	sub	local07, local09
	cmps	local14, local07 wcz
 if_be	jmp	#LR__0053
	mov	local08, #1
	jmp	#LR__0054
LR__0053
	mov	local08, ##-1
LR__0054
	mov	local15, local08
	mov	local12, local14
	add	local12, local15
	mov	local14, local12
LR__0055
'   long[buf_ptr+4*i]:=(long[buf_ptr+4*i] & $FFFF0000) | 32
	rdlong	local16, objptr
	mov	local17, local13
	shl	local17, #2
	add	local16, local17
	rdlong	local18, local16
	and	local18, ##-65536
	or	local18, #32
	rdlong	local19, objptr
	mov	local20, local13
	shl	local20, #2
	add	local19, local20
	wrlong	local18, local19
	mov	local18, local13
	add	local18, local15
	mov	local13, local18
	cmp	local13, local14 wz
 if_ne	jmp	#LR__0055
	mov	ptra, fp
	call	#popregs_
_scrollup_ret
	ret

' 
' ''----------- Scroll the screen one line down
' 
' pub scrolldown() | i
_scrolldown
	mov	COUNT_, #15
	call	#pushregs_
' 
' longmove(buf_ptr+cpl*4,buf_ptr,buflen-cpl)
	rdlong	local01, objptr
	add	objptr, #148
	rdlong	local02, objptr
	sub	objptr, #148
	mov	local03, local02
	mov	local04, local03
	shl	local04, #2
	add	local01, local04
	mov	local05, local01
	rdlong	local06, objptr
	add	objptr, #52
	rdlong	local07, objptr
	sub	objptr, #52
	mov	local08, local07
	add	objptr, #148
	rdlong	local09, objptr
	sub	objptr, #148
	mov	local10, local09
	sub	local08, local10
	mov	local11, local08
	mov	arg01, local05
	mov	arg02, local06
	mov	arg03, local11
	call	#__system__longmove
	mov	local12, result1
' repeat i from 0 to cpl-1
	mov	local13, #0
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	local01, local04
	sub	local01, #1
	mov	local14, local01
	cmps	local14, #0 wcz
 if_be	jmp	#LR__0056
	mov	local03, #1
	jmp	#LR__0057
LR__0056
	mov	local03, ##-1
LR__0057
	mov	local15, local03
	mov	local02, local14
	add	local02, local15
	mov	local14, local02
LR__0058
'   long[buf_ptr+4*i]:=(long[buf_ptr+4*i] & $FFFF0000) | 32
	rdlong	local06, objptr
	mov	local08, local13
	shl	local08, #2
	add	local06, local08
	rdlong	local05, local06
	and	local05, ##-65536
	or	local05, #32
	rdlong	local07, objptr
	mov	local10, local13
	shl	local10, #2
	add	local07, local10
	wrlong	local05, local07
	mov	local05, local13
	add	local05, local15
	mov	local13, local05
	cmp	local13, local14 wz
 if_ne	jmp	#LR__0058
	mov	ptra, fp
	call	#popregs_
_scrolldown_ret
	ret

' 
' ''----------- Set cursor at the first character in a new line, scroll if needed
' 
' pub crlf()
_crlf
	mov	COUNT_, #4
	call	#pushregs_
' 
' cursor_x:=0
	mov	local01, #0
	add	objptr, #56
	wrbyte	local01, objptr
	sub	objptr, #56
' cursor_y+=1
	add	objptr, #57
	rdbyte	local02, objptr
	sub	objptr, #57
	mov	local01, local02
	add	local01, #1
	add	objptr, #57
	wrbyte	local01, objptr
	sub	objptr, #57
' if cursor_y>lines-1
	add	objptr, #152
	rdlong	local02, objptr
	sub	objptr, #152
	mov	local01, local02
	sub	local01, #1
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local04, local03
	cmps	local04, local01 wcz
 if_be	jmp	#LR__0059
'   scrollup()
	call	#_scrollup
'   cursor_y:=lines-1
	add	objptr, #152
	rdlong	local02, objptr
	sub	objptr, #152
	mov	local01, local02
	sub	local01, #1
	add	objptr, #57
	wrbyte	local01, objptr
	sub	objptr, #57
LR__0059
	mov	ptra, fp
	call	#popregs_
_crlf_ret
	ret

' 
' ''---------- Backspace. Move the cursor back, clear a character
' 
' pub bksp()
_bksp
	mov	COUNT_, #6
	call	#pushregs_
' 
' cursor_x-=1
	add	objptr, #56
	rdbyte	local01, objptr
	sub	objptr, #56
	mov	local02, local01
	sub	local02, #1
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
' if cursor_x==255
	add	objptr, #56
	rdbyte	local01, objptr
	sub	objptr, #56
	mov	local02, local01
	cmp	local02, #255 wz
 if_ne	jmp	#LR__0061
'   cursor_x:=cpl-1
	add	objptr, #148
	rdlong	local01, objptr
	sub	objptr, #148
	mov	local02, local01
	sub	local02, #1
	add	objptr, #56
	wrbyte	local02, objptr
	sub	objptr, #56
'   cursor_y-=1
	add	objptr, #57
	rdbyte	local01, objptr
	sub	objptr, #57
	mov	local02, local01
	sub	local02, #1
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
'   if cursor_y==255
	add	objptr, #57
	rdbyte	local01, objptr
	sub	objptr, #57
	mov	local02, local01
	cmp	local02, #255 wz
 if_ne	jmp	#LR__0060
'     cursor_y:=0
	mov	local02, #0
	add	objptr, #57
	wrbyte	local02, objptr
	sub	objptr, #57
'     scrollup()
	call	#_scrollup
LR__0060
LR__0061
' 
' outtextxy(cursor_x,cursor_y,string(" "))
	add	objptr, #56
	rdbyte	local01, objptr
	sub	objptr, #56
	mov	local02, local01
	add	objptr, #57
	rdbyte	local03, objptr
	sub	objptr, #57
	mov	local04, local03
	mov	local05, ##@LR__0173
	mov	local06, local05
	mov	arg01, local02
	mov	arg02, local04
	mov	arg03, local06
	call	#_outtextxy
	mov	ptra, fp
	call	#popregs_
_bksp_ret
	ret

' 
' 
' '*************************************************************************
' '                                                                        *
' '  Conversions                                                           *
' '                                                                        *
' '*************************************************************************
' 
' ''---------- Convert a integer to dec string, return a pointer
' 
' pub inttostr(i):result |q,pos,k,j
_inttostr
	mov	COUNT_, #13
	call	#pushregs_
	mov	local01, arg01
	mov	local02, #0
' 
' j:=i
	mov	local03, local01
' pos:=10
	mov	local04, #10
' k:=0
	mov	local05, #0
' 
' if (j==0)
	cmp	local03, #0 wz
 if_ne	jmp	#LR__0062
'   n_string[0]:=48
	mov	local06, #48
	add	objptr, #72
	wrbyte	local06, objptr
	sub	objptr, #72
'   n_string[1]:=0
	mov	local06, #0
	add	objptr, #73
	wrbyte	local06, objptr
	sub	objptr, #73
' 
' else
	jmp	#LR__0069
LR__0062
'   if (j<0)
	cmps	local03, #0 wcz
 if_ae	jmp	#LR__0063
'     j:=0-j
	mov	local06, #0
	sub	local06, local03
	mov	local03, local06
'     k:=45
	mov	local05, #45
LR__0063
' 
'   n_string[11]:=0
	mov	local06, #0
	add	objptr, #83
	wrbyte	local06, objptr
	sub	objptr, #83
'   repeat while (pos>-1)
LR__0064
	cmps	local04, ##-1 wcz
 if_be	jmp	#LR__0065
'     q:=j//10
	mov	muldiva_, local03
	mov	muldivb_, #10
	call	#divide_
	mov	local06, muldiva_
	mov	local07, local06
'     q:=48+q
	mov	local06, #48
	add	local06, local07
	mov	local07, local06
'     n_string[pos]:=q
	mov	local06, local04
	add	objptr, #72
	mov	local08, objptr
	sub	objptr, #72
	add	local06, local08
	wrbyte	local07, local06
'     j:=j/10
	mov	local06, muldivb_
	mov	local03, local06
'     pos-=1
	mov	local06, local04
	sub	local06, #1
	mov	local04, local06
	jmp	#LR__0064
LR__0065
'   repeat while n_string[0]==48
LR__0066
	add	objptr, #72
	rdbyte	local08, objptr
	sub	objptr, #72
	mov	local06, local08
	cmp	local06, #48 wz
 if_ne	jmp	#LR__0067
'     bytemove(@n_string,@n_string+1,12)
	add	objptr, #72
	mov	local06, objptr
	sub	objptr, #72
	mov	local08, local06
	add	objptr, #72
	mov	local09, objptr
	sub	objptr, #72
	mov	local10, local09
	add	local10, #1
	mov	local11, local10
	mov	local12, #12
	mov	arg01, local08
	mov	arg02, local11
	mov	arg03, local12
	call	#__system__bytemove
	mov	local13, result1
	jmp	#LR__0066
LR__0067
' 
'   if k==45
	cmp	local05, #45 wz
 if_ne	jmp	#LR__0068
'      bytemove(@n_string+1,@n_string,12)
	add	objptr, #72
	mov	local08, objptr
	sub	objptr, #72
	mov	local06, local08
	add	local06, #1
	mov	local10, local06
	add	objptr, #72
	mov	local09, objptr
	sub	objptr, #72
	mov	local11, local09
	mov	local12, #12
	mov	arg01, local10
	mov	arg02, local11
	mov	arg03, local12
	call	#__system__bytemove
	mov	local13, result1
'      n_string[0]:=k
	add	objptr, #72
	wrbyte	local05, objptr
	sub	objptr, #72
LR__0068
LR__0069
' 
' q:=@n_string
	add	objptr, #72
	mov	local06, objptr
	sub	objptr, #72
	mov	local07, local06
' return q
	mov	result1, local07
	jmp	#LR__0070
LR__0070
	mov	ptra, fp
	call	#popregs_
_inttostr_ret
	ret

' 
' ''----------  Convert unsigned integer to hex string with d digits, return a pointer
' 
' pub inttohex(i,d):result |q,pos,k,j
_inttohex
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, #0
' 
' j:=i
	mov	_var04, _var01
' pos:=d-1
	mov	_var05, _var02
	sub	_var05, #1
	mov	_var06, _var05
' k:=0
	mov	_var07, #0
' n_string[d]:=0
	mov	_var05, _var02
	add	objptr, #72
	mov	_var08, objptr
	sub	objptr, #72
	add	_var05, _var08
	mov	_var09, #0
	wrbyte	_var09, _var05
' repeat k from 0 to d-1
	mov	_var07, #0
	mov	_var05, _var02
	sub	_var05, #1
	mov	_var10, _var05
	cmps	_var10, #0 wcz
 if_be	jmp	#LR__0071
	mov	_var08, #1
	jmp	#LR__0072
LR__0071
	mov	_var08, ##-1
LR__0072
	mov	_var11, _var08
	mov	_var09, _var10
	add	_var09, _var11
	mov	_var10, _var09
LR__0073
'   n_string[k]:=48
	mov	_var12, _var07
	add	objptr, #72
	mov	_var13, objptr
	sub	objptr, #72
	add	_var12, _var13
	mov	_var14, #48
	wrbyte	_var14, _var12
LR__0074
	mov	_var12, _var07
	add	_var12, _var11
	mov	_var07, _var12
	cmp	_var07, _var10 wz
 if_ne	jmp	#LR__0073
LR__0075
' if (j<>0)
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0079
' 
'   repeat while (pos>-1)
LR__0076
	cmps	_var06, ##-1 wcz
 if_be	jmp	#LR__0078
'     q:=j+//16
	mov	_var05, _var04
	and	_var05, #15
	mov	_var15, _var05
'     if (q>9)
	cmps	_var15, #9 wcz
 if_be	jmp	#LR__0077
'       q:=q+7
	mov	_var05, _var15
	add	_var05, #7
	mov	_var15, _var05
LR__0077
'     q:=48+q
	mov	_var05, #48
	add	_var05, _var15
	mov	_var15, _var05
'     n_string[pos]:=q
	mov	_var05, _var06
	add	objptr, #72
	mov	_var08, objptr
	sub	objptr, #72
	add	_var05, _var08
	wrbyte	_var15, _var05
'     j:=j+/16
	mov	_var05, _var04
	shr	_var05, #4
	mov	_var04, _var05
'     pos-=1
	mov	_var05, _var06
	sub	_var05, #1
	mov	_var06, _var05
	jmp	#LR__0076
LR__0078
LR__0079
' 
' q:=@n_string
	add	objptr, #72
	mov	_var05, objptr
	sub	objptr, #72
	mov	_var15, _var05
' return q
	mov	result1, _var15
	jmp	#_inttohex_ret
_inttohex_ret
	ret

' 
' 
' 
' '*************************************************************************
' '                                                                        *
' '  Mode setting and driver start                                                          *
' '                                                                        *
' '*************************************************************************
' 
' ''---------  Set the graphics mode
' 
' pub setmode(mode) | i', 'xzoom, yzoom, azoom
_setmode
	mov	COUNT_, #10
	call	#pushregs_
	mov	local01, arg01
' 
' '' mode:tn_bb_cc_vv_hh
' '' hh - h.zoom, vv-v.zoom, cc-c.depth,
' '' bb - borders/total pixels, 00-wide/1140, 01 medium/1026, 10 narrow/912, 11 no border, 1024 px PAL, 880 px NTSC
' 
' case_fast (mode>>6) & 7 ' timings are the same for graphic and text
	mov	local02, local01
	shr	local02, #6
	and	local02, #7
	fle	local02, #8
	mov	local03, local02
	jmprel	local03
LR__0080
	jmp	#LR__0081
	jmp	#LR__0082
	jmp	#LR__0083
	jmp	#LR__0084
	jmp	#LR__0085
	jmp	#LR__0086
	jmp	#LR__0087
	jmp	#LR__0088
	jmp	#LR__0089
LR__0081
'                               
'     0:  longmove(@timings,@timings000,16)   'PAL 50 Hz signaling 1140x624, active 800x480, 100x30 text, wide border, 2 colors per pixel, 00_00_00_00_00=0, 354_693_878 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7248
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7248
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0082
'     1:  longmove(@timings,@timings064,16)   'PAL 50 Hz signaling 1026x624, active 880x496, 110x31 text, medium border, 2 colors per pixel 00_01_00_00_00=64, 319_215_686 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7312
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7312
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0083
'     2:  longmove(@timings,@timings128,16)   'PAL 50 Hz signaling 912x624, active 800x480, 100x30 text, medium border, 2 colors per pixel 00_10_00_00_00=64, 283750000z
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7376
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7376
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0084
'     3:  longmove(@timings,@timings192,16)   'PAL 50 Hz signaling 1140x624, active 1024x576, 128x36 text, borderless, 2 colors per pixel 00_11_00_00_00=6192, 354_693_878 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7440
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7440
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0085
'     4:  longmove(@timings,@timings256,16)   'NTSC 50 Hz signaling 1140x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_00_00_00_00=256, 357959184 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7504
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7504
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0086
'     5:  longmove(@timings,@timings320,16)   'NTSC 50 Hz signaling 1026x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_01_00_00_00=320, 322162162 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7568
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7568
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0087
'     6:  longmove(@timings,@timings384,16)   'NTSC 50 Hz signaling 912x524, active 800x480, 100x30 text, NO PLACE FOR wide border, 2 colors per pixel, 01_10_00_00_00=384, 286363636 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7632
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7632
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0088
'     7:  longmove(@timings,@timings448,16)   'NTSC 50 Hz signaling 1026x524, active 880x496, 110x31 text, borderless, 2 colors per pixel, 01_11_00_00_00=496, 322162162 Hz
	add	objptr, #84
	mov	local04, objptr
	sub	objptr, #84
	mov	local05, local04
	add	ptr__dat__, ##7696
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7696
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__longmove
	mov	local09, result1
	jmp	#LR__0089
LR__0089
' 
' 
' if (mode==560) 
	cmp	local01, ##560 wz
 if_ne	jmp	#LR__0090
'   longmove(@timings,@timings560,16)
	add	objptr, #84
	mov	local02, objptr
	sub	objptr, #84
	mov	local04, local02
	add	ptr__dat__, ##7824
	mov	local05, ptr__dat__
	sub	ptr__dat__, ##7824
	mov	local06, local05
	mov	local07, #16
	mov	arg01, local04
	mov	arg02, local06
	mov	arg03, local07
	call	#__system__longmove
	mov	local08, result1
LR__0090
' 
' 
' if (mode & (%10_00_11_0000))==(%10_00_11_0000) ' 8bit graphics
	mov	local02, local01
	and	local02, ##560
	cmp	local02, ##560 wz
 if_ne	jmp	#LR__0091
'   timings[5]:=4
	mov	local02, #4
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
LR__0091
' repeat i from 0 to 4
	mov	local10, #0
LR__0092
'   timings[i]:=timings[i]+hdmibase<<17+ timingsxxt
	mov	local04, local10
	shl	local04, #2
	add	objptr, #84
	mov	local05, objptr
	sub	objptr, #84
	add	local04, local05
	add	objptr, #40
	rdlong	local07, objptr
	sub	objptr, #40
	mov	local06, local07
	shl	local06, #17
	rdlong	local02, local04
	add	local02, local06
	add	local02, ##1887502336
	mov	local08, local10
	shl	local08, #2
	add	objptr, #84
	mov	local09, objptr
	sub	objptr, #84
	add	local08, local09
	wrlong	local02, local08
	mov	local02, local10
	mov	local04, local10
	add	local04, #1
	mov	local10, local04
	cmps	local10, #5 wcz
 if_b	jmp	#LR__0092
' timings[5]:=timings[5]+hdmibase<<17  
	add	objptr, #40
	rdlong	local05, objptr
	sub	objptr, #40
	mov	local04, local05
	shl	local04, #17
	add	objptr, #104
	rdlong	local06, objptr
	sub	objptr, #104
	mov	local02, local06
	add	local02, local04
	add	objptr, #104
	wrlong	local02, objptr
	sub	objptr, #104
' clkfreq:=timings[13]
	add	objptr, #136
	rdlong	local02, objptr
	sub	objptr, #136
	wrlong	local02, #20
' hubset(timings[14])
	add	objptr, #140
	rdlong	local04, objptr
	sub	objptr, #140
	mov	local02, local04
	mov	arg01, local02
	call	#__system___hubset
' waitms(1)
	mov	local02, #1
	mov	arg01, local02
	call	#__system___waitms
' 
'   
' xzoom:=1<<(mode & 3)
	mov	local04, local01
	and	local04, #3
	mov	local02, #1
	shl	local02, local04
	add	objptr, #212
	wrlong	local02, objptr
	sub	objptr, #212
' yzoom:=1<<((mode>>2) & 3)
	mov	local04, local01
	shr	local04, #2
	and	local04, #3
	mov	local02, #1
	shl	local02, local04
	add	objptr, #216
	wrlong	local02, objptr
	sub	objptr, #216
' azoom:=xzoom*yzoom
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	local04, local05
	add	objptr, #216
	rdlong	local07, objptr
	sub	objptr, #216
	mov	local06, local07
	qmul	local04, local06
	getqx	local02
	add	objptr, #220
	wrlong	local02, objptr
	sub	objptr, #220
'    
' cpl:=timings[11]
	add	objptr, #128
	rdlong	local02, objptr
	sub	objptr, #128
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
' if (mode<512)
	cmps	local01, ##512 wcz
 if_ae	jmp	#LR__0094
'   lines:=(timings[12]>>4)+/yzoom
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	local02, local04
	shr	local02, #4
	mov	muldiva_, local02
	add	objptr, #216
	rdlong	local06, objptr
	sub	objptr, #216
	mov	muldivb_, local06
	call	#unsdivide_
	mov	local05, muldivb_
	add	objptr, #152
	wrlong	local05, objptr
	sub	objptr, #152
'   if ((timings[12]>>4)+//yzoom) <>0
	add	objptr, #132
	rdlong	local04, objptr
	sub	objptr, #132
	mov	local02, local04
	shr	local02, #4
	mov	muldiva_, local02
	add	objptr, #216
	rdlong	local06, objptr
	sub	objptr, #216
	mov	muldivb_, local06
	call	#unsdivide_
	mov	local05, muldiva_
	cmp	local05, #0 wz
 if_e	jmp	#LR__0093
'     lines +=1
	add	objptr, #152
	rdlong	local04, objptr
	sub	objptr, #152
	mov	local02, local04
	add	local02, #1
	add	objptr, #152
	wrlong	local02, objptr
	sub	objptr, #152
LR__0093
'   cpl:=cpl/xzoom
	add	objptr, #148
	rdlong	local04, objptr
	sub	objptr, #148
	mov	muldiva_, local04
	add	objptr, #212
	rdlong	local05, objptr
	sub	objptr, #212
	mov	muldivb_, local05
	call	#divide_
	mov	local02, muldivb_
	add	objptr, #148
	wrlong	local02, objptr
	sub	objptr, #148
' else
	jmp	#LR__0095
LR__0094
'   lines:=timings[12]
	add	objptr, #132
	rdlong	local02, objptr
	sub	objptr, #132
	add	objptr, #152
	wrlong	local02, objptr
	sub	objptr, #152
LR__0095
'  
'  
' buflen:=(cpl*lines)
	add	objptr, #148
	rdlong	local05, objptr
	sub	objptr, #148
	mov	local04, local05
	add	objptr, #152
	rdlong	local07, objptr
	sub	objptr, #152
	mov	local06, local07
	qmul	local04, local06
	getqx	local02
	add	objptr, #52
	wrlong	local02, objptr
	sub	objptr, #52
' 
' buf_ptr:=$7C000-4*buflen
	add	objptr, #52
	rdlong	local06, objptr
	sub	objptr, #52
	mov	local05, local06
	mov	local04, local05
	shl	local04, #2
	mov	local02, ##507904
	sub	local02, local04
	wrlong	local02, objptr
' mode_ptr:=@timings
	add	objptr, #84
	mov	local02, objptr
	sub	objptr, #84
	add	objptr, #20
	wrlong	local02, objptr
	sub	objptr, #20
' graphmode:=mode
	add	objptr, #208
	wrlong	local01, objptr
	sub	objptr, #208
' pintoggle(15)
	mov	local02, #15
	mov	arg01, local02
	call	#__system___drvnot
' makedl(mode)
	mov	local02, local01
	mov	arg01, local02
	call	#_makedl
	mov	ptra, fp
	call	#popregs_
_setmode_ret
	ret

' 
' 
' '---------- Make a display list
' 
' pub makedl (mode) |i, fontline,charline,bufstart,zoom1,vzoom,lpc
_makedl
	mov	_var01, arg01
' 
' ''--%aaaa_aaaa_aaaa_aaaa_aazz_nnnn_llll_ll_01 - txt
'   '' aaaa_aaaa_aaaa_aaaa_aazz_rrrr_rrrr_cc_10 - graph
'   '' aaaa_aaaa_aaaa-aaaa_aarr_rrrr_rrrr_rr_11 - extended, next long to read 
'   
' '   0 - display a up/down border line
'     
' '  ' aaaa_aaaa_aaaa_aaaa_aazz_nnnn_llll_ll_01 - text line
' '    aaaa_aaaa_aaaa_aaaa_aa00 - buffer start, has to be aligned, 1 long for char, ff_bb_rr_cc, foreground, background,reserved, charcode
' '    zz - zoom, 00-x1, 01-x2, 10-x4, 11-blank line
' '    nnnn - font line to display, 0..15
' '    llllll - character line, determines the cursor Y position
' 
' 
' if (mode &256==0) 
	mov	_var02, _var01
	and	_var02, #256
	cmp	_var02, #0 wz
 if_ne	jmp	#LR__0096
'   dl_ptr:=buf_ptr-4*576 
	rdlong	_var02, objptr
	sub	_var02, ##2304
	add	objptr, #32
	wrlong	_var02, objptr
	sub	objptr, #32
' else 
	jmp	#LR__0097
LR__0096
'   dl_ptr:=buf_ptr-496
	rdlong	_var02, objptr
	sub	_var02, #496
	add	objptr, #32
	wrlong	_var02, objptr
	sub	objptr, #32
LR__0097
' 
' if mode<512 '' text modes
	cmps	_var01, ##512 wcz
 if_ae	jmp	#LR__0098
LR__0098
' 
' 
' if mode<64
	cmps	_var01, #64 wcz
 if_ae	jmp	#LR__0108
'   repeat i from 0 to 47
	mov	_var03, #0
LR__0099
'     long[dl_ptr+4*i]:=0
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0100
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, #48 wcz
 if_b	jmp	#LR__0099
LR__0101
'   repeat i from 528 to 575
	mov	_var03, ##528
LR__0102
'     long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0103
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##576 wcz
 if_b	jmp	#LR__0102
LR__0104
'   vzoom:=((mode>>2) & 3)  
	mov	_var02, _var01
	shr	_var02, #2
	and	_var02, #3
	mov	_var07, _var02
'   lpc:=16<<vzoom 
	mov	_var02, #16
	shl	_var02, _var07
	mov	_var08, _var02
'   repeat i from 48 to 527
	mov	_var03, #48
LR__0105
'     fontline:=((i-48)+//lpc)>>vzoom
	mov	_var04, _var03
	sub	_var04, #48
	mov	muldiva_, _var04
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var02, muldiva_
	shr	_var02, _var07
	mov	_var09, _var02
'     charline:=(i-48)+/lpc
	mov	_var02, _var03
	sub	_var02, #48
	mov	muldiva_, _var02
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var04, muldivb_
	mov	_var10, _var04
'     bufstart:=buf_ptr+4*((cpl)*charline)+(mode&3)
	rdlong	_var02, objptr
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var05, _var06
	qmul	_var05, _var10
	getqx	_var04
	mov	_var11, _var04
	shl	_var11, #2
	add	_var02, _var11
	mov	_var12, _var01
	and	_var12, #3
	add	_var02, _var12
	mov	_var13, _var02
'     long[dl_ptr+4*i]:=(bufstart<<12)+(fontline<<8)+(charline<<2)+1
	mov	_var02, _var13
	shl	_var02, #12
	mov	_var04, _var09
	shl	_var04, #8
	add	_var02, _var04
	mov	_var05, _var10
	shl	_var05, #2
	add	_var02, _var05
	add	_var02, #1
	add	objptr, #32
	rdlong	_var11, objptr
	sub	objptr, #32
	mov	_var06, _var11
	mov	_var12, _var03
	shl	_var12, #2
	add	_var06, _var12
	wrlong	_var02, _var06
LR__0106
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##528 wcz
 if_b	jmp	#LR__0105
LR__0107
LR__0108
' 
' 
' if (mode>=64) and (mode<128)
	cmps	_var01, #64 wcz
 if_b	jmp	#LR__0118
	cmps	_var01, #128 wcz
 if_ae	jmp	#LR__0118
' 
'   repeat i from 0 to 23
	mov	_var03, #0
LR__0109
'     long[dl_ptr+4*i]:=0
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0110
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, #24 wcz
 if_b	jmp	#LR__0109
LR__0111
'   repeat i from 520 to 543
	mov	_var03, ##520
LR__0112
'     long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0113
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##544 wcz
 if_b	jmp	#LR__0112
LR__0114
'   vzoom:=((mode>>2) & 3)  
	mov	_var02, _var01
	shr	_var02, #2
	and	_var02, #3
	mov	_var07, _var02
'   lpc:=16<<vzoom 
	mov	_var02, #16
	shl	_var02, _var07
	mov	_var08, _var02
'   repeat i from 24 to 519
	mov	_var03, #24
LR__0115
'     fontline:=((i-24)+//lpc)>>vzoom
	mov	_var04, _var03
	sub	_var04, #24
	mov	muldiva_, _var04
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var02, muldiva_
	shr	_var02, _var07
	mov	_var09, _var02
'     charline:=(i-24)+/lpc
	mov	_var02, _var03
	sub	_var02, #24
	mov	muldiva_, _var02
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var04, muldivb_
	mov	_var10, _var04
'     bufstart:=buf_ptr+4*((cpl)*charline)+(mode&3)
	rdlong	_var02, objptr
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var05, _var06
	qmul	_var05, _var10
	getqx	_var04
	mov	_var11, _var04
	shl	_var11, #2
	add	_var02, _var11
	mov	_var12, _var01
	and	_var12, #3
	add	_var02, _var12
	mov	_var13, _var02
'     long[dl_ptr+4*i]:=(bufstart<<12)+(fontline<<8)+(charline<<2)+1
	mov	_var02, _var13
	shl	_var02, #12
	mov	_var04, _var09
	shl	_var04, #8
	add	_var02, _var04
	mov	_var05, _var10
	shl	_var05, #2
	add	_var02, _var05
	add	_var02, #1
	add	objptr, #32
	rdlong	_var11, objptr
	sub	objptr, #32
	mov	_var06, _var11
	mov	_var12, _var03
	shl	_var12, #2
	add	_var06, _var12
	wrlong	_var02, _var06
LR__0116
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##520 wcz
 if_b	jmp	#LR__0115
LR__0117
LR__0118
' 
' if (mode>=128) and (mode<192)
	cmps	_var01, #128 wcz
 if_b	jmp	#LR__0128
	cmps	_var01, #192 wcz
 if_ae	jmp	#LR__0128
' 
'   repeat i from 0 to 7
	mov	_var03, #0
LR__0119
'     long[dl_ptr+4*i]:=0
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0120
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, #8 wcz
 if_b	jmp	#LR__0119
LR__0121
'   repeat i from 488 to 495
	mov	_var03, #488
LR__0122
'     long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0123
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, #496 wcz
 if_b	jmp	#LR__0122
LR__0124
'   vzoom:=((mode>>2) & 3)  
	mov	_var02, _var01
	shr	_var02, #2
	and	_var02, #3
	mov	_var07, _var02
'   lpc:=16<<vzoom 
	mov	_var02, #16
	shl	_var02, _var07
	mov	_var08, _var02
'   repeat i from 8 to 487
	mov	_var03, #8
LR__0125
'     fontline:=((i-8)+//lpc)>>vzoom
	mov	_var04, _var03
	sub	_var04, #8
	mov	muldiva_, _var04
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var02, muldiva_
	shr	_var02, _var07
	mov	_var09, _var02
'     charline:=(i-8)+/lpc
	mov	_var02, _var03
	sub	_var02, #8
	mov	muldiva_, _var02
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var04, muldivb_
	mov	_var10, _var04
'     bufstart:=buf_ptr+4*((cpl)*charline)+(mode&3)
	rdlong	_var02, objptr
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var05, _var06
	qmul	_var05, _var10
	getqx	_var04
	mov	_var11, _var04
	shl	_var11, #2
	add	_var02, _var11
	mov	_var12, _var01
	and	_var12, #3
	add	_var02, _var12
	mov	_var13, _var02
'     long[dl_ptr+4*i]:=(bufstart<<12)+(fontline<<8)+(charline<<2)+1
	mov	_var02, _var13
	shl	_var02, #12
	mov	_var04, _var09
	shl	_var04, #8
	add	_var02, _var04
	mov	_var05, _var10
	shl	_var05, #2
	add	_var02, _var05
	add	_var02, #1
	add	objptr, #32
	rdlong	_var11, objptr
	sub	objptr, #32
	mov	_var06, _var11
	mov	_var12, _var03
	shl	_var12, #2
	add	_var06, _var12
	wrlong	_var02, _var06
LR__0126
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, #488 wcz
 if_b	jmp	#LR__0125
LR__0127
LR__0128
' 
' if (mode>=192) and (mode<256)
	cmps	_var01, #192 wcz
 if_b	jmp	#LR__0132
	cmps	_var01, #256 wcz
 if_ae	jmp	#LR__0132
' 
'   vzoom:=((mode>>2) & 3)  
	mov	_var02, _var01
	shr	_var02, #2
	and	_var02, #3
	mov	_var07, _var02
'   lpc:=16<<vzoom 
	mov	_var02, #16
	shl	_var02, _var07
	mov	_var08, _var02
'   repeat i from 0 to 575
	mov	_var03, #0
LR__0129
'     fontline:=((i)+//lpc)>>vzoom
	mov	muldiva_, _var03
	mov	muldivb_, _var08
	call	#unsdivide_
	mov	_var02, muldiva_
	shr	_var02, _var07
	mov	_var09, _var02
'     charline:=(i)+/lpc
	mov	_var02, muldivb_
	mov	_var10, _var02
'     bufstart:=buf_ptr+4*((cpl)*charline)+(mode&3)
	rdlong	_var02, objptr
	add	objptr, #148
	rdlong	_var06, objptr
	sub	objptr, #148
	mov	_var05, _var06
	qmul	_var05, _var10
	getqx	_var04
	mov	_var11, _var04
	shl	_var11, #2
	add	_var02, _var11
	mov	_var12, _var01
	and	_var12, #3
	add	_var02, _var12
	mov	_var13, _var02
'     long[dl_ptr+4*i]:=(bufstart<<12)+(fontline<<8)+(charline<<2)+1
	mov	_var02, _var13
	shl	_var02, #12
	mov	_var04, _var09
	shl	_var04, #8
	add	_var02, _var04
	mov	_var05, _var10
	shl	_var05, #2
	add	_var02, _var05
	add	_var02, #1
	add	objptr, #32
	rdlong	_var11, objptr
	sub	objptr, #32
	mov	_var06, _var11
	mov	_var12, _var03
	shl	_var12, #2
	add	_var06, _var12
	wrlong	_var02, _var06
LR__0130
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##576 wcz
 if_b	jmp	#LR__0129
LR__0131
LR__0132
' 
' 
' if mode==560
	cmp	_var01, ##560 wz
 if_ne	jmp	#LR__0142
'   repeat i from 0 to 47
	mov	_var03, #0
LR__0133
'    long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0134
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, #48 wcz
 if_b	jmp	#LR__0133
LR__0135
'   repeat i from 48 to 527   
	mov	_var03, #48
LR__0136
'    bufstart:=buf_ptr+4*(cpl*(i-48))+(mode&3)
	rdlong	_var02, objptr
	mov	_var04, _var03
	sub	_var04, #48
	add	objptr, #148
	rdlong	_var11, objptr
	sub	objptr, #148
	mov	_var06, _var11
	qmul	_var06, _var04
	getqx	_var05
	mov	_var12, _var05
	shl	_var12, #2
	add	_var02, _var12
	mov	_var14, _var01
	and	_var14, #3
	add	_var02, _var14
	mov	_var13, _var02
'    long[dl_ptr+4*i]:=(bufstart<<12)+$E  
	mov	_var02, _var13
	shl	_var02, #12
	add	_var02, #14
	add	objptr, #32
	rdlong	_var05, objptr
	sub	objptr, #32
	mov	_var04, _var05
	mov	_var06, _var03
	shl	_var06, #2
	add	_var04, _var06
	wrlong	_var02, _var04
LR__0137
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##528 wcz
 if_b	jmp	#LR__0136
LR__0138
'   repeat i from 528 to 575
	mov	_var03, ##528
LR__0139
'     long[dl_ptr+4*i]:=$0  
	add	objptr, #32
	rdlong	_var04, objptr
	sub	objptr, #32
	mov	_var02, _var04
	mov	_var05, _var03
	shl	_var05, #2
	add	_var02, _var05
	mov	_var06, #0
	wrlong	_var06, _var02
LR__0140
	mov	_var02, _var03
	mov	_var04, _var03
	add	_var04, #1
	mov	_var03, _var04
	cmps	_var03, ##576 wcz
 if_b	jmp	#LR__0139
LR__0141
LR__0142
_makedl_ret
	ret

'     
'     
' '--------- Start the driver with graphics mode 'mode' at pins 'base'
' 
' pub start(mode,base):result
_start
	mov	COUNT_, #9
	call	#pushregs_
	mov	local01, arg01
	mov	local02, arg02
	mov	local03, #0
' 
' ' initialize pointers and variables
' 
' border_ptr:=@bordercolor
	add	objptr, #48
	mov	local04, objptr
	sub	objptr, #48
	add	objptr, #8
	wrlong	local04, objptr
	sub	objptr, #8
' font_ptr:=@st_font
	add	ptr__dat__, ##4096
	mov	local04, ptr__dat__
	sub	ptr__dat__, ##4096
	add	objptr, #4
	wrlong	local04, objptr
	sub	objptr, #4
' hdmibase:=base
	add	objptr, #40
	wrlong	local02, objptr
	sub	objptr, #40
' 
' ' the mode has to be set here to enable computing the buffer length
' 
' setmode(mode)
	mov	local04, local01
	mov	arg01, local04
	call	#_setmode
' 
' 
' vblank_ptr:=@vblank
	add	objptr, #68
	mov	local04, objptr
	sub	objptr, #68
	add	objptr, #12
	wrlong	local04, objptr
	sub	objptr, #12
' cursor_ptr:=@cursor_x
	add	objptr, #56
	mov	local04, objptr
	sub	objptr, #56
	add	objptr, #16
	wrlong	local04, objptr
	sub	objptr, #16
' 
' palette_ptr:=@ataripalette
	add	ptr__dat__, ##6144
	mov	local04, ptr__dat__
	sub	ptr__dat__, ##6144
	add	objptr, #24
	wrlong	local04, objptr
	sub	objptr, #24
' command_ptr:=@cmd1
	add	objptr, #156
	mov	local04, objptr
	sub	objptr, #156
	add	objptr, #28
	wrlong	local04, objptr
	sub	objptr, #28
' fontnum_ptr:=@fontnum
	add	objptr, #164
	mov	local04, objptr
	sub	objptr, #164
	add	objptr, #36
	wrlong	local04, objptr
	sub	objptr, #36
' 
' fontnum:=0  ' PC type font ' TODO: font# in buffer byte #1
	mov	local04, #0
	add	objptr, #164
	wrlong	local04, objptr
	sub	objptr, #164
' bytemove(@colors,@vgacolors,16)
	add	objptr, #192
	mov	local04, objptr
	sub	objptr, #192
	mov	local05, local04
	add	ptr__dat__, ##7888
	mov	local06, ptr__dat__
	sub	ptr__dat__, ##7888
	mov	local07, local06
	mov	local08, #16
	mov	arg01, local05
	mov	arg02, local07
	mov	arg03, local08
	call	#__system__bytemove
	mov	local09, result1
' 
' ' initialize a cursor
' 
' cursor_x:=0
	mov	local04, #0
	add	objptr, #56
	wrbyte	local04, objptr
	sub	objptr, #56
' cursor_y:=0
	mov	local04, #0
	add	objptr, #57
	wrbyte	local04, objptr
	sub	objptr, #57
' cursor_sh:=14
	mov	local04, #14
	add	objptr, #58
	wrbyte	local04, objptr
	sub	objptr, #58
' 
' cmd1:=257 ' set command idle
	mov	local04, #257
	add	objptr, #156
	wrlong	local04, objptr
	sub	objptr, #156
' 
' ' start the cog
' 
' cog:=coginit(16,@hdmi, @buf_ptr)
	mov	local04, #16
	add	ptr__dat__, ##7904
	mov	local05, ptr__dat__
	sub	ptr__dat__, ##7904
	mov	local06, local05
	mov	local07, objptr
	mov	local08, local07
	mov	arg01, local04
	mov	arg02, local06
	mov	arg03, local08
	call	#__system___coginit
	mov	local09, result1
	add	objptr, #44
	wrlong	local09, objptr
	sub	objptr, #44
' waitms(20)
	mov	local04, #20
	mov	arg01, local04
	call	#__system___waitms
' 
' ' clear the screen and set the colors to green on black
' 
' cls(c_green,c_black)
	mov	local04, #199
	mov	local05, #0
	mov	arg01, local04
	mov	arg02, local05
	call	#_cls
	mov	local06, result1
' setbordercolor(0,0,128)
	mov	local04, #0
	mov	local05, #0
	mov	local06, #128
	mov	arg01, local04
	mov	arg02, local05
	mov	arg03, local06
	call	#_setbordercolor
' setwritecolors(c_green,c_black)
	mov	local04, #199
	mov	local05, #0
	mov	arg01, local04
	mov	arg02, local05
	call	#_setwritecolors
' 
' return cog
	add	objptr, #44
	rdlong	local04, objptr
	sub	objptr, #44
	mov	result1, local04
	jmp	#LR__0143
LR__0143
	mov	ptra, fp
	call	#popregs_
_start_ret
	ret
hubexit
	jmp	#cogexit

__system___hubset
	mov	_var01, arg01
	hubset	_var01
__system___hubset_ret
	ret

__system___coginit
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	setq	_var03
	coginit	_var01, _var02 wc
 if_b	neg	_var01, #1
	mov	result1, _var01
	jmp	#__system___coginit_ret
__system___coginit_ret
	ret

__system___drvnot
	mov	_var01, arg01
	drvnot	_var01
__system___drvnot_ret
	ret

__system___waitx
	mov	_var01, arg01
	waitx	_var01
__system___waitx_ret
	ret

__system__bytemove
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, #0
	mov	_var04, _var01
	cmps	_var01, _var02 wcz
 if_ae	jmp	#LR__0149
LR__0144
	cmps	_var03, #3 wcz
 if_be	jmp	#LR__0145
	rdlong	_var05, _var02
	wrlong	_var05, _var01
	mov	_var05, _var01
	add	_var05, #4
	mov	_var01, _var05
	mov	_var05, _var02
	add	_var05, #4
	mov	_var02, _var05
	mov	_var05, _var03
	sub	_var05, #4
	mov	_var03, _var05
	jmp	#LR__0144
LR__0145
	mov	_var06, _var03
LR__0146
	cmp	_var06, #0 wz
 if_e	jmp	#LR__0148
	rdbyte	_var05, _var02
	wrbyte	_var05, _var01
	mov	_var05, _var01
	add	_var05, #1
	mov	_var01, _var05
	mov	_var05, _var02
	add	_var05, #1
	mov	_var02, _var05
LR__0147
	mov	_var05, _var06
	sub	_var05, #1
	mov	_var06, _var05
	jmp	#LR__0146
LR__0148
	jmp	#LR__0153
LR__0149
	mov	_var05, _var01
	add	_var05, _var03
	mov	_var01, _var05
	mov	_var05, _var02
	add	_var05, _var03
	mov	_var02, _var05
	mov	_var07, _var03
LR__0150
	cmp	_var07, #0 wz
 if_e	jmp	#LR__0152
	mov	_var05, _var01
	sub	_var05, #1
	mov	_var01, _var05
	mov	_var05, _var02
	sub	_var05, #1
	mov	_var02, _var05
	rdbyte	_var05, _var02
	wrbyte	_var05, _var01
LR__0151
	mov	_var05, _var07
	sub	_var05, #1
	mov	_var07, _var05
	jmp	#LR__0150
LR__0152
LR__0153
	mov	result1, _var04
	jmp	#__system__bytemove_ret
__system__bytemove_ret
	ret

__system__longfill
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, _var03
LR__0154
	cmp	_var04, #0 wz
 if_e	jmp	#LR__0156
	wrlong	_var02, _var01
	mov	_var05, _var01
	add	_var05, #4
	mov	_var01, _var05
LR__0155
	mov	_var05, _var04
	sub	_var05, #1
	mov	_var04, _var05
	jmp	#LR__0154
LR__0156
__system__longfill_ret
	ret

__system__longmove
	mov	_var01, arg01
	mov	_var02, arg02
	mov	_var03, arg03
	mov	_var04, #0
	mov	_var04, _var01
	cmps	_var01, _var02 wcz
 if_ae	jmp	#LR__0160
	mov	_var05, _var03
LR__0157
	cmp	_var05, #0 wz
 if_e	jmp	#LR__0159
	rdlong	_var06, _var02
	wrlong	_var06, _var01
	mov	_var06, _var01
	add	_var06, #4
	mov	_var01, _var06
	mov	_var06, _var02
	add	_var06, #4
	mov	_var02, _var06
LR__0158
	mov	_var06, _var05
	sub	_var06, #1
	mov	_var05, _var06
	jmp	#LR__0157
LR__0159
	jmp	#LR__0164
LR__0160
	mov	_var06, _var01
	mov	_var07, _var03
	shl	_var07, #2
	add	_var06, _var07
	mov	_var01, _var06
	mov	_var06, _var02
	mov	_var07, _var03
	shl	_var07, #2
	add	_var06, _var07
	mov	_var02, _var06
	mov	_var08, _var03
LR__0161
	cmp	_var08, #0 wz
 if_e	jmp	#LR__0163
	mov	_var06, _var01
	sub	_var06, #4
	mov	_var01, _var06
	mov	_var06, _var02
	sub	_var06, #4
	mov	_var02, _var06
	rdlong	_var06, _var02
	wrlong	_var06, _var01
LR__0162
	mov	_var06, _var08
	sub	_var06, #1
	mov	_var08, _var06
	jmp	#LR__0161
LR__0163
LR__0164
	mov	result1, _var04
	jmp	#__system__longmove_ret
__system__longmove_ret
	ret

__system____builtin_strlen
	mov	_var01, arg01
	mov	_var02, #0
	mov	_var02, #0
LR__0165
	rdbyte	_var03, _var01
	cmp	_var03, #0 wz
 if_e	jmp	#LR__0166
	mov	_var03, _var02
	mov	_var04, _var02
	add	_var04, #1
	mov	_var02, _var04
	mov	_var03, _var01
	mov	_var04, _var01
	add	_var04, #1
	mov	_var01, _var04
	jmp	#LR__0165
LR__0166
	mov	result1, _var02
	jmp	#__system____builtin_strlen_ret
__system____builtin_strlen_ret
	ret

__system___waitms
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	rdlong	local02, #20
LR__0167
	cmps	local01, ##1000 wcz
 if_be	jmp	#LR__0168
	mov	local03, local02
	mov	arg01, local03
	call	#__system___waitx
	mov	local03, local01
	sub	local03, ##1000
	mov	local01, local03
	jmp	#LR__0167
LR__0168
	cmps	local01, #0 wcz
 if_be	jmp	#LR__0169
	mov	muldiva_, local02
	mov	muldivb_, ##1000
	call	#divide_
	mov	local03, muldivb_
	qmul	local01, local03
	getqx	local04
	mov	local05, local04
	mov	arg01, local05
	call	#__system___waitx
LR__0169
	mov	ptra, fp
	call	#popregs_
__system___waitms_ret
	ret

__system___waitus
	mov	COUNT_, #5
	call	#pushregs_
	mov	local01, arg01
	rdlong	local02, #20
LR__0170
	cmps	local01, ##1000000 wcz
 if_be	jmp	#LR__0171
	mov	local03, local02
	mov	arg01, local03
	call	#__system___waitx
	mov	local03, local01
	sub	local03, ##1000000
	mov	local01, local03
	jmp	#LR__0170
LR__0171
	cmps	local01, #0 wcz
 if_be	jmp	#LR__0172
	mov	muldiva_, local02
	mov	muldivb_, ##1000000
	call	#divide_
	mov	local03, muldivb_
	qmul	local01, local03
	getqx	local04
	mov	local05, local04
	mov	arg01, local05
	call	#__system___waitx
LR__0172
	mov	ptra, fp
	call	#popregs_
__system___waitus_ret
	ret

LR__0173
	byte	" "
	byte	0
	alignl
_dat_
'-' vga_font       file "vgafont.def"
	byte	$00[19]
	byte	$7e, $81, $a5, $81, $81, $bd, $99, $81, $81, $7e, $00, $00, $00, $00, $00, $00
	byte	$7e, $ff, $db, $ff, $ff, $c3, $e7, $ff, $ff, $7e, $00, $00, $00, $00, $00, $00
	byte	$00, $36, $7f, $7f, $7f, $7f, $3e, $1c, $08, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $08, $1c, $3e, $7f, $3e, $1c, $08, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$18, $3c, $3c, $e7, $e7, $e7, $18, $18, $3c, $00, $00, $00, $00, $00, $00, $00
	byte	$18, $3c, $7e, $ff, $ff, $7e, $18, $18, $3c, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $18, $3c, $3c, $18, $00, $00, $00, $00, $00, $00, $ff, $ff, $ff
	byte	$ff, $ff, $ff, $e7, $c3, $c3, $e7, $ff, $ff, $ff, $ff, $ff, $ff, $00, $00, $00
	byte	$00, $00, $3c, $66, $42, $42, $66, $3c, $00, $00, $00, $00, $00, $ff, $ff, $ff
	byte	$ff, $ff, $c3, $99, $bd, $bd, $99, $c3, $ff, $ff, $ff, $ff, $ff, $00, $00, $00
	byte	$78, $70, $58, $4c, $1e, $33, $33, $33, $33, $1e, $00, $00, $00, $00, $00, $00
	byte	$3c, $66, $66, $66, $66, $3c, $18, $7e, $18, $18, $00, $00, $00, $00, $00, $00
	byte	$fc, $cc, $fc, $0c, $0c, $0c, $0c, $0e, $0f, $07, $00, $00, $00, $00, $00, $00
	byte	$fe, $c6, $fe, $c6, $c6, $c6, $c6, $e6, $e7, $67, $03, $00, $00, $00, $00, $00
	byte	$18, $18, $db, $3c, $e7, $3c, $db, $18, $18, $00, $00, $00, $00, $00, $00, $01
	byte	$03, $07, $0f, $1f, $7f, $1f, $0f, $07, $03, $01, $00, $00, $00, $00, $00, $40
	byte	$60, $70, $78, $7c, $7f, $7c, $78, $70, $60, $40, $00, $00, $00, $00, $00, $00
	byte	$18, $3c, $7e, $18, $18, $18, $7e, $3c, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$66[7]
	byte	$00, $66, $66, $00, $00, $00, $00, $00, $00, $fe, $db, $db, $db, $de, $d8, $d8
	byte	$d8, $d8, $d8, $00, $00, $00, $00, $3e, $63, $06, $1c, $36, $63, $63, $36, $1c
	byte	$30, $63, $3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7f
	byte	$7f, $7f, $7f, $00, $00, $00, $00, $00, $00, $18, $3c, $7e, $18, $18, $18, $7e
	byte	$3c, $18, $7e, $00, $00, $00, $00, $00, $00, $18, $3c, $7e, $18, $18, $18, $18
	byte	$18, $18, $18, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$7e, $3c, $18, $00, $00, $00, $00, $00, $00, $00, $00, $18, $30, $7f, $30, $18
	byte	$00[11]
	byte	$0c, $06, $7f, $06, $0c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $03, $03, $03, $7f, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$14, $36, $7f, $36, $14, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $08
	byte	$1c, $1c, $3e, $3e, $7f, $7f, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7f
	byte	$7f, $3e, $3e, $1c, $1c, $08, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[14]
	byte	$18, $3c, $3c, $3c, $18, $18, $18, $00, $18, $18, $00, $00, $00, $00, $66, $66
	byte	$66, $24, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $36, $36, $7f, $36, $36, $36, $7f, $36, $36, $00, $00, $00, $00, $18, $18
	byte	$3e, $63, $43, $03, $3e, $60, $60, $61, $63, $3e, $18, $18, $00, $00, $00, $00
	byte	$00, $00, $43, $63, $30, $18, $0c, $06, $63, $61, $00, $00, $00, $00, $00, $00
	byte	$1c, $36, $36, $1c, $6e, $3b, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00
	byte	$0c, $0c, $0c, $06, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$30, $18, $0c, $0c, $0c, $0c, $0c, $0c, $18, $30, $00, $00, $00, $00, $00, $00
	byte	$0c, $18, $30, $30, $30, $30, $30, $30, $18, $0c, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $66, $3c, $ff, $3c, $66, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $18, $18, $7e, $18, $18, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[8]
	byte	$18, $18, $18, $0c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7f, $00, $00
	byte	$00[16]
	byte	$18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $40, $60, $30, $18, $0c, $06
	byte	$03, $01, $00, $00, $00, $00, $00, $00, $1c, $36, $63, $63, $6b, $6b, $63, $63
	byte	$36, $1c, $00, $00, $00, $00, $00, $00, $18, $1c, $1e, $18, $18, $18, $18, $18
	byte	$18, $7e, $00, $00, $00, $00, $00, $00, $3e, $63, $60, $30, $18, $0c, $06, $03
	byte	$63, $7f, $00, $00, $00, $00, $00, $00, $3e, $63, $60, $60, $3c, $60, $60, $60
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $30, $38, $3c, $36, $33, $7f, $30, $30
	byte	$30, $78, $00, $00, $00, $00, $00, $00, $7f, $03, $03, $03, $3f, $60, $60, $60
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $1c, $06, $03, $03, $3f, $63, $63, $63
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $7f, $63, $60, $60, $30, $18, $0c, $0c
	byte	$0c, $0c, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $3e, $63, $63, $63
	byte	$63, $3e, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $7e, $60, $60, $60
	byte	$30, $1e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $00, $00, $00
	byte	$18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $00, $00, $00
	byte	$18, $18, $0c, $00, $00, $00, $00, $00, $00, $60, $30, $18, $0c, $06, $0c, $18
	byte	$30, $60, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7e, $00, $00, $7e, $00
	byte	$00[9]
	byte	$06, $0c, $18, $30, $60, $30, $18, $0c, $06, $00, $00, $00, $00, $00, $00, $3e
	byte	$63, $63, $30, $18, $18, $18, $00, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $63, $63, $7b, $7b, $7b, $3b, $03, $3e, $00, $00, $00, $00, $00, $00, $08
	byte	$1c, $36, $63, $63, $7f, $63, $63, $63, $63, $00, $00, $00, $00, $00, $00, $3f
	byte	$66, $66, $66, $3e, $66, $66, $66, $66, $3f, $00, $00, $00, $00, $00, $00, $3c
	byte	$66, $43, $03, $03, $03, $03, $43, $66, $3c, $00, $00, $00, $00, $00, $00, $1f
	byte	$36, $66, $66, $66, $66, $66, $66, $36, $1f, $00, $00, $00, $00, $00, $00, $7f
	byte	$66, $46, $16, $1e, $16, $06, $46, $66, $7f, $00, $00, $00, $00, $00, $00, $7f
	byte	$66, $46, $16, $1e, $16, $06, $06, $06, $0f, $00, $00, $00, $00, $00, $00, $3c
	byte	$66, $43, $03, $03, $7b, $63, $63, $66, $5c, $00, $00, $00, $00, $00, $00, $63
	byte	$63, $63, $63, $7f, $63, $63, $63, $63, $63, $00, $00, $00, $00, $00, $00, $3c
	byte	$18[8]
	byte	$3c, $00, $00, $00, $00, $00, $00, $78, $30, $30, $30, $30, $30, $33, $33, $33
	byte	$1e, $00, $00, $00, $00, $00, $00, $67, $66, $66, $36, $1e, $1e, $36, $66, $66
	byte	$67, $00, $00, $00, $00, $00, $00, $0f, $06, $06, $06, $06, $06, $06, $46, $66
	byte	$7f, $00, $00, $00, $00, $00, $00, $63, $77, $7f, $7f, $6b, $63, $63, $63, $63
	byte	$63, $00, $00, $00, $00, $00, $00, $63, $67, $6f, $7f, $7b, $73, $63, $63, $63
	byte	$63, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $3f, $66, $66, $66, $3e, $06, $06, $06, $06
	byte	$0f, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $63, $63, $63, $6b, $7b
	byte	$3e, $30, $70, $00, $00, $00, $00, $3f, $66, $66, $66, $3e, $36, $66, $66, $66
	byte	$67, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $06, $1c, $30, $60, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $7e, $7e, $5a, $18, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $63, $63, $36, $1c
	byte	$08, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $6b, $6b, $6b, $7f, $77
	byte	$36, $00, $00, $00, $00, $00, $00, $63, $63, $36, $3e, $1c, $1c, $3e, $36, $63
	byte	$63, $00, $00, $00, $00, $00, $00, $66, $66, $66, $66, $3c, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $00, $7f, $63, $61, $30, $18, $0c, $06, $43, $63
	byte	$7f, $00, $00, $00, $00, $00, $00, $3c, $0c, $0c, $0c, $0c, $0c, $0c, $0c, $0c
	byte	$3c, $00, $00, $00, $00, $00, $00, $00, $01, $03, $07, $0e, $1c, $38, $70, $60
	byte	$40, $00, $00, $00, $00, $00, $00, $3c, $30, $30, $30, $30, $30, $30, $30, $30
	byte	$3c, $00, $00, $00, $1c, $36, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[17]
	byte	$ff, $00, $00, $0c, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[9]
	byte	$1e, $30, $3e, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00, $07, $06, $06
	byte	$1e, $36, $66, $66, $66, $66, $3e, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $63, $03, $03, $03, $63, $3e, $00, $00, $00, $00, $00, $00, $38, $30, $30
	byte	$3c, $36, $33, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $63, $7f, $03, $03, $63, $3e, $00, $00, $00, $00, $00, $00, $38, $6c, $4c
	byte	$0c, $1e, $0c, $0c, $0c, $0c, $1e, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$6e, $33, $33, $33, $33, $33, $3e, $30, $33, $1e, $00, $00, $00, $07, $06, $06
	byte	$36, $6e, $66, $66, $66, $66, $67, $00, $00, $00, $00, $00, $00, $18, $18, $00
	byte	$1c, $18, $18, $18, $18, $18, $3c, $00, $00, $00, $00, $00, $00, $60, $60, $00
	byte	$70, $60, $60, $60, $60, $60, $60, $66, $66, $3c, $00, $00, $00, $07, $06, $06
	byte	$66, $36, $1e, $1e, $36, $66, $67, $00, $00, $00, $00, $00, $00, $1c, $18, $18
	byte	$18[6]
	byte	$3c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $37, $7f, $6b, $6b, $6b, $6b
	byte	$63, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3b, $66, $66, $66, $66, $66
	byte	$66, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3b, $66, $66, $66, $66, $66
	byte	$3e, $06, $06, $0f, $00, $00, $00, $00, $00, $00, $6e, $33, $33, $33, $33, $33
	byte	$3e, $30, $30, $78, $00, $00, $00, $00, $00, $00, $3b, $6e, $66, $06, $06, $06
	byte	$0f, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3e, $63, $06, $1c, $30, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $08, $0c, $0c, $3f, $0c, $0c, $0c, $0c, $6c
	byte	$38, $00, $00, $00, $00, $00, $00, $00, $00, $00, $33, $33, $33, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $36
	byte	$1c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $63, $6b, $6b, $6b, $7f
	byte	$36, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $36, $1c, $1c, $1c, $36
	byte	$63, $00, $00, $00, $00, $00, $00, $00, $00, $00, $63, $63, $63, $63, $63, $63
	byte	$7e, $60, $30, $1f, $00, $00, $00, $00, $00, $00, $7f, $33, $18, $0c, $06, $63
	byte	$7f, $00, $00, $00, $00, $00, $00, $70, $18, $18, $18, $0e, $18, $18, $18, $18
	byte	$70, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $00, $00, $00, $00, $00, $00, $0e, $18, $18, $18, $70, $18, $18, $18, $18
	byte	$0e, $00, $00, $00, $6e, $3b, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[10]
	byte	$08, $1c, $36, $63, $63, $63, $7f, $00, $00, $00, $00, $00, $00, $3c, $66, $43
	byte	$03, $03, $03, $03, $43, $66, $3c, $18, $30, $1e, $00, $00, $00, $00, $33, $00
	byte	$33[6]
	byte	$6e, $00, $00, $00, $00, $00, $60, $30, $18, $00, $3e, $63, $7f, $03, $03, $63
	byte	$3e, $00, $00, $00, $00, $00, $08, $1c, $36, $00, $1e, $30, $3e, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $00, $00, $33, $00, $1e, $30, $3e, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $1c, $36, $1c, $00, $33, $33, $33, $33, $33, $33
	byte	$6e, $00, $00, $00, $00, $00, $60, $30, $18, $00, $3e, $63, $03, $03, $03, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $3e, $63, $03, $03, $03, $63
	byte	$3e, $18, $30, $1e, $00, $00, $00, $1c, $58, $78, $38, $18, $1c, $1e, $1a, $18
	byte	$3c, $00, $00, $00, $00, $00, $00, $00, $63, $00, $3e, $63, $7f, $03, $03, $63
	byte	$3e, $00, $00, $00, $66, $33, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $cc, $66, $33, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $18, $3c, $66, $00, $1c, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $30, $18, $00, $7f, $63, $61, $30, $18, $0c, $06, $43, $63
	byte	$7f, $00, $00, $00, $00, $63, $00, $08, $1c, $36, $63, $63, $7f, $63, $63, $63
	byte	$63, $00, $00, $00, $30, $18, $00, $3c, $66, $43, $03, $03, $03, $03, $43, $66
	byte	$3c, $00, $00, $00, $30, $18, $00, $7f, $66, $46, $16, $1e, $16, $06, $46, $66
	byte	$7f, $00, $00, $00, $0c, $06, $00, $0f, $06, $06, $06, $06, $06, $06, $46, $66
	byte	$7f, $00, $00, $00, $30, $18, $00, $1c, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $08, $1c, $36, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $00, $63, $00, $3e, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $00, $6f, $46, $26, $06, $06, $06, $06, $46, $66
	byte	$7f, $00, $00, $00, $00, $00, $00, $6e, $4c, $2c, $0c, $0c, $0c, $0c, $0c, $0c
	byte	$1e, $00, $00, $00, $30, $18, $00, $3e, $63, $63, $06, $1c, $30, $60, $63, $63
	byte	$3e, $00, $00, $00, $00, $00, $60, $30, $18, $00, $3e, $63, $06, $1c, $30, $63
	byte	$3e, $00, $00, $00, $00, $63, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $00, $63, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63
	byte	$3e, $00, $00, $00, $6c, $38, $00, $7e, $7e, $5a, $18, $18, $18, $18, $18, $18
	byte	$3c, $00, $00, $00, $00, $00, $60, $48, $2c, $0c, $3f, $0c, $0c, $0c, $0c, $6c
	byte	$38, $00, $00, $00, $00, $00, $00, $0f, $26, $36, $1e, $0e, $07, $07, $46, $66
	byte	$7f, $00, $00, $00, $00, $00, $00, $00, $00, $63, $36, $1c, $1c, $36, $63, $00
	byte	$00[6]
	byte	$36, $1c, $08, $00, $3e, $63, $03, $03, $03, $63, $3e, $00, $00, $00, $00, $00
	byte	$30, $18, $0c, $00, $1e, $30, $3e, $33, $33, $33, $6e, $00, $00, $00, $00, $00
	byte	$60, $30, $18, $00, $1c, $18, $18, $18, $18, $18, $3c, $00, $00, $00, $00, $00
	byte	$60, $30, $18, $00, $3e, $63, $63, $63, $63, $63, $3e, $00, $00, $00, $00, $00
	byte	$30, $18, $0c, $00, $33, $33, $33, $33, $33, $33, $6e, $00, $00, $00, $00, $00
	byte	$00, $08, $1c, $36, $63, $63, $7f, $63, $63, $63, $63, $18, $0c, $78, $00, $00
	byte	$00, $00, $00, $00, $1e, $30, $3e, $33, $33, $33, $6e, $18, $0c, $78, $36, $1c
	byte	$00, $7f, $63, $61, $30, $18, $0c, $06, $43, $63, $7f, $00, $00, $00, $00, $00
	byte	$36, $1c, $08, $00, $7f, $33, $18, $0c, $06, $63, $7f, $00, $00, $00, $00, $00
	byte	$00, $7f, $66, $46, $16, $1e, $16, $06, $46, $66, $7f, $18, $0c, $78, $00, $00
	byte	$00, $00, $00, $00, $3e, $63, $7f, $03, $03, $63, $3e, $18, $0c, $78, $00, $00
	byte	$00, $3c, $66, $03, $1f, $03, $0f, $03, $03, $66, $3c, $00, $00, $00, $00, $00
	byte	$60, $30, $18, $00, $7f, $33, $18, $0c, $06, $63, $7f, $00, $00, $00, $6c, $38
	byte	$00, $3c, $66, $43, $03, $03, $03, $03, $43, $66, $3c, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $3e, $63, $06, $1c, $30, $63, $3e, $18, $30, $1e, $00, $00
	byte	$00[6]
	byte	$6c, $36, $1b, $36, $6c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$1b, $36, $6c, $36, $1b, $00, $00, $00, $88, $22, $88, $22, $88, $22, $88, $22
	byte	$88, $22, $88, $22, $88, $22, $88, $22, $aa, $55, $aa, $55, $aa, $55, $aa, $55
	byte	$aa, $55, $aa, $55, $aa, $55, $aa, $55, $bb, $ee, $bb, $ee, $bb, $ee, $bb, $ee
	byte	$bb, $ee, $bb, $ee, $bb, $ee, $bb, $ee, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18[15]
	byte	$1f, $18, $18, $18, $18, $18, $18, $18, $18, $30, $18, $00, $08, $1c, $36, $63
	byte	$63, $7f, $63, $63, $63, $63, $00, $00, $00, $1c, $36, $00, $08, $1c, $36, $63
	byte	$63, $7f, $63, $63, $63, $63, $00, $00, $00, $36, $1c, $00, $7f, $66, $46, $16
	byte	$1e, $16, $06, $46, $66, $7f, $00, $00, $00, $00, $00, $00, $3e, $63, $63, $06
	byte	$1c, $30, $60, $63, $63, $3e, $18, $30, $1e, $6c, $6c, $6c, $6c, $6c, $6f, $60
	byte	$6f, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$6c[9]
	byte	$00[5]
	byte	$7f, $60, $6f, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$6f, $60, $7f, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $00, $7f, $63
	byte	$61, $30, $18, $0c, $06, $43, $63, $7f, $00, $00, $00, $00, $00, $00, $18, $18
	byte	$00, $7f, $33, $18, $0c, $06, $63, $7f, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $1f, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $f8, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18
	byte	$18, $18, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $ff, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $f8, $18, $18, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00
	byte	$00, $00, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18
	byte	$18, $18, $ff, $18, $18, $18, $18, $18, $18, $18, $18, $63, $3e, $00, $08, $1c
	byte	$36, $63, $63, $7f, $63, $63, $63, $63, $00, $00, $00, $00, $00, $00, $63, $3e
	byte	$00, $1e, $30, $3e, $33, $33, $33, $6e, $00, $00, $00, $6c, $6c, $6c, $6c, $6c
	byte	$ec, $0c, $fc, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$fc, $0c, $ec, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$ef, $00, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$ff, $00, $ef, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c
	byte	$ec, $0c, $ec, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $00, $00, $00, $00, $00
	byte	$ff, $00, $ff, $00, $00, $00, $00, $00, $00, $00, $00, $6c, $6c, $6c, $6c, $6c
	byte	$ef, $00, $ef, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $6c, $00, $00, $00, $00, $00
	byte	$63, $3e, $63, $63, $63, $63, $3e, $63, $00, $00, $00, $00, $00, $00, $30, $7e
	byte	$30, $3c, $36, $33, $33, $33, $33, $6e, $00, $00, $00, $00, $00, $00, $1f, $36
	byte	$66, $66, $6f, $66, $66, $66, $36, $1f, $00, $00, $00, $36, $1c, $00, $1f, $36
	byte	$66[6]
	byte	$36, $1f, $00, $00, $00, $00, $63, $00, $7f, $66, $46, $16, $1e, $16, $06, $46
	byte	$66, $7f, $00, $00, $00, $6c, $38, $00, $38, $30, $30, $3c, $36, $33, $33, $33
	byte	$33, $6e, $00, $00, $00, $36, $1c, $00, $63, $67, $6f, $7f, $7b, $73, $63, $63
	byte	$63, $63, $00, $00, $00, $30, $18, $00, $3c, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $3c, $00, $00, $00, $3c, $66, $00, $3c, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $3c, $00, $00, $00, $00, $00, $36, $1c, $08, $00, $3e, $63, $7f, $03, $03
	byte	$63, $3e, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18, $1f, $00, $00, $00
	byte	$00[12]
	byte	$f8, $18, $18, $18, $18, $18, $18, $18, $18, $ff, $ff, $ff, $ff, $ff, $ff, $ff
	byte	$ff[9]
	byte	$00[7]
	byte	$ff[9]
	byte	$00, $00, $00, $7e, $7e, $5a, $18, $18, $18, $18, $18, $18, $3c, $18, $30, $1e
	byte	$1c, $36, $1c, $63, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$ff[7]
	byte	$00[9]
	byte	$30, $18, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $00, $1e, $33, $33, $33, $1b, $33, $63, $63, $63, $33, $00, $00, $00
	byte	$1c, $36, $00, $3e, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$30, $18, $00, $63, $67, $6f, $7f, $7b, $73, $63, $63, $63, $63, $00, $00, $00
	byte	$00, $00, $60, $30, $18, $00, $3b, $66, $66, $66, $66, $66, $66, $00, $00, $00
	byte	$00, $00, $36, $1c, $08, $00, $3b, $66, $66, $66, $66, $66, $66, $00, $00, $00
	byte	$36, $1c, $00, $3e, $63, $63, $06, $1c, $30, $60, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $36, $1c, $08, $00, $3e, $63, $06, $1c, $30, $63, $3e, $00, $00, $00
	byte	$30, $18, $00, $3f, $66, $66, $66, $3e, $36, $66, $66, $66, $6f, $00, $00, $00
	byte	$30, $18, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $60, $30, $18, $00, $3b, $6e, $66, $06, $06, $06, $0f, $00, $00, $00
	byte	$66, $33, $00, $63, $63, $63, $63, $63, $63, $63, $63, $63, $3e, $00, $00, $00
	byte	$00, $00, $60, $30, $18, $00, $63, $63, $63, $63, $63, $63, $7e, $60, $30, $1f
	byte	$30, $18, $00, $66, $66, $66, $66, $3c, $18, $18, $18, $18, $3c, $00, $00, $00
	byte	$00, $00, $00, $08, $0c, $0c, $3f, $0c, $0c, $0c, $0c, $6c, $38, $18, $30, $1e
	byte	$30, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[8]
	byte	$7f, $00, $00, $00, $00, $00, $00, $00, $66, $33, $00, $00, $00, $00, $00, $00
	byte	$00[21]
	byte	$0c, $06, $3c, $36, $1c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $63, $3e, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $3e, $63, $06, $1c, $36, $63, $63, $36, $1c, $30, $63, $3e
	byte	$00[8]
	byte	$18, $00, $7e, $00, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[8]
	byte	$18, $30, $1e, $00, $00, $00, $1c, $36, $36, $1c, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $63, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[5]
	byte	$cc, $66, $33, $00, $33, $33, $33, $33, $33, $33, $6e, $00, $00, $00, $36, $1c
	byte	$00, $3f, $66, $66, $66, $3e, $36, $66, $66, $66, $6f, $00, $00, $00, $00, $00
	byte	$36, $1c, $08, $00, $3b, $6e, $66, $06, $06, $06, $0f, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $7e, $7e, $7e, $7e, $7e, $7e, $7e, $00, $00, $00, $00, $00, $00
	byte	$00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
'-' st_font        file "st4font.def"
	byte	$00[55]
	byte	$ff, $ff, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$18[9]
	byte	$00[7]
	byte	$ff, $ff, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$ff, $ff, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$1f, $1f, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$f8, $f8, $18, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$1f, $1f, $18, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$f8, $f8, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$1f, $1f, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$f8, $f8, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18
	byte	$ff, $ff, $18, $18, $18, $18, $18, $18, $18, $00, $00, $18, $3c, $7e, $66, $66
	byte	$66, $7e, $7e, $66, $66, $66, $66, $30, $18, $00, $00, $7e, $7e, $06, $06, $3e
	byte	$3e, $06, $06, $06, $06, $7e, $7e, $18, $0c, $30, $18, $3c, $7e, $66, $66, $06
	byte	$06, $06, $06, $66, $66, $7e, $3c, $00, $00, $30, $18, $66, $66, $66, $6e, $6e
	byte	$7e, $7e, $76, $76, $66, $66, $66, $00, $00, $30, $18, $7c, $7e, $06, $06, $0e
	byte	$1c, $38, $70, $60, $60, $7e, $3e, $00, $00, $30, $18, $7e, $7e, $30, $30, $18
	byte	$18, $0c, $0c, $06, $06, $7e, $7e, $00, $00, $18, $18, $00, $7e, $7e, $30, $30
	byte	$18, $18, $0c, $0c, $06, $7e, $7e, $00, $00, $30, $18, $3c, $7e, $66, $66, $66
	byte	$66[5]
	byte	$7e, $3c, $00, $00, $00, $00, $06, $06, $06, $06, $16, $1e, $0e, $06, $06, $06
	byte	$7e, $7e, $00, $00, $00, $00, $00, $00, $00, $3c, $7c, $60, $7c, $7e, $66, $66
	byte	$7e, $7c, $30, $18, $00, $00, $00, $00, $00, $3c, $7e, $66, $66, $7e, $06, $06
	byte	$7e, $7c, $18, $0c, $00, $00, $30, $18, $00, $3c, $3e, $06, $06, $06, $06, $06
	byte	$7e, $7c, $00, $00, $00, $00, $30, $18, $00, $3e, $7e, $66, $66, $66, $66, $66
	byte	$66, $66, $00, $00, $00, $00, $30, $18, $00, $7c, $7e, $06, $0e, $3c, $70, $60
	byte	$7e, $3e, $00, $00, $00, $00, $30, $18, $00, $7e, $7e, $30, $18, $18, $0c, $0c
	byte	$7e, $7e, $00, $00, $00, $00, $18, $18, $00, $7e, $7e, $30, $18, $18, $0c, $0c
	byte	$7e, $7e, $00, $00, $00, $00, $30, $18, $00, $3c, $7e, $66, $66, $66, $66, $66
	byte	$7e, $3c, $00, $00, $00, $00, $1c, $1c, $18, $18, $38, $3c, $1c, $18, $18, $18
	byte	$3c, $3c, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00
	byte	$00[6]
	byte	$18[8]
	byte	$00, $00, $18, $18, $00, $00, $00, $00, $66, $66, $66, $66, $00, $00, $00, $00
	byte	$00[9]
	byte	$66, $66, $ff, $ff, $66, $66, $ff, $ff, $66, $66, $00, $00, $00, $00, $18, $18
	byte	$7c, $7e, $06, $06, $3e, $7c, $60, $60, $7e, $3e, $18, $18, $00, $00, $00, $66
	byte	$66, $30, $30, $18, $18, $0c, $0c, $66, $66, $00, $00, $00, $00, $00, $3c, $7e
	byte	$66, $66, $3c, $1c, $1c, $fc, $fe, $66, $66, $fe, $fc, $00, $00, $00, $00, $18
	byte	$18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $30
	byte	$18, $1c, $0c, $0c, $0c, $0c, $0c, $0c, $1c, $18, $30, $00, $00, $00, $00, $0c
	byte	$18, $38, $30, $30, $30, $30, $30, $30, $38, $18, $0c, $00, $00, $00, $00, $00
	byte	$66, $66, $3c, $3c, $ff, $ff, $3c, $3c, $66, $66, $00, $00, $00, $00, $00, $00
	byte	$00, $18, $18, $18, $7e, $7e, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$00[6]
	byte	$18[5]
	byte	$0c, $04, $00, $00, $00, $00, $00, $00, $7e, $7e, $00, $00, $00, $00, $00, $00
	byte	$00[13]
	byte	$18, $18, $18, $00, $00, $00, $00, $60, $60, $60, $30, $30, $18, $18, $0c, $0c
	byte	$06, $06, $06, $00, $00, $00, $00, $3c, $7e, $66, $66, $66, $76, $6e, $66, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $18, $18, $1c, $1c, $18, $18, $18, $18, $18
	byte	$18, $7e, $7e, $00, $00, $00, $00, $3c, $7e, $66, $66, $30, $30, $18, $18, $0c
	byte	$0c, $7e, $7e, $00, $00, $00, $00, $7e, $7e, $30, $30, $18, $18, $30, $30, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $30, $30, $38, $38, $3c, $3c, $36, $36, $7e
	byte	$7e, $30, $30, $00, $00, $00, $00, $7e, $7e, $06, $06, $3e, $7e, $60, $60, $60
	byte	$66, $7e, $3c, $00, $00, $00, $00, $38, $3c, $0e, $06, $06, $3e, $7e, $66, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $7e, $7e, $60, $60, $30, $30, $18, $18, $0c
	byte	$0c, $0c, $0c, $00, $00, $00, $00, $3c, $7e, $66, $66, $3c, $3c, $66, $66, $66
	byte	$66, $7e, $3c, $00, $00, $00, $00, $3c, $7e, $66, $66, $7e, $7c, $60, $60, $60
	byte	$70, $3c, $1c, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $00, $00, $00
	byte	$18, $18, $18, $00, $00, $00, $00, $00, $00, $00, $18, $18, $18, $00, $00, $18
	byte	$18, $18, $18, $0c, $04, $00, $00, $00, $70, $38, $1c, $0e, $07, $0e, $1c, $38
	byte	$70, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7e, $7e, $00, $00, $7e, $7e
	byte	$00[8]
	byte	$0e, $1c, $38, $70, $e0, $70, $38, $1c, $0e, $00, $00, $00, $00, $00, $00, $3c
	byte	$7e, $66, $66, $30, $30, $18, $18, $18, $00, $18, $18, $00, $00, $00, $00, $3c
	byte	$7e, $66, $66, $66, $66, $36, $06, $66, $66, $7e, $3c, $00, $00, $00, $00, $18
	byte	$3c, $7e, $66, $66, $66, $7e, $7e, $66, $66, $66, $66, $00, $00, $00, $00, $3e
	byte	$7e, $66, $66, $7e, $3e, $66, $66, $66, $66, $7e, $3e, $00, $00, $00, $00, $3c
	byte	$7e, $66, $66, $06, $06, $06, $06, $66, $66, $7e, $3c, $00, $00, $00, $00, $3e
	byte	$7e, $66, $66, $66, $66, $66, $66, $66, $66, $7e, $3e, $00, $00, $00, $00, $7e
	byte	$7e, $06, $06, $3e, $3e, $06, $06, $06, $06, $7e, $7e, $00, $00, $00, $00, $7e
	byte	$7e, $06, $06, $3e, $3e, $06, $06, $06, $06, $06, $06, $00, $00, $00, $00, $7c
	byte	$7e, $06, $06, $76, $76, $66, $66, $66, $66, $7e, $3c, $00, $00, $00, $00, $66
	byte	$66, $66, $66, $7e, $7e, $66, $66, $66, $66, $66, $66, $00, $00, $00, $00, $7e
	byte	$7e, $18, $18, $18, $18, $18, $18, $18, $18, $7e, $7e, $00, $00, $00, $00, $60
	byte	$60[7]
	byte	$66, $66, $7e, $3c, $00, $00, $00, $00, $66, $66, $36, $36, $1e, $1e, $36, $36
	byte	$66, $66, $c6, $c6, $00, $00, $00, $00, $06, $06, $06, $06, $06, $06, $06, $06
	byte	$06, $06, $7e, $7e, $00, $00, $00, $00, $c6, $c6, $ee, $ee, $fe, $d6, $d6, $c6
	byte	$c6, $c6, $c6, $c6, $00, $00, $00, $00, $66, $66, $66, $6e, $6e, $7e, $7e, $76
	byte	$76, $66, $66, $66, $00, $00, $00, $00, $3c, $7e, $66, $66, $66, $66, $66, $66
	byte	$66, $66, $7e, $3c, $00, $00, $00, $00, $3e, $7e, $66, $66, $66, $66, $7e, $3e
	byte	$06, $06, $06, $06, $00, $00, $00, $00, $3c, $7e, $66, $66, $66, $66, $66, $66
	byte	$66, $56, $3e, $6c, $00, $00, $00, $00, $3e, $7e, $66, $66, $66, $7e, $3e, $36
	byte	$66, $66, $c6, $c6, $00, $00, $00, $00, $7c, $7e, $06, $06, $0e, $1c, $38, $70
	byte	$60, $60, $7e, $3e, $00, $00, $00, $00, $7e, $7e, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $18, $18, $00, $00, $00, $00, $66, $66, $66, $66, $66, $66, $66, $66
	byte	$66, $66, $7e, $3c, $00, $00, $00, $00, $66, $66, $66, $66, $66, $66, $66, $66
	byte	$3c, $3c, $18, $18, $00, $00, $00, $00, $c6, $c6, $c6, $c6, $c6, $d6, $d6, $fe
	byte	$fe, $ee, $c6, $82, $00, $00, $00, $00, $66, $66, $66, $3c, $3c, $18, $18, $3c
	byte	$3c, $66, $66, $66, $00, $00, $00, $00, $66, $66, $66, $66, $66, $3c, $3c, $18
	byte	$18, $18, $18, $18, $00, $00, $00, $00, $7e, $7e, $30, $30, $18, $18, $0c, $0c
	byte	$06, $06, $7e, $7e, $00, $00, $00, $00, $3c, $3c, $0c, $0c, $0c, $0c, $0c, $0c
	byte	$0c, $0c, $3c, $3c, $00, $00, $00, $00, $06, $06, $0c, $0c, $18, $18, $30, $30
	byte	$60, $60, $c0, $c0, $00, $00, $00, $00, $3c, $3c, $30, $30, $30, $30, $30, $30
	byte	$30, $30, $3c, $3c, $00, $00, $00, $00, $18, $18, $3c, $3c, $66, $66, $00, $00
	byte	$00[18]
	byte	$fe, $fe, $00, $00, $00, $00, $0c, $0c, $18, $18, $00, $00, $00, $00, $00, $00
	byte	$00[9]
	byte	$3c, $7c, $60, $7c, $7e, $66, $66, $7e, $7c, $00, $00, $00, $00, $06, $06, $06
	byte	$3e, $7e, $66, $66, $66, $66, $66, $7e, $3e, $00, $00, $00, $00, $00, $00, $00
	byte	$3c, $3e, $06, $06, $06, $06, $06, $7e, $7c, $00, $00, $00, $00, $60, $60, $60
	byte	$7c, $7e, $66, $66, $66, $66, $66, $7e, $7c, $00, $00, $00, $00, $00, $00, $00
	byte	$3c, $7e, $66, $66, $7e, $06, $06, $7e, $7c, $00, $00, $00, $00, $70, $78, $18
	byte	$18, $7e, $7e, $18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00, $00, $00
	byte	$7c, $7e, $66, $66, $66, $66, $7e, $7c, $60, $7e, $3e, $00, $00, $06, $06, $06
	byte	$3e, $7e, $66, $66, $66, $66, $66, $66, $66, $00, $00, $00, $00, $18, $18, $00
	byte	$1c, $1c, $18, $18, $18, $18, $18, $3c, $3c, $00, $00, $00, $00, $30, $30, $00
	byte	$30[9]
	byte	$3e, $1e, $00, $00, $06, $06, $06, $36, $36, $1e, $1e, $1e, $36, $36, $66, $66
	byte	$00, $00, $00, $00, $1c, $1c, $18, $18, $18, $18, $18, $18, $18, $18, $3c, $3c
	byte	$00[7]
	byte	$6c, $fe, $fe, $d6, $d6, $c6, $c6, $c6, $c6, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $7e, $66, $66, $66, $66, $66, $66, $66, $00, $00, $00, $00, $00, $00, $00
	byte	$3c, $7e, $66, $66, $66, $66, $66, $7e, $3c, $00, $00, $00, $00, $00, $00, $00
	byte	$3e, $7e, $66, $66, $66, $66, $66, $7e, $3e, $06, $06, $00, $00, $00, $00, $00
	byte	$7c, $7e, $66, $66, $66, $66, $66, $7e, $7c, $60, $60, $00, $00, $00, $00, $00
	byte	$3e, $7e, $66, $06, $06, $06, $06, $06, $06, $00, $00, $00, $00, $00, $00, $00
	byte	$7c, $7e, $06, $0e, $3c, $70, $60, $7e, $3e, $00, $00, $00, $00, $00, $18, $18
	byte	$7e, $7e, $18, $18, $18, $18, $18, $78, $70, $00, $00, $00, $00, $00, $00, $00
	byte	$66[7]
	byte	$7e, $7c, $00, $00, $00, $00, $00, $00, $00, $66, $66, $66, $66, $66, $3c, $3c
	byte	$18, $18, $00, $00, $00, $00, $00, $00, $00, $c6, $c6, $d6, $d6, $fe, $fe, $ee
	byte	$c6, $82, $00, $00, $00, $00, $00, $00, $00, $66, $66, $3c, $3c, $18, $3c, $3c
	byte	$66, $66, $00, $00, $00, $00, $00, $00, $00, $66, $66, $66, $66, $66, $66, $7e
	byte	$7c, $60, $7e, $3e, $00, $00, $00, $00, $00, $7e, $7e, $30, $18, $18, $0c, $0c
	byte	$7e, $7e, $00, $00, $00, $00, $30, $18, $18, $18, $18, $0c, $0c, $18, $18, $18
	byte	$18, $30, $00, $00, $00, $00, $18, $18, $18, $18, $18, $18, $18, $18, $18, $18
	byte	$18, $18, $00, $00, $00, $00, $0c, $18, $18, $18, $18, $30, $30, $18, $18, $18
	byte	$18, $0c, $00, $00, $00, $00, $6c, $7e, $36, $00, $00, $00, $00, $00, $00, $00
	byte	$00[9]
	byte	$18, $18, $18, $18, $18, $18, $00, $00, $00, $00, $00
'-' ataripalette   file "ataripalettep2.def"
	byte	$00[5]
	byte	$11, $11, $11, $00, $22, $22, $22, $00, $33, $33, $33, $00, $44, $44, $44, $00
	byte	$55, $55, $55, $00, $66, $66, $66, $00, $77, $77, $77, $00, $88, $88, $88, $00
	byte	$99, $99, $99, $00, $aa, $aa, $aa, $00, $bb, $bb, $bb, $00, $cc, $cc, $cc, $00
	byte	$dd, $dd, $dd, $00, $ee, $ee, $ee, $00, $ff, $ff, $ff, $00, $00, $0a, $20, $00
	byte	$00, $14, $40, $00, $00, $1e, $60, $00, $00, $28, $80, $00, $00, $32, $9f, $00
	byte	$00, $3c, $bf, $00, $00, $46, $df, $00, $00, $50, $ff, $00, $1c, $63, $ff, $00
	byte	$39, $77, $ff, $00, $55, $8a, $ff, $00, $71, $9e, $ff, $00, $8e, $b1, $ff, $00
	byte	$aa, $c5, $ff, $00, $c6, $d8, $ff, $00, $e3, $ec, $ff, $00, $00, $00, $20, $00
	byte	$00, $00, $40, $00, $00, $00, $60, $00, $00, $00, $80, $00, $00, $00, $9f, $00
	byte	$00, $00, $bf, $00, $00, $00, $df, $00, $00, $00, $ff, $00, $1c, $1c, $ff, $00
	byte	$39, $39, $ff, $00, $55, $55, $ff, $00, $71, $71, $ff, $00, $8e, $8e, $ff, $00
	byte	$aa, $aa, $ff, $00, $c6, $c6, $ff, $00, $e3, $e3, $ff, $00, $10, $00, $20, $00
	byte	$20, $00, $40, $00, $30, $00, $60, $00, $40, $00, $80, $00, $50, $00, $9f, $00
	byte	$60, $00, $bf, $00, $70, $00, $df, $00, $80, $00, $ff, $00, $8e, $1c, $ff, $00
	byte	$9c, $39, $ff, $00, $aa, $55, $ff, $00, $b8, $71, $ff, $00, $c7, $8e, $ff, $00
	byte	$d5, $aa, $ff, $00, $e3, $c6, $ff, $00, $f1, $e3, $ff, $00, $20, $00, $20, $00
	byte	$40, $00, $40, $00, $60, $00, $60, $00, $80, $00, $80, $00, $9f, $00, $9f, $00
	byte	$bf, $00, $bf, $00, $df, $00, $df, $00, $ff, $00, $ff, $00, $ff, $1c, $ff, $00
	byte	$ff, $39, $ff, $00, $ff, $55, $ff, $00, $ff, $71, $ff, $00, $ff, $8e, $ff, $00
	byte	$ff, $aa, $ff, $00, $ff, $c6, $ff, $00, $ff, $e3, $ff, $00, $20, $00, $10, $00
	byte	$40, $00, $20, $00, $60, $00, $30, $00, $80, $00, $40, $00, $9f, $00, $50, $00
	byte	$bf, $00, $60, $00, $df, $00, $70, $00, $ff, $00, $80, $00, $ff, $1c, $8e, $00
	byte	$ff, $39, $9c, $00, $ff, $55, $aa, $00, $ff, $71, $b8, $00, $ff, $8e, $c7, $00
	byte	$ff, $aa, $d5, $00, $ff, $c6, $e3, $00, $ff, $e3, $f1, $00, $20, $00, $00, $00
	byte	$40, $00, $00, $00, $60, $00, $00, $00, $80, $00, $00, $00, $9f, $00, $00, $00
	byte	$bf, $00, $00, $00, $df, $00, $00, $00, $ff, $00, $00, $00, $ff, $1c, $1c, $00
	byte	$ff, $39, $39, $00, $ff, $55, $55, $00, $ff, $71, $71, $00, $ff, $8e, $8e, $00
	byte	$ff, $aa, $aa, $00, $ff, $c6, $c6, $00, $ff, $e3, $e3, $00, $20, $08, $00, $00
	byte	$40, $10, $00, $00, $60, $18, $00, $00, $80, $20, $00, $00, $9f, $28, $00, $00
	byte	$bf, $30, $00, $00, $df, $38, $00, $00, $ff, $40, $00, $00, $ff, $55, $1c, $00
	byte	$ff, $6a, $39, $00, $ff, $80, $55, $00, $ff, $95, $71, $00, $ff, $aa, $8e, $00
	byte	$ff, $bf, $aa, $00, $ff, $d5, $c6, $00, $ff, $ea, $e3, $00, $20, $10, $00, $00
	byte	$40, $20, $00, $00, $60, $30, $00, $00, $80, $40, $00, $00, $9f, $50, $00, $00
	byte	$bf, $60, $00, $00, $df, $70, $00, $00, $ff, $80, $00, $00, $ff, $8e, $1c, $00
	byte	$ff, $9c, $39, $00, $ff, $aa, $55, $00, $ff, $b8, $71, $00, $ff, $c7, $8e, $00
	byte	$ff, $d5, $aa, $00, $ff, $e3, $c6, $00, $ff, $f1, $e3, $00, $20, $18, $00, $00
	byte	$40, $30, $00, $00, $60, $48, $00, $00, $80, $60, $00, $00, $9f, $78, $00, $00
	byte	$bf, $90, $00, $00, $df, $a8, $00, $00, $ff, $c0, $00, $00, $ff, $c7, $1c, $00
	byte	$ff, $ce, $39, $00, $ff, $d5, $55, $00, $ff, $dc, $71, $00, $ff, $e3, $8e, $00
	byte	$ff, $ea, $aa, $00, $ff, $f1, $c6, $00, $ff, $f8, $e3, $00, $18, $20, $00, $00
	byte	$30, $40, $00, $00, $48, $60, $00, $00, $60, $80, $00, $00, $78, $9f, $00, $00
	byte	$90, $bf, $00, $00, $a8, $df, $00, $00, $c0, $ff, $00, $00, $c7, $ff, $1c, $00
	byte	$ce, $ff, $39, $00, $d5, $ff, $55, $00, $dc, $ff, $71, $00, $e3, $ff, $8e, $00
	byte	$ea, $ff, $aa, $00, $f1, $ff, $c6, $00, $f8, $ff, $e3, $00, $00, $20, $00, $00
	byte	$00, $40, $00, $00, $00, $60, $00, $00, $00, $80, $00, $00, $00, $9f, $00, $00
	byte	$00, $bf, $00, $00, $00, $df, $00, $00, $00, $ff, $00, $00, $1c, $ff, $1c, $00
	byte	$39, $ff, $39, $00, $55, $ff, $55, $00, $71, $ff, $71, $00, $8e, $ff, $8e, $00
	byte	$aa, $ff, $aa, $00, $c6, $ff, $c6, $00, $e3, $ff, $e3, $00, $00, $20, $0a, $00
	byte	$00, $40, $14, $00, $00, $60, $1e, $00, $00, $80, $28, $00, $00, $9f, $32, $00
	byte	$00, $bf, $3c, $00, $00, $df, $46, $00, $00, $ff, $50, $00, $1c, $ff, $63, $00
	byte	$39, $ff, $77, $00, $55, $ff, $8a, $00, $71, $ff, $9e, $00, $8e, $ff, $b1, $00
	byte	$aa, $ff, $c5, $00, $c6, $ff, $d8, $00, $e3, $ff, $ec, $00, $00, $20, $14, $00
	byte	$00, $40, $28, $00, $00, $60, $3c, $00, $00, $80, $50, $00, $00, $9f, $64, $00
	byte	$00, $bf, $78, $00, $00, $df, $8c, $00, $00, $ff, $a0, $00, $1c, $ff, $ab, $00
	byte	$39, $ff, $b5, $00, $55, $ff, $c0, $00, $71, $ff, $ca, $00, $8e, $ff, $d5, $00
	byte	$aa, $ff, $df, $00, $c6, $ff, $ea, $00, $e3, $ff, $f4, $00, $00, $20, $20, $00
	byte	$00, $40, $40, $00, $00, $60, $60, $00, $00, $80, $80, $00, $00, $9f, $9f, $00
	byte	$00, $bf, $bf, $00, $00, $df, $df, $00, $00, $ff, $ff, $00, $1c, $ff, $ff, $00
	byte	$39, $ff, $ff, $00, $55, $ff, $ff, $00, $71, $ff, $ff, $00, $8e, $ff, $ff, $00
	byte	$aa, $ff, $ff, $00, $c6, $ff, $ff, $00, $e3, $ff, $ff, $00, $00, $14, $20, $00
	byte	$00, $28, $40, $00, $00, $3c, $60, $00, $00, $50, $80, $00, $00, $64, $9f, $00
	byte	$00, $78, $bf, $00, $00, $8c, $df, $00, $00, $a0, $ff, $00, $1c, $ab, $ff, $00
	byte	$39, $b5, $ff, $00, $55, $c0, $ff, $00, $71, $ca, $ff, $00, $8e, $d5, $ff, $00
	byte	$aa, $df, $ff, $00, $c6, $ea, $ff, $00, $e3, $f4, $ff
'-' vga16		   long  $00000000,$00008000,$00800000,$00808000,$80000000,$80008000,$80400000,$AAAAAA00,$55555500,$0000FF00,$00FF0000,$00FFFF00,$FF000000,$FF00FF00,$FFFF0000,$FFFFFF00
	byte	$00[5]
	byte	$80, $00, $00, $00, $00, $80, $00, $00, $80, $80, $00, $00, $00, $00, $80, $00
	byte	$80, $00, $80, $00, $00, $40, $80, $00, $aa, $aa, $aa, $00, $55, $55, $55, $00
	byte	$ff, $00, $00, $00, $00, $ff, $00, $00, $ff, $ff, $00, $00, $00, $00, $ff, $00
	byte	$ff, $00, $ff, $00, $00, $ff, $ff, $00, $ff, $ff, $ff
'-' fourcolors     long  $00000000,$FF800000,$80808000,$FFFFFF00 'black,red,gray,white
	byte	$00, $00, $00, $00, $00, $00, $80, $ff, $00, $80, $80, $80, $00, $ff, $ff, $ff
'-' twocolors      
'-' '**********************************************************************************
'-' '
'-' '        Timings and colors definitions
'-' '
'-' '**********************************************************************************
'-' 
'-'    'streamer sets for text mode, to add to timings[0..5]
'-' 
'-' 
'-' '                     bf.hs, hs,  bf.vis  visible, lr bord, pixel, ud bord,  up p., vsync, down p., mode, cpl, scanlines,  clock,                  hubset                  total vis lines
'-' timings000      long   16,   80,    20,    1024,    112,     8,     48,      16,      16,    16,      0,  100,   480,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$70, $00, $00, $00, $08, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $00, $00, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' timings064      long   18,   48,    16,     944,     24,     8,     24,      24,      32,    24,     64,  112,   496,     319215686,   %1_110010__11_0010_1101__1111_1011,   544
	byte	$12, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00, $b0, $03, $00, $00
	byte	$18, $00, $00, $00, $08, $00, $00, $00, $18, $00, $00, $00, $18, $00, $00, $00
	byte	$20, $00, $00, $00, $18, $00, $00, $00, $40, $00, $00, $00, $70, $00, $00, $00
	byte	$f0, $01, $00, $00, $46, $d8, $06, $13, $fb, $2d, $cb, $01, $20, $02, $00, $00
'-' timings128      long   16,   64,    16,     816,      8,     8,     8,       32,      64,    32,    128,  100,   480,     283750000,   %1_111111__11_1000_1011__1111_1011,   496
	byte	$10, $00, $00, $00, $40, $00, $00, $00, $10, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $20, $00, $00, $00
	byte	$40, $00, $00, $00, $20, $00, $00, $00, $80, $00, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $70, $ae, $e9, $10, $fb, $8b, $ff, $01, $f0, $01, $00, $00
'-' timings192      long   16,   80,    20,    1024,      0,     8,     0,       16,      16,    16,    192,  128,   576,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$00, $00, $00, $00, $08, $00, $00, $00, $00, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $c0, $00, $00, $00, $80, $00, $00, $00
	byte	$40, $02, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' timings256      long   80,  160,    84,     816,      8,     8,     8,        8,      12,     8,    256,  100,   480,     357959184,   %1_110000__11_0110_0100__1111_1011,   496
	byte	$50, $00, $00, $00, $a0, $00, $00, $00, $54, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $00, $01, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $10, $06, $56, $15, $fb, $64, $c3, $01, $f0, $01, $00, $00
'-' timings320      long   80,   50,    80,     816,      8,     8,     8,        8,      12,     8,    320,  100,   480,     322162162,   %1_100100__10_0101_0011__1111_1011,   496
	byte	$50, $00, $00, $00, $32, $00, $00, $00, $50, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $40, $01, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f2, $cd, $33, $13, $fb, $53, $92, $01, $f0, $01, $00, $00
'-' timings384      long   24,   48,    24,     816,      8,     8,     8,        8,      12,     8,    384,  100,   480,     286363636,   %1_010101__01_0011_1010__1111_1011,   496
	byte	$18, $00, $00, $00, $30, $00, $00, $00, $18, $00, $00, $00, $30, $03, $00, $00
	byte	$08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $80, $01, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f4, $8f, $11, $11, $fb, $3a, $55, $01, $f0, $01, $00, $00
'-' timings448      long   40,   64,    42,     880,      0,     8,     0,        8,      12,     8,    448,  110,   480,     322162162,   %1_100100__10_0101_0011__1111_1011,   496
	byte	$28, $00, $00, $00, $40, $00, $00, $00, $2a, $00, $00, $00, $70, $03, $00, $00
	byte	$00, $00, $00, $00, $08, $00, $00, $00, $00, $00, $00, $00, $08, $00, $00, $00
	byte	$0c, $00, $00, $00, $08, $00, $00, $00, $c0, $01, $00, $00, $6e, $00, $00, $00
	byte	$e0, $01, $00, $00, $f2, $cd, $33, $13, $fb, $53, $92, $01, $f0, $01, $00, $00
'-' 
'-' timings512      long   16,   80,    20,    1024,    112,     8,     48,      16,      16,    16,    544,  100,   480,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$70, $00, $00, $00, $08, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $20, $02, $00, $00, $64, $00, $00, $00
	byte	$e0, $01, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' timings560      long   16,   80,    20,    1024,    112,     4,     48,      16,      16,    16,    544,  200,   480,     354693878,   %1_110000__11_0110_1100__1111_1011,   576
	byte	$10, $00, $00, $00, $50, $00, $00, $00, $14, $00, $00, $00, $00, $04, $00, $00
	byte	$70, $00, $00, $00, $04, $00, $00, $00, $30, $00, $00, $00, $10, $00, $00, $00
	byte	$10, $00, $00, $00, $10, $00, $00, $00, $20, $02, $00, $00, $c8, $00, $00, $00
	byte	$e0, $01, $00, $00, $f6, $32, $24, $15, $fb, $6c, $c3, $01, $40, $02, $00, $00
'-' 
'-' 
'-' vgacolors       byte   0, 117, 199, 151, 39, 71, 246, 10, 5, 121, 203, 155, 43, 75, 234, 15
	byte	$00, $75, $c7, $97, $27, $47, $f6, $0a, $05, $79, $cb, $9b, $2b, $4b, $ea, $0f
'-' 
'-' hdmi            setq    #10
	byte	$28, $14, $64, $fd
'-'                 rdlong  framebuf,  ptra                 'read pointers
	byte	$00, $0f, $06, $fb
'-' 
'-'                 setq2   #255
	byte	$29, $fe, $65, $fd
'-'                 rdlong  $000, paletteptr                'read palette
	byte	$0d, $01, $00, $fb
'-'                 add     paletteptr,##1024                ' Atari type 256 colors  
	byte	$02, $00, $00, $ff, $00, $1a, $06, $f1
'-'                 setq2   #15
	byte	$29, $1e, $64, $fd
'-'                 rdlong  480,paletteptr                  ' 16 color palette at 480
	byte	$0d, $c1, $03, $fb
'-'                 
'-' 
'-'                 wrlong  #aend,#0                         'write driver length to hub#0: DEBUG/demo
	byte	$00, $4e, $6e, $fc
'-'                 setcmod #$100                           'enable HDMI mode
	byte	$3c, $00, $66, $fd
'-'                 mov     ii,#7
	byte	$07, $2a, $06, $f6
'-'                 shl     ii,#6
	byte	$06, $2a, $66, $f0
'-'                 add     ii,hbase
	byte	$11, $2b, $02, $f1
'-'                 drvl    ii                                 '#7<<6 + hdmi_base      ' enable HDMI pins
	byte	$58, $2a, $62, $fd
'-'                 wrpin   ##%10110_1111_0111_10_00000_0, ii  '#7<<6 + hdmi_base      ' a '123 ohm BITDAC for pins
	byte	$7b, $0b, $80, $ff, $15, $01, $0b, $fc
'-' 
'-'                 setxfrq ##$0CCCCCCC+1                   'set streamer freq to 1/10th clk
	byte	$66, $66, $86, $ff, $1d, $9a, $65, $fd
'-' 
'-' 
'-' ''--------  frame rendering main loop  ---------------------------------------------------
'-' 
'-' p101            
'-' setq    #10
	byte	$28, $14, $64, $fd
'-'                 rdlong  framebuf,  ptra 
	byte	$00, $0f, $06, $fb
'-'                 setq    #15
	byte	$28, $1e, $64, $fd
'-'                 rdlong  m_bs,modeptr                     ' read timings
	byte	$0c, $bf, $01, $fb
'-'              
'-'           
'-'                
'-'                 rdlong border,borderptr
	byte	$09, $bd, $01, $fb
'-'      
'-'                 add     frames,#1
	byte	$01, $ea, $05, $f1
'-'                 mov     dlptr2,dlptr
	byte	$0f, $27, $02, $f6
'-' 
'-'                 rdlong  cursorx, cursorptr               ' read cursor position
	byte	$0b, $ed, $01, $fb
'-'                 getbyte cursory, cursorx,#1              ' y position at byte #1
	byte	$f6, $ee, $e9, $f8
'-'                 getbyte cursorsh,cursorx,#2              ' shape at byte #2
	byte	$f6, $e8, $f1, $f8
'-'                 and     cursorx,#255                     ' clear the cursor x varioble from y and shape
	byte	$ff, $ec, $05, $f5
'-'  '' mailbox
'-'                 rdlong  t1,commandptr                    ' A mailbox interface, read the command
	byte	$0e, $35, $02, $fb
'-'                 add     commandptr,#4
	byte	$04, $1c, $06, $f1
'-'                 rdlong  t2,commandptr                    ' read the argument
	byte	$0e, $37, $02, $fb
'-'                 sub     commandptr,#4                    ' restore the pionter
	byte	$04, $1c, $86, $f1
'-'                 cmp     t1,#256  wcz                     '
	byte	$00, $35, $1e, $f2
'-'          if_lt  wrlut   t2,t1                            ' command 0..255-> set the color in LUT
	byte	$1a, $37, $32, $cc
'-'                 mov     t1, #257                         ' 257=idle
	byte	$01, $35, $06, $f6
'-'                 wrlong  t1,commandptr                    ' write 257 to hub variable so the program can test if command was done
	byte	$0e, $35, $62, $fc
'-'  '' up porch
'-' 
'-'                 mov     hsync0,sync_000                  '
	byte	$da, $2e, $02, $f6
'-'                 mov     hsync1,sync_001
	byte	$db, $30, $02, $f6
'-'                 callpa  i_upporch ,#blank
	byte	$ac, $cc, $45, $fb
'-'                 wrlong  #0,vblankptr
	byte	$0a, $01, $68, $fc
'-' 
'-' '' cursor blinking
'-' 
'-'                 testb   frames,#4 wz                     ' cursor blinks at framerate/16, todo: define
	byte	$04, $ea, $0d, $f4
'-'          if_z   mov     cursorx,#129                     ' to switch the cursor off, move it out of the screen
	byte	$81, $ec, $05, $a6
'-' 
'-' '' main screen
'-' 
'-'                 mov linenum,#0
	byte	$00, $e4, $05, $f6
'-' 
'-' p301            rdlong  dl,dlptr2
	byte	$13, $29, $02, $fb
'-' 
'-'                 mov     framebuf2,dl                    ' read a line start in the framebuffer from DL entry
	byte	$14, $2d, $02, $f6
'-'                 shr     framebuf2,#14
	byte	$0e, $2c, $46, $f0
'-'                 shl     framebuf2,#2     
	byte	$02, $2c, $66, $f0
'-' 
'-'                 getbyte t1,dl,#0 
	byte	$14, $35, $e2, $f8
'-'                 cmp     t1,#0 wz
	byte	$00, $34, $0e, $f2
'-'     if_z        jmp     #borderline
	byte	$78, $02, $90, $ad
'-'     
'-'                  testb   dl,#0  wc     ' bit 0 set = text OR extended:TODO     
	byte	$00, $28, $16, $f4
'-'           if_c   jmp     #textline
	byte	$2c, $00, $90, $cd
'-'           if_nc  jmp     #graphline
	byte	$2c, $02, $90, $3d
'-' '        
'-' p302            add     linenum,#1
	byte	$01, $e4, $05, $f1
'-'                 add     dlptr2,#4
	byte	$04, $26, $06, $f1
'-'                 cmp     linenum,i_totalvis  wz
	byte	$ee, $e4, $09, $f2
'-'          if_nz  jmp     #p301                                  
	byte	$c8, $ff, $9f, $5d
'-'                
'-' p112            wrlong  #1,vblankptr 
	byte	$0a, $03, $68, $fc
'-'                 callpa  i_downporch ,#blank             'bottom blanks
	byte	$98, $d0, $45, $fb
'-' 
'-'                 mov     hsync0,sync_222                 'vsync on
	byte	$dc, $2e, $02, $f6
'-'                 mov     hsync1,sync_223
	byte	$dd, $30, $02, $f6
'-'                 callpa  i_vsync,#blank                  'vertical sync blanks
	byte	$95, $ce, $45, $fb
'-'                 jmp     #p101                    
	byte	$48, $ff, $9f, $fd
'-'   
'-' '' ---------------  END of frame rendering loop -------------------------------------------  
'-' 
'-' 
'-' ''--%aaaa_aaaa_aaaa_aaaa_aazz_nnnn_llll_ll_01 - txt
'-'   '' aaaa_aaaa_aaaa_aaaa_aazz_rrrr_rrrr_cc_10 - graph
'-'   '' aaaa_aaaa_aaaa-aaaa_aarr_rrrr_rrrr_rr_11 - extended, next long to read 
'-'   
'-' '' Display a text line DL[31..12]=addr, nibble #1=textline, zoom: todo
'-' 
'-' textline        mov     cursorpos2,cursorx              ' we need another var for cursor as this code will repeat 16x for every char line
	byte	$f6, $f2, $01, $f6
'-' 
'-'                 getnib  fontline,dl,#2                 ' fontline is 0 to 15, a line in font def
	byte	$14, $33, $52, $f8
'-'                 getnib  zoom, dl,#3
	byte	$14, $4d, $5a, $f8
'-'                 and		zoom, #3  
	byte	$03, $4c, $06, $f5
'-'                 
'-' 
'-' 
'-'                 mov     linestart,dl                    ' linestart will be used for checking cursor y and compute line start addr in the buffer
	byte	$14, $e3, $01, $f6
'-'                 shr     linestart,#2                    ' scanline to char line
	byte	$02, $e2, $45, $f0
'-'                 and     linestart,#63
	byte	$3f, $e2, $05, $f5
'-'                 cmp     linestart,cursory wz            ' if the cursor is not here
	byte	$f7, $e2, $09, $f2
'-'           if_nz mov     cursorpos2,#129                 ' move it out of the screen
	byte	$81, $f2, $05, $56
'-' 
'-'                 call    #hsync                          ' now call hsync to gain some time between xconts
	byte	$34, $02, $b0, $fd
'-' 
'-'                        ' if fontline =0, get a border color
'-'                 
'-' p102            getword t1,m_border,#0                  
	byte	$e3, $34, $32, $f9
'-'                 cmp     t1, #0 wz
	byte	$00, $34, $0e, $f2
'-'           if_nz xcont   m_border,border                 ' display a left border if exists
	byte	$de, $c6, $c1, $5c
'-'         
'-'                 cmp     fontline,cursorsh wcz           ' if the cursor have to be not displayed due to its shape
	byte	$f4, $32, $1a, $f2
'-'           if_c  mov     cursorpos,#129                  ' move it out of the screen
	byte	$81, $f0, $05, $c6
'-'          if_nc  mov     cursorpos,cursorpos2
	byte	$f9, $f0, $01, $36
'-'                 add     cursorpos,#1                    ' we will substract #1 below so compensate this here
	byte	$01, $f0, $05, $f1
'-'                 mov     t2,fontbuf                      ' font definition pointer
	byte	$08, $37, $02, $f6
'-'                 add     t2,fontline                     ' add a current font line
	byte	$19, $37, $02, $f1
'-'                 mov m_lut2, m_lut1
	byte	$e4, $de, $01, $f6
'-'                 add m_lut2, lutt1
	byte	$02, $df, $01, $f1
'-'                 mov cpl2,i_cpl
	byte	$ea, $42, $02, $f6
'-'   
'-'                cmp zoom,#2 wz
	byte	$02, $4c, $0e, $f2
'-'           if_z jmp #p420
	byte	$e4, $00, $90, $ad
'-'                cmp zoom,#1 wz
	byte	$01, $4c, $0e, $f2
'-'           if_z jmp #p410
	byte	$64, $00, $90, $ad
'-'                 cmp zoom,#0 wz
	byte	$00, $4c, $0e, $f2
'-'           if_z jmp #p400    
	byte	$04, $00, $90, $ad
'-'                jmp #p430  
	byte	$50, $01, $90, $fd
'-'           
'-'                    '   
'-'  ''---------------------------------------------------------------------------------------------------------          
'-'  p400                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$16, $45, $02, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$22, $47, $f2, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$22, $49, $fa, $f8
'-'                         getbyte char,char, #0           ' word #0 - char code                       '4
	byte	$22, $45, $e2, $f8
'-'                         add     framebuf2,#4            ' point to the next long                    '5
	byte	$04, $2c, $06, $f1
'-'                         shl     char,#4                 ' 1 char=16 bytes in font def               '6
	byte	$04, $44, $66, $f0
'-'                         add     char,t2                 ' add this to font/line pointer             '7
	byte	$1b, $45, $02, $f1
'-'                         rdbyte  t1,char                 ' and get 8 pixels prom there               '8
	byte	$22, $35, $c2, $fa
'-'                         sub     cursorpos,#1 wz         ' if there is a cursor                      '9
	byte	$01, $f0, $8d, $f1
'-'                   if_z  xor     t1, #$FF                ' reverse the colors                        '10         
	byte	$ff, $34, $66, $a5
'-' 
'-'                         xcont m_lut2,t1
	byte	$1a, $df, $c1, $fc
'-'    
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$23, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$f3, $3c, $32, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $e6, $05, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$24, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$f3, $3c, $32, $fc
'-'                         sub     lutaddr,#1  
	byte	$01, $e6, $85, $f1
'-' 
'-'                         bitnot  m_lut2,#16                                                          '19
	byte	$10, $de, $e5, $f4
'-'                         bitnot  m_lut1,#16                                                          '19
	byte	$10, $c8, $e5, $f4
'-'                         xor     lutaddr,#32             ' use LUT #0-1 and 32-33                    '20
	byte	$20, $e6, $65, $f5
'-' 
'-'                         djnz   cpl2,#p400   
	byte	$eb, $43, $6e, $fb
'-'  p401                   jmp    #p103
	byte	$28, $01, $90, $fd
'-'                         
'-' ''------------------------------------------------------------------------------------------------------------
'-'   
'-'  p410                   shr cpl2,#1 
	byte	$01, $42, $46, $f0
'-'                      
'-' ''---------------------------------------------------------------------------------------------------------          
'-'  p412                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$16, $45, $02, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$22, $47, $f2, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$22, $49, $fa, $f8
'-'                         getbyte char,char, #0           ' word #0 - char code                       '4
	byte	$22, $45, $e2, $f8
'-'                         add     framebuf2,#4            ' point to the next long                    '5
	byte	$04, $2c, $06, $f1
'-'                         shl     char,#4                 ' 1 char=16 bytes in font def               '6
	byte	$04, $44, $66, $f0
'-'                         add     char,t2                 ' add this to font/line pointer             '7
	byte	$1b, $45, $02, $f1
'-'                         rdbyte  t1,char                 ' and get 8 pixels prom there               '8
	byte	$22, $35, $c2, $fa
'-'                         sub     cursorpos,#1 wz         ' if there is a cursor                      '9
	byte	$01, $f0, $8d, $f1
'-'                   if_z  xor     t1, #$FF                ' reverse the colors                        '10         
	byte	$ff, $34, $66, $a5
'-'   
'-'   
'-'                         getnib t3,t1,#1                   ' 4 pixels to t3  						'1  - +
	byte	$1a, $39, $4a, $f8
'-'                         getnib t1,t1,#0                   ' 4 pixels to t1							'2  - +
	byte	$1a, $35, $42, $f8
'-'                         mergew t1                         ' make 01010101 from 1111					'3  - +
	byte	$63, $34, $62, $fd
'-'                         mul t1,#3 
	byte	$03, $34, $06, $fa
'-'                         xcont m_lut2,t1
	byte	$1a, $df, $c1, $fc
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$23, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$f3, $3c, $32, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $e6, $05, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$24, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$f3, $3c, $32, $fc
'-'                         sub     lutaddr,#1                         
	byte	$01, $e6, $85, $f1
'-'                         mergew t3
	byte	$63, $38, $62, $fd
'-'                         mul t3,#3
	byte	$03, $38, $06, $fa
'-'                         xcont m_lut2,t3
	byte	$1c, $df, $c1, $fc
'-'    
'-'                         bitnot  m_lut2,#16                                                          '19
	byte	$10, $de, $e5, $f4
'-'                         bitnot  m_lut1,#16                                                          '19
	byte	$10, $c8, $e5, $f4
'-'                         
'-'                         xor     lutaddr,#32             ' use LUT #0-1 and 32-33                    '20
	byte	$20, $e6, $65, $f5
'-' 
'-'                         djnz   cpl2,#p412              
	byte	$e4, $43, $6e, $fb
'-'  p411                   jmp    #p103
	byte	$b0, $00, $90, $fd
'-'                         
'-' ''------------------------------------------------------------------------------------------------------------
'-' 
'-'  p420                   shr cpl2,#2
	byte	$02, $42, $46, $f0
'-' 
'-' ''---------------------------------------------------------------------------------------
'-'  p422                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$16, $45, $02, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$22, $47, $f2, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$22, $49, $fa, $f8
'-'                         getbyte char,char, #0           ' word #0 - char code                       '4
	byte	$22, $45, $e2, $f8
'-'                         add     framebuf2,#4            ' point to the next long                    '5
	byte	$04, $2c, $06, $f1
'-'                         shl     char,#4                 ' 1 char=16 bytes in font def               '6
	byte	$04, $44, $66, $f0
'-'                         add     char,t2                 ' add this to font/line pointer             '7
	byte	$1b, $45, $02, $f1
'-'                         rdbyte  t1,char                 ' and get 8 pixels prom there               '8
	byte	$22, $35, $c2, $fa
'-'                         sub     cursorpos,#1 wz         ' if there is a cursor                      '9
	byte	$01, $f0, $8d, $f1
'-'                   if_z  xor     t1, #$FF                ' reverse the colors                        '10
	byte	$ff, $34, $66, $a5
'-' 
'-'                         mergeb t1
	byte	$61, $34, $62, $fd
'-'                         getword t3,t1,#1
	byte	$1a, $39, $3a, $f9
'-'                         mul t1,#15
	byte	$0f, $34, $06, $fa
'-'                         xcont m_lut2,t1
	byte	$1a, $df, $c1, $fc
'-'                         
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$23, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$f3, $3c, $32, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $e6, $05, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$24, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$f3, $3c, $32, $fc
'-'                         sub     lutaddr,#1 
	byte	$01, $e6, $85, $f1
'-'                         
'-'                         getbyte t4,t1,#1        '          
	byte	$1a, $3b, $ea, $f8
'-'                         xcont m_lut2,t4                                                                                                           ' 
	byte	$1d, $df, $c1, $fc
'-'                        
'-'                         mul t3,#15
	byte	$0f, $38, $06, $fa
'-'                         xcont m_lut2,t3
	byte	$1c, $df, $c1, $fc
'-'                         
'-'                         getbyte t5,t3,#1
	byte	$1c, $3d, $ea, $f8
'-'                         xcont m_lut2, t5
	byte	$1e, $df, $c1, $fc
'-'                         bitnot  m_lut2,#16                                                          '19
	byte	$10, $de, $e5, $f4
'-'                         bitnot  m_lut1,#16                                                          '19
	byte	$10, $c8, $e5, $f4
'-'                         
'-'                         xor     lutaddr,#32             ' use LUT #0-1 and 32-33                    '20
	byte	$20, $e6, $65, $f5
'-' 
'-'                         djnz   cpl2,#p422              
	byte	$e2, $43, $6e, $fb
'-'  p421                   jmp    #p103 
	byte	$30, $00, $90, $fd
'-'                         
'-' '--------------------------------------------------------------------------------------------------------------                      
'-'         
'-'  p430                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$16, $45, $02, $fb
'-'                         getbyte backcolor,char,#2       ' byte #2 - background color                '2
	byte	$22, $47, $f2, $f8
'-'                         getbyte charcolor,char,#3       ' byte #3 - foreground color                '3
	byte	$22, $49, $fa, $f8
'-'      
'-'                         xcont m_lut2,#0
	byte	$00, $de, $c5, $fc
'-'    
'-'                         rdlut   t5,backcolor            ' read a background color from palette      '13
	byte	$23, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr              ' and write it to LUT #0 or #32             '14
	byte	$f3, $3c, $32, $fc
'-'                         add     lutaddr,#1                                                          '15
	byte	$01, $e6, $05, $f1
'-'                         rdlut   t5,charcolor            ' the same for the foreground               '16
	byte	$24, $3d, $a2, $fa
'-'                         wrlut   t5,lutaddr                                                          '17
	byte	$f3, $3c, $32, $fc
'-'                         sub     lutaddr,#1  
	byte	$01, $e6, $85, $f1
'-' 
'-'                         djnz   cpl2,#p430   
	byte	$f5, $43, $6e, $fb
'-'  p431                   jmp    #p103
	byte	$00, $00, $90, $fd
'-'                         
'-' ''------------------------------------------------------------------------------------------------------------
'-'   
'-'                     
'-' 
'-' p103            getword  t1,m_border,#0
	byte	$e3, $34, $32, $f9
'-'                 cmp      t1, #0 wz
	byte	$00, $34, $0e, $f2
'-'                 if_nz    xcont   m_border,border            'display a right border if exists
	byte	$de, $c6, $c1, $5c
'-'                 
'-'                 jmp #p302
	byte	$d4, $fd, $9f, $fd
'-'                 
'-' '' -------------------------------------- END of text line ---------------------------------              
'-'                 
'-' '' %aaaa_aaaa_aaaa_aaaa_aa00_zzcc_rrrr_rrrr - display a graphics line
'-' 
'-' graphline                         ' we need another var for cursor as this code will repeat 16x for every char line
'-' 
'-'                
'-'                 mov ashr,#0
	byte	$00, $e0, $05, $f6
'-'                 call    #hsync                          ' now call hsync to gain some time between xconts
	byte	$50, $00, $b0, $fd
'-' 
'-'                
'-' p202            getword t1,m_border,#0                  
	byte	$e3, $34, $32, $f9
'-'                 cmp     t1, #0 wz
	byte	$00, $34, $0e, $f2
'-'           if_nz xcont   m_border,border                 ' display a left border if exists
	byte	$de, $c6, $c1, $5c
'-'         
'-' 
'-'                 mov m_lut2, m_lut1
	byte	$e4, $de, $01, $f6
'-'                 add m_lut2, lutg8
	byte	$06, $df, $01, $f1
'-'                 mov cpl2,i_cpl
	byte	$ea, $42, $02, $f6
'-'                
'-'   
'-' 
'-' ''              rep     @p103, cpl2                     ' display cpl chars
'-' ''---------------------------------------------------------------------------------------
'-'  p221                   rdlong  char,framebuf2          ' read a long char                          '1
	byte	$16, $45, $02, $fb
'-'                                                                                                             ' 
'-'                                        
'-'                 
'-'                         xcont   m_lut2,char                ' and display this  						'10 + +
	byte	$22, $df, $c1, $fc
'-'                         add framebuf2,#4
	byte	$04, $2c, $06, $f1
'-' 
'-'                         djnz   cpl2,#p221  '' cannot have rep and skipf
	byte	$fc, $43, $6e, $fb
'-' '' rep end  -------------------------------------------------------------------------------
'-' 
'-' 
'-' p203            getword  t1,m_border,#0
	byte	$e3, $34, $32, $f9
'-'                 cmp      t1, #0 wz
	byte	$00, $34, $0e, $f2
'-'                 if_nz    xcont   m_border,border            'display a right border if exists
	byte	$de, $c6, $c1, $5c
'-'                 
'-'                 jmp #p302
	byte	$94, $fd, $9f, $fd
'-'                 
'-' '' -------------------------------------- END of graph  line ---------------------------------              
'-' 
'-' '--------------------------------------------------------------------------
'-' borderline      call    #hsync                      ' make a border
	byte	$14, $00, $b0, $fd
'-' 			'	mov     border,dl                   'set border color according to dl entry
'-'                 xcont   m_vi,border 
	byte	$de, $c4, $c1, $fc
'-'                 jmp     #p302 
	byte	$88, $fd, $9f, $fd
'-' 
'-' 
'-' blank           call    #hsync                          'blank lines
	byte	$08, $00, $b0, $fd
'-'                 xcont   m_vi,hsync0
	byte	$17, $c5, $c1, $fc
'-'         _ret_   djnz    pa,#blank
	byte	$fd, $ed, $6f, $0b
'-' 
'-' hsync           xcont   m_bs,hsync0                     'horizontal sync
	byte	$17, $bf, $c1, $fc
'-'                 xzero   m_sn,hsync1
	byte	$18, $c1, $b1, $fc
'-'         _ret_   xcont   m_bv,hsync0
	byte	$17, $c3, $c1, $0c
'-' 
'-' '' consts and vars
'-' 
'-' sync_000        long    %1101010100_1101010100_1101010100_10    '
	byte	$52, $4d, $35, $d5
'-' sync_001        long    %1101010100_1101010100_0010101011_10    '        hsync
	byte	$ae, $42, $35, $d5
'-' sync_222        long    %0101010100_0101010100_0101010100_10    'vsync
	byte	$52, $45, $15, $55
'-' sync_223        long    %0101010100_0101010100_1010101011_10    'vsync + hsync
	byte	$ae, $4a, $15, $55
'-' 
'-' border          long    %00000000_00011010_00101100_00000000
	byte	$00, $2c, $1a, $00
'-' 
'-' '------ these longs will be set by setmode function
'-' 
'-' m_bs            long    0        'blanks before sync
	byte	$00, $00, $00, $00
'-' m_sn            long    0        'sync
	byte	$00, $00, $00, $00
'-' m_bv            long    0        'blanks before visible
	byte	$00, $00, $00, $00
'-' m_vi            long    0        'visible pixels #
	byte	$00, $00, $00, $00
'-' m_border        long    0        'left/right borders
	byte	$00, $00, $00, $00
'-' m_lut1          long    0        'characters
	byte	$00, $00, $00, $00
'-' i_vborder       long    0        'up/down borders
	byte	$00, $00, $00, $00
'-' i_upporch       long    0        'up porch lines
	byte	$00, $00, $00, $00
'-' i_vsync         long    0        'vsync lines
	byte	$00, $00, $00, $00
'-' i_downporch     long    0        'down porch lines
	byte	$00, $00, $00, $00
'-' i_modenum       long    0        'mode #
	byte	$00, $00, $00, $00
'-' i_cpl           long    0        'chars per line
	byte	$00, $00, $00, $00
'-' i_lines         long    0        'scanlines #
	byte	$00, $00, $00, $00
'-' i_clock         long    0
	byte	$00, $00, $00, $00
'-' i_hubset        long    0
	byte	$00, $00, $00, $00
'-' i_totalvis      long    0 
	byte	$00, $00, $00, $00
'-' m_lut2          long    0
	byte	$00, $00, $00, $00
'-' 
'-' ashr            long    4
	byte	$04, $00, $00, $00
'-' linestart       long    0
	byte	$00, $00, $00, $00
'-' linenum         long    0
	byte	$00, $00, $00, $00
'-' lutaddr         long    256
	byte	$00, $01, $00, $00
'-' 
'-' cursorsh        long    14
	byte	$0e, $00, $00, $00
'-' frames          long    0
	byte	$00, $00, $00, $00
'-' cursorx         long    0
	byte	$00, $00, $00, $00
'-' cursory         long    0
	byte	$00, $00, $00, $00
'-' cursorpos       long    0
	byte	$00, $00, $00, $00
'-' cursorpos2      long    0
	byte	$00, $00, $00, $00
'-' fontstart       long    0
	byte	$00, $00, $00, $00
'-' aredtest long $FF000000
	byte	$00, $00, $00, $ff
'-' border2 long 0
	byte	$00, $00, $00, $00
'-' skipft1 long     %111111111111111100111111111
	byte	$ff, $f9, $ff, $07
'-' skipft2 long     %111100111100111100111100001
	byte	$e1, $79, $9e, $07
'-' skipft4 long     %000000000000000000000000001
	byte	$01, $00, $00, $00
'-' skipftblank long %111111111111111100111111110
	byte	$fe, $f9, $ff, $07
'-' lutiv	        long $70810000
	byte	$00, $00, $81, $70
'-' lutt1           long $00880000 
	byte	$00, $00, $88, $00
'-' lutg1           long $208d0000
	byte	$00, $00, $8d, $20
'-' lutg2           long $208e0000
	byte	$00, $00, $8e, $20
'-' lutg4           long $208f0000 
	byte	$00, $00, $8f, $20
'-' lutg8           long $30800000
	byte	$00, $00, $80, $30
'-' framebuf        res     1
'-' fontbuf         res     1
'-' borderptr       res     1
'-' vblankptr       res     1
'-' cursorptr       res     1
'-' modeptr         res     1
'-' paletteptr      res     1
'-' commandptr      res     1
'-' dlptr			res     1
'-' fontnumptr      res     1
'-' hbase           res     1
'-' borderptr2      res     1
'-' dlptr2 res 1
'-' dl              res 1
'-' ii              res     1
'-' framebuf2       res     1
'-' hsync0          res     1
'-' hsync1          res     1
'-' fontline        res     1
'-' t1              res     1
'-' t2              res     1
'-' t3 res 1
'-' t4 res 1
'-' t5 res 1
'-' colors1 res 1
'-' skippattern res 1
'-' cpl2 res 1
'-' char            res     1
'-' backcolor       res     1
'-' charcolor       res     1
'-' repnum res 1
'-' zoom res 1
'-' aend             long 0
	byte	$00, $00, $00, $00
objmem
	long	0[57]
stackspace
	long	0[1]
	org	COG_BSS_START
_var01
	res	1
_var02
	res	1
_var03
	res	1
_var04
	res	1
_var05
	res	1
_var06
	res	1
_var07
	res	1
_var08
	res	1
_var09
	res	1
_var10
	res	1
_var11
	res	1
_var12
	res	1
_var13
	res	1
_var14
	res	1
_var15
	res	1
_var16
	res	1
_var17
	res	1
_var18
	res	1
_var19
	res	1
_var20
	res	1
_var21
	res	1
_var22
	res	1
arg01
	res	1
arg02
	res	1
arg03
	res	1
arg04
	res	1
arg05
	res	1
arg06
	res	1
arg07
	res	1
arg08
	res	1
arg09
	res	1
arg10
	res	1
arg11
	res	1
arg12
	res	1
arg13
	res	1
arg14
	res	1
arg15
	res	1
arg16
	res	1
arg17
	res	1
arg18
	res	1
local01
	res	1
local02
	res	1
local03
	res	1
local04
	res	1
local05
	res	1
local06
	res	1
local07
	res	1
local08
	res	1
local09
	res	1
local10
	res	1
local11
	res	1
local12
	res	1
local13
	res	1
local14
	res	1
local15
	res	1
local16
	res	1
local17
	res	1
local18
	res	1
local19
	res	1
local20
	res	1
local21
	res	1
local22
	res	1
local23
	res	1
local24
	res	1
local25
	res	1
local26
	res	1
local27
	res	1
local28
	res	1
local29
	res	1
local30
	res	1
local31
	res	1
local32
	res	1
local33
	res	1
muldiva_
	res	1
muldivb_
	res	1
	fit	480
